<svg xmlns="http://www.w3.org/2000/svg" height="1669" preserveAspectRatio="none" style="width:1194px;height:1669px" width="1194">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="556" x="317" y="28.708">
    1.3.0. Position Handler Consume individual transfers from Bulk
  </text>
  <path fill="#FFFFE0" stroke="#a80036" d="M26 40.953h1138v1622.18H26z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="539.5" y="53.02">
    Central Service
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M112 187.781h10v30h-10zM112 666.445h10v30h-10zM112 1145.109h10v30h-10zM436 118.383h10v1483.453h-10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M10 125.383h1170v1469.453H10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M20 149.516h1150v1438.32H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M362 232.781h566v105.531H362z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M372 256.914h546v74.398H372zM372 352.313h647v156.664H372z"/>
  <path fill="#FFF" d="M20 630.508h1150v478.664H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M362 711.445h565v105.531H362z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M372 735.578h545v74.398H372zM372 830.977h647v156.664H372z"/>
  <path fill="#FFF" d="M20 1109.172h1150v478.664H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M362 1190.109h605v105.531H362z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M372 1214.242h585v74.398H372zM372 1309.641h647v156.664H372z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M117 108.383v1503.453M441 108.383v1503.453M957 108.383v1503.453M1089 108.383v1503.453"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M34 69.086h166v30.297H34z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M30 73.086h166v30.297H30z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="37" y="93.081">
    topic-transfer-position
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M34 1610.836h166v30.297H34z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M30 1614.836h166v30.297H30z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="37" y="1634.831">
    topic-transfer-position
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="382" y="105.081">
    Position Handler
  </text>
  <circle cx="441" cy="76.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M437 64.086l6-5-2 5 2 5-6-5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="382" y="1623.831">
    Position Handler
  </text>
  <circle cx="441" cy="1643.133" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M437 1631.133l6-5-2 5 2 5-6-5z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M909 69.086h96v30.297h-96z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M905 73.086h96v30.297h-96z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="912" y="93.081">
    Event-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M909 1610.836h96v30.297h-96z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M905 1614.836h96v30.297h-96z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="912" y="1634.831">
    Event-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1023 69.086h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1019 73.086h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1026" y="93.081">
    Notification-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1023 1610.836h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1019 1614.836h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1026" y="1634.831">
    Notification-Topic
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M112 187.781h10v30h-10zM112 666.445h10v30h-10zM112 1145.109h10v30h-10zM436 118.383h10v1483.453h-10z"/>
  <path d="M10 125.383h240v7l-10 10H10v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M10 125.383h1170v1469.453H10z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="195" x="25" y="138.45">
    Position Handler Consume
  </text>
  <path d="M20 149.516h64v7l-10 10H20v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M20 149.516h1150v1438.32H20z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="35" y="162.583">
    alt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="246" x="99" y="161.726">
    [Consume Prepare message for Payer]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M133 183.781l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M127 187.781h308"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139" y="182.715">
    1
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="152" y="182.715">
    Consume Position event message for Payer
  </text>
  <path d="M362 232.781h88v7l-10 10h-78v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M362 232.781h566v105.531H362z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="377" y="245.848">
    break
  </text>
  <path d="M372 256.914h152v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 256.914h546v74.398H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="387" y="269.981">
    Validate Event
  </text>
  <path stroke="#a80036" d="M446 310.313h42M488 310.313v13M447 323.313h41"/>
  <path fill="#A80036" stroke="#a80036" d="M457 319.313l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="297.68">
    2
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="440" x="466" y="290.114">
    Validate event - Rule: type == &apos;position&apos; &amp;&amp; action == &apos;bulk-prepare&apos;
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="466" y="305.247">
    Error codes:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="560" y="305.247">
    2001
  </text>
  <path d="M372 352.313h232v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 352.313h647v156.664H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="387" y="365.379">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M945 411.578l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 415.578h505"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="410.512">
    3
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="466" y="410.512">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 423.578h629v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 423.578h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="437.645">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="618" y="456.645">
    Event Handler Consume
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 540.977h231v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 540.977h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="555.043">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="385" y="574.043">
    Prepare Position Handler Consume
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1077.5 618.508l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 622.508h637.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="617.442">
    4
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="466" y="617.442">
    Produce message
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M20 631.508h1150"/>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="25" y="641.718">
    [Consume Fulfil message for Payee]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M133 662.445l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M127 666.445h308"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139" y="661.379">
    5
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="282" x="152" y="661.379">
    Consume Position event message for Payee
  </text>
  <path d="M362 711.445h88v7l-10 10h-78v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M362 711.445h565v105.531H362z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="377" y="724.512">
    break
  </text>
  <path d="M372 735.578h152v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 735.578h545v74.398H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="387" y="748.645">
    Validate Event
  </text>
  <path stroke="#a80036" d="M446 788.977h42M488 788.977v13M447 801.977h41"/>
  <path fill="#A80036" stroke="#a80036" d="M457 797.977l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="776.344">
    6
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="439" x="466" y="768.778">
    Validate event - Rule: type == &apos;position&apos; &amp;&amp; action == &apos;bulk-commit&apos;
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="466" y="783.911">
    Error codes:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="560" y="783.911">
    2001
  </text>
  <path d="M372 830.977h232v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 830.977h647v156.664H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="387" y="844.043">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M945 890.242l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 894.242h505"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="889.176">
    7
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="466" y="889.176">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 902.242h629v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 902.242h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="916.309">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="618" y="935.309">
    Event Handler Consume
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 1019.641h209v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 1019.64h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="1033.707">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="385" y="1052.707">
    Fulfil Position Handler Consume
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1077.5 1097.172l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 1101.172h637.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="1096.106">
    8
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="466" y="1096.106">
    Produce message
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M20 1110.172h1150"/>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="25" y="1120.382">
    [Consume Abort message]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M133 1141.11l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M127 1145.109h308"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139" y="1140.043">
    9
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="152" y="1140.043">
    Consume Position event message
  </text>
  <path d="M362 1190.11h88v7l-10 10h-78v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M362 1190.109h605v105.531H362z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="377" y="1203.176">
    break
  </text>
  <path d="M372 1214.242h152v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 1214.242h585v74.398H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="387" y="1227.309">
    Validate Event
  </text>
  <path stroke="#a80036" d="M446 1267.641h42M488 1267.641v13M447 1280.641h41"/>
  <path fill="#A80036" stroke="#a80036" d="M457 1276.64l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="453" y="1255.008">
    10
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="470" x="475" y="1247.442">
    Validate event - Rule: type == &apos;position&apos; &amp;&amp; action == &apos;timeout-reserved&apos;
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="475" y="1262.575">
    Error codes:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="569" y="1262.575">
    2001
  </text>
  <path d="M372 1309.64h232v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 1309.641h647v156.664H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="387" y="1322.707">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M945 1368.906l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 1372.906h505"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="453" y="1367.84">
    11
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="475" y="1367.84">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 1380.906h629v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 1380.906h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="1394.973">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="618" y="1413.973">
    Event Handler Consume
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 1498.305h216v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 1498.305h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="1512.372">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="385" y="1531.372">
    Abort Position Handler Consume
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1077.5 1575.836l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 1579.836h637.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="453" y="1574.77">
    12
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="475" y="1574.77">
    Produce message
  </text>
</svg>
