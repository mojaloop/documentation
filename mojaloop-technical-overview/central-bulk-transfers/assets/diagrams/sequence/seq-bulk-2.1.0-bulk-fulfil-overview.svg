<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3141px" preserveAspectRatio="none" style="width:2515px;height:3141px;" version="1.1" viewBox="0 0 2515 3141" width="2515px" zoomAndPan="magnify"><defs><filter height="300%" id="fozcvrg2rr0kn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="411" x="1053.25" y="23.5352">2.1.0. DFSP2 sends a Bulk Fulfil Success Transfer request</text><rect fill="#D3D3D3" height="3095.9238" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="3095.9238" style="stroke: #A80036; stroke-width: 1.0;" width="407.5" x="314.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="439.75" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="3095.9238" style="stroke: #A80036; stroke-width: 1.0;" width="1713.5" x="775" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1581.25" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="699.1797" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="641.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="993.9922"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="1664.8613"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2369.2246"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2526.7773"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2801.5723"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1080.5" y="1444.0664"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2854.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1282.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1611.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1940.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2269.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2839.6602" style="stroke: #000000; stroke-width: 2.0;" width="2481.5" x="23" y="170.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="1253.5" x="1241" y="1770.1035"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="1253.5" x="1241" y="1816.7246"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1576.5" y="1990.2324"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="606.5" x="1576.5" y="2036.8535"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2461.5" x="33" y="2571.0879"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2402.5" x="92" y="2845.8828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="373.5" x2="373.5" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="646" x2="646" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="832" x2="832" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="963" x2="963" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1085" x2="1085" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1287" x2="1287" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1447.5" x2="1447.5" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1616.5" x2="1616.5" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1776.5" x2="1776.5" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1945" x2="1945" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2105" x2="2105" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2274" x2="2274" y1="153.7754" y2="3027.4355"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2434.5" x2="2434.5" y1="153.7754" y2="3027.4355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="134.334">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="150.8223">Payer</text><ellipse cx="67.5" cy="63.7988" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,71.7988 L67.5,98.7988 M54.5,79.7988 L80.5,79.7988 M67.5,98.7988 L54.5,113.7988 M67.5,98.7988 L80.5,113.7988 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="3039.9707">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="3056.459">Payer</text><ellipse cx="67.5" cy="3069.4121" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,3077.4121 L67.5,3104.4121 M54.5,3085.4121 L80.5,3085.4121 M67.5,3104.4121 L54.5,3119.4121 M67.5,3104.4121 L80.5,3119.4121 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="134.334">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="150.8223">Payee</text><ellipse cx="126.5" cy="63.7988" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,71.7988 L126.5,98.7988 M113.5,79.7988 L139.5,79.7988 M126.5,98.7988 L113.5,113.7988 M126.5,98.7988 L139.5,113.7988 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="3039.9707">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="3056.459">Payee</text><ellipse cx="126.5" cy="3069.4121" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,3077.4121 L126.5,3104.4121 M113.5,3085.4121 L139.5,3085.4121 M126.5,3104.4121 L113.5,3119.4121 M126.5,3104.4121 L139.5,3119.4121 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="150.8223">ML API Adapter</text><path d="M353,109.2871 L353,133.2871 M353,121.2871 L370,121.2871 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="121.2871" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="3039.9707">ML API Adapter</text><path d="M353,3046.9238 L353,3070.9238 M353,3058.9238 L370,3058.9238 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="3058.9238" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="619" y="134.334">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="575" y="150.8223">Notification Handler</text><ellipse cx="646.5" cy="104.7988" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="642.5,92.7988,648.5,87.7988,646.5,92.7988,648.5,97.7988,642.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="619" y="3039.9707">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="575" y="3056.459">Notification Handler</text><ellipse cx="646.5" cy="3075.4121" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="642.5,3063.4121,648.5,3058.4121,646.5,3063.4121,648.5,3068.4121,642.5,3063.4121" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="783" y="97.7988"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="779" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="800" y="122.334">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="786" y="138.8223">object-store</text><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="783" y="3026.4355"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="779" y="3030.4355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="800" y="3050.9707">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="786" y="3067.459">object-store</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="896" y="150.8223">Central Service API</text><path d="M942.5,109.2871 L942.5,133.2871 M942.5,121.2871 L959.5,121.2871 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="971.5" cy="121.2871" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="896" y="3039.9707">Central Service API</text><path d="M942.5,3046.9238 L942.5,3070.9238 M942.5,3058.9238 L959.5,3058.9238 " fill="none" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="971.5" cy="3058.9238" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1044" y="97.7988"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1040" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1060.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="1047" y="138.8223">bulk-fulfil</text><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1044" y="3026.4355"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1040" y="3030.4355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1060.5" y="3050.9707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="1047" y="3067.459">bulk-fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1251" y="134.334">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1257.5" y="150.8223">Handler</text><ellipse cx="1287.5" cy="104.7988" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1283.5,92.7988,1289.5,87.7988,1287.5,92.7988,1289.5,97.7988,1283.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1251" y="3039.9707">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1257.5" y="3056.459">Handler</text><ellipse cx="1287.5" cy="3075.4121" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1283.5,3063.4121,1289.5,3058.4121,1287.5,3063.4121,1289.5,3068.4121,1283.5,3063.4121" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1419.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1415.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1422.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1428" y="138.8223">fulfil</text><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1419.5" y="3026.4355"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1415.5" y="3030.4355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1422.5" y="3050.9707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1428" y="3067.459">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1594.5" y="134.334">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1586.5" y="150.8223">Handler</text><ellipse cx="1616.5" cy="104.7988" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1612.5,92.7988,1618.5,87.7988,1616.5,92.7988,1618.5,97.7988,1612.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1594.5" y="3039.9707">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1586.5" y="3056.459">Handler</text><ellipse cx="1616.5" cy="3075.4121" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1612.5,3063.4121,1618.5,3058.4121,1616.5,3063.4121,1618.5,3068.4121,1612.5,3063.4121" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1710.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1706.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1751.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1713.5" y="138.8223">transfer-position</text><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1710.5" y="3026.4355"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1706.5" y="3030.4355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1751.5" y="3050.9707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1713.5" y="3067.459">transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1913" y="134.334">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1915.5" y="150.8223">Handler</text><ellipse cx="1945.5" cy="104.7988" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1941.5,92.7988,1947.5,87.7988,1945.5,92.7988,1947.5,97.7988,1941.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1913" y="3039.9707">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1915.5" y="3056.459">Handler</text><ellipse cx="1945.5" cy="3075.4121" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1941.5,3063.4121,1947.5,3058.4121,1945.5,3063.4121,1947.5,3068.4121,1941.5,3063.4121" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2042" y="97.7988"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2038" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2080.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="2045" y="138.8223">bulk-processing</text><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2042" y="3026.4355"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2038" y="3030.4355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2080.5" y="3050.9707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="2045" y="3067.459">bulk-processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2218" y="134.334">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2244.5" y="150.8223">Handler</text><ellipse cx="2274.5" cy="104.7988" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2270.5,92.7988,2276.5,87.7988,2274.5,92.7988,2276.5,97.7988,2270.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2218" y="3039.9707">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2244.5" y="3056.459">Handler</text><ellipse cx="2274.5" cy="3075.4121" fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2270.5,3063.4121,2276.5,3058.4121,2274.5,3063.4121,2276.5,3068.4121,2270.5,3063.4121" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2388.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2384.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2409.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2391.5" y="138.8223">notification</text><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2388.5" y="3026.4355"/><rect fill="#FEFECE" filter="url(#fozcvrg2rr0kn)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2384.5" y="3030.4355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2409.5" y="3050.9707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2391.5" y="3067.459">notification</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="699.1797" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="641.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="993.9922"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="1664.8613"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2369.2246"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2526.7773"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2801.5723"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1080.5" y="1444.0664"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2854.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1282.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1611.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1940.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="2853.6602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2269.5" y="163.7754"/><path d="M23,170.7754 L471,170.7754 L471,177.7754 L461,187.7754 L23,187.7754 L23,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2839.6602" style="stroke: #000000; stroke-width: 2.0;" width="2481.5" x="23" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="403" x="38" y="184.3438">DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1</text><path d="M131,193.0859 L131,861.0859 L482,861.0859 L482,203.0859 L472,193.0859 L131,193.0859 " fill="#FFFF00" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M472,193.0859 L472,203.0859 L482,203.0859 L472,193.0859 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="137" y="210.6543">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="153" y="225.9648">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="153" y="241.2754">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="153" y="256.5859">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="271.8965">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="153" y="287.207">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="153" y="302.5176">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="153" y="317.8281">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="333.1387">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="348.4492">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="153" y="363.7598">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="379.0703">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="141" y="394.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="137" y="409.6914">Payload - bulkTransferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="425.002">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="153" y="440.3125">“completedTimestamp": &lt;completedTimeStamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="153" y="455.623">“bulkTransferState”: &lt;bulkTransferState&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="470.9336">“individualTransferResults”:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="486.2441">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="501.5547">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="185" y="516.8652">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="185" y="532.1758">“fulfilment”: &lt;ilpCondition&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="185" y="547.4863">"extensionList":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="562.7969">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="201" y="578.1074">"extension":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="593.418">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="608.7285">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="233" y="624.0391">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="233" y="639.3496">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="654.6602">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="669.9707">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="685.2813">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="700.5918">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="153" y="715.9023">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="153" y="731.2129">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="169" y="746.5234">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="761.834">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="201" y="777.1445">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="201" y="792.4551">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="807.7656">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="823.0762">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="838.3867">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="853.6973">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="887.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="895.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="367.5" y1="891.75" y2="891.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="133.5" y="887.0078">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="146.5" y="887.0078">PUT - /bulkTransfers/&lt;ID&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="420.5" y1="936.3711" y2="936.3711"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="420.5" x2="420.5" y1="936.3711" y2="949.3711"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="420.5" y1="949.3711" y2="949.3711"/><polygon fill="#A80036" points="389.5,945.3711,379.5,949.3711,389.5,953.3711,385.5,949.3711" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="923.9736">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="398.5" y="916.3184">Validate incoming message</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="398.5" y="931.6289">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="482.5" y="931.6289">3000-3002, 3100-3107</text><polygon fill="#A80036" points="815.5,989.9922,825.5,993.9922,815.5,997.9922,819.5,993.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="821.5" y1="993.9922" y2="993.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="981.5947">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="398.5" y="973.9395">Persist incoming bulk message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="398.5" y="989.25">to object store</text><polygon fill="#A80036" points="389.5,1019.3027,379.5,1023.3027,389.5,1027.3027,385.5,1023.3027" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="383.5" x2="831.5" y1="1023.3027" y2="1023.3027"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="395.5" y="1018.5605">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="408.5" y="1018.5605">Return reference to the stored object</text><path d="M383,1036.3027 L383,1398.3027 L715,1398.3027 L715,1046.3027 L705,1036.3027 L383,1036.3027 " fill="#FFFF00" filter="url(#fozcvrg2rr0kn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M705,1036.3027 L705,1046.3027 L715,1046.3027 L705,1036.3027 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="389" y="1053.8711">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1069.1816">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="405" y="1084.4922">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="405" y="1099.8027">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="405" y="1115.1133">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="405" y="1130.4238">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="405" y="1145.7344">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="421" y="1161.0449">headers: &lt;bulkTransferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="421" y="1176.3555">payload: &lt;bulkTransferMessage_Reference&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="405" y="1191.666">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="405" y="1206.9766">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="421" y="1222.2871">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="437" y="1237.5977">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="437" y="1252.9082">type: bulk-fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="437" y="1268.2188">action: bulk-commit,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="437" y="1283.5293">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="437" y="1298.8398">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="453" y="1314.1504">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="453" y="1329.4609">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="437" y="1344.7715">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="421" y="1360.082">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="405" y="1375.3926">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1390.7031">}</text><polygon fill="#A80036" points="1068.5,1440.0664,1078.5,1444.0664,1068.5,1448.0664,1072.5,1444.0664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="1074.5" y1="1444.0664" y2="1444.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="1431.6689">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="398.5" y="1424.0137">Route &amp; Publish Bulk Fulfil event for Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="398.5" y="1439.3242">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="475.5" y="1439.3242">2003</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1090.5" x2="1132.5" y1="1503.998" y2="1503.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1132.5" x2="1132.5" y1="1503.998" y2="1516.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1091.5" x2="1132.5" y1="1516.998" y2="1516.998"/><polygon fill="#A80036" points="1101.5,1512.998,1091.5,1516.998,1101.5,1520.998,1097.5,1516.998" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1097.5" y="1483.9453">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="1110.5" y="1468.6348">Ensure event is replicated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="1110.5" y="1483.9453">as configured (ACKS=all)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="1110.5" y="1499.2559">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1187.5" y="1499.2559">2003</text><polygon fill="#A80036" points="389.5,1557.6191,379.5,1561.6191,389.5,1565.6191,385.5,1561.6191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="383.5" x2="1084.5" y1="1561.6191" y2="1561.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="395.5" y="1549.2217">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="408.5" y="1541.5664">Respond replication acknowledgements</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="408.5" y="1556.877">have been received</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1590.9297" y2="1586.9297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1590.9297" y2="1594.9297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="126.5" x2="372.5" y1="1590.9297" y2="1590.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="143.5" y="1586.1875">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="156.5" y="1586.1875">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="1096.5,1616.2402,1086.5,1620.2402,1096.5,1624.2402,1092.5,1620.2402" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1090.5" x2="1281.5" y1="1620.2402" y2="1620.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1102.5" y="1615.498">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1115.5" y="1615.498">Consume message</text><polygon fill="#A80036" points="848.5,1660.8613,838.5,1664.8613,848.5,1668.8613,844.5,1664.8613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="842.5" x2="1281.5" y1="1664.8613" y2="1664.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="854.5" y="1652.4639">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="876.5" y="1644.8086">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="876.5" y="1660.1191">using reference</text><polygon fill="#A80036" points="1270.5,1690.1719,1280.5,1694.1719,1270.5,1698.1719,1274.5,1694.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="832.5" x2="1276.5" y1="1694.1719" y2="1694.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="839.5" y="1689.4297">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="861.5" y="1689.4297">Return payload</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="441.5" x="1037" y="1702.1719"/><polygon fill="#EEEEEE" points="1037,1702.1719,1101,1702.1719,1101,1709.1719,1091,1719.1719,1037,1719.1719,1037,1702.1719" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1050" y="1716.7402">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1170.25" y="1735.7402">Bulk Fulfil Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1174.25" y="1751.0508"/><path d="M1241,1770.1035 L1303,1770.1035 L1303,1777.1035 L1293,1787.1035 L1241,1787.1035 L1241,1770.1035 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="1253.5" x="1241" y="1770.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1256" y="1783.6719">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1318" y="1782.7383">[Success]</text><polygon fill="#A80036" points="1435.5,1804.7246,1445.5,1808.7246,1435.5,1812.7246,1439.5,1808.7246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1292.5" x2="1441.5" y1="1808.7246" y2="1808.7246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1299.5" y="1803.9824">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1321.5" y="1803.9824">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1241" x2="2494.5" y1="1817.7246" y2="1817.7246"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1246" y="1828.3594">[Failure]</text><polygon fill="#A80036" points="2422.5,1848.9902,2432.5,1852.9902,2422.5,1856.9902,2426.5,1852.9902" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1292.5" x2="2428.5" y1="1852.9902" y2="1852.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1299.5" y="1848.248">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1321.5" y="1848.248">Produce message</text><polygon fill="#A80036" points="1458.5,1910.3008,1448.5,1914.3008,1458.5,1918.3008,1454.5,1914.3008" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1452.5" x2="1610.5" y1="1914.3008" y2="1914.3008"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1464.5" y="1909.5586">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1486.5" y="1909.5586">Consume message</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="433" x="1412.5" y="1922.3008"/><polygon fill="#EEEEEE" points="1412.5,1922.3008,1476.5,1922.3008,1476.5,1929.3008,1466.5,1939.3008,1412.5,1939.3008,1412.5,1922.3008" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1425.5" y="1936.8691">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1526" y="1955.8691">Fulfil Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1530" y="1971.1797"/><path d="M1576.5,1990.2324 L1638.5,1990.2324 L1638.5,1997.2324 L1628.5,2007.2324 L1576.5,2007.2324 L1576.5,1990.2324 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1576.5" y="1990.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1591.5" y="2003.8008">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1653.5" y="2002.8672">[Success]</text><polygon fill="#A80036" points="1764.5,2024.8535,1774.5,2028.8535,1764.5,2032.8535,1768.5,2028.8535" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1621.5" x2="1770.5" y1="2028.8535" y2="2028.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1628.5" y="2024.1113">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1650.5" y="2024.1113">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1576.5" x2="2183" y1="2037.8535" y2="2037.8535"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1581.5" y="2048.4883">[Failure]</text><polygon fill="#A80036" points="2093.5,2069.1191,2103.5,2073.1191,2093.5,2077.1191,2097.5,2073.1191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1621.5" x2="2099.5" y1="2073.1191" y2="2073.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1628.5" y="2068.377">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1650.5" y="2068.377">Produce message</text><polygon fill="#A80036" points="1787.5,2130.4297,1777.5,2134.4297,1787.5,2138.4297,1783.5,2134.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1781.5" x2="1939.5" y1="2134.4297" y2="2134.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1793.5" y="2129.6875">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1815.5" y="2129.6875">Consume message</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="468.5" x="1703.5" y="2142.4297"/><polygon fill="#EEEEEE" points="1703.5,2142.4297,1767.5,2142.4297,1767.5,2149.4297,1757.5,2159.4297,1703.5,2159.4297,1703.5,2142.4297" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1716.5" y="2156.998">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="1825.25" y="2175.998">Position Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1829.25" y="2191.3086"/><polygon fill="#A80036" points="2093.5,2220.6719,2103.5,2224.6719,2093.5,2228.6719,2097.5,2224.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1950.5" x2="2099.5" y1="2224.6719" y2="2224.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1957.5" y="2219.9297">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1979.5" y="2219.9297">Produce message</text><polygon fill="#A80036" points="2116.5,2274.9824,2106.5,2278.9824,2116.5,2282.9824,2112.5,2278.9824" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2110.5" x2="2268.5" y1="2278.9824" y2="2278.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2122.5" y="2274.2402">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="2144.5" y="2274.2402">Consume message</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="448.5" x="2035" y="2286.9824"/><polygon fill="#EEEEEE" points="2035,2286.9824,2099,2286.9824,2099,2293.9824,2089,2303.9824,2035,2303.9824,2035,2286.9824" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="2048" y="2301.5508">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="2122.75" y="2320.5508">Bulk Processing Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="2126.75" y="2335.8613"/><polygon fill="#A80036" points="848.5,2365.2246,838.5,2369.2246,848.5,2373.2246,844.5,2369.2246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="842.5" x2="2268.5" y1="2369.2246" y2="2369.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="854.5" y="2364.4824">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="876.5" y="2364.4824">Persist bulk message to object store</text><polygon fill="#A80036" points="2257.5,2394.5352,2267.5,2398.5352,2257.5,2402.5352,2261.5,2398.5352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="832.5" x2="2263.5" y1="2398.5352" y2="2398.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="839.5" y="2393.793">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="861.5" y="2393.793">Return reference to the stored object</text><polygon fill="#A80036" points="2422.5,2423.8457,2432.5,2427.8457,2422.5,2431.8457,2426.5,2427.8457" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2279.5" x2="2428.5" y1="2427.8457" y2="2427.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2286.5" y="2423.1035">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="2308.5" y="2423.1035">Produce message</text><polygon fill="#A80036" points="2422.5,2478.1563,2432.5,2482.1563,2422.5,2486.1563,2426.5,2482.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="2428.5" y1="2482.1563" y2="2482.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2477.4141">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="680.5" y="2477.4141">Consume message</text><polygon fill="#A80036" points="815.5,2522.7773,825.5,2526.7773,815.5,2530.7773,819.5,2526.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="821.5" y1="2526.7773" y2="2526.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2514.3799">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="680.5" y="2506.7246">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="680.5" y="2522.0352">using reference</text><polygon fill="#A80036" points="662.5,2552.0879,652.5,2556.0879,662.5,2560.0879,658.5,2556.0879" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="656.5" x2="831.5" y1="2556.0879" y2="2556.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="668.5" y="2551.3457">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="690.5" y="2551.3457">Return payload</text><path d="M33,2571.0879 L100,2571.0879 L100,2578.0879 L90,2588.0879 L33,2588.0879 L33,2571.0879 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2461.5" x="33" y="2571.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="48" y="2584.6563">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="115" y="2583.7227">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2443.5" x="40" y="2613.3984"/><polygon fill="#EEEEEE" points="40,2613.3984,104,2613.3984,104,2620.3984,94,2630.3984,40,2630.3984,40,2613.3984" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="53" y="2627.9668">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="1143.75" y="2646.9668">Send notification to Participant (Payer)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1147.75" y="2662.2773"/><polygon fill="#A80036" points="78.5,2691.6406,68.5,2695.6406,78.5,2699.6406,74.5,2695.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="640.5" y1="2695.6406" y2="2695.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="2690.8984">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="106.5" y="2690.8984">Send callback notification</text><polygon fill="#A80036" points="2422.5,2752.9512,2432.5,2756.9512,2422.5,2760.9512,2426.5,2756.9512" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="2428.5" y1="2756.9512" y2="2756.9512"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2752.209">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="680.5" y="2752.209">Consume message</text><polygon fill="#A80036" points="815.5,2797.5723,825.5,2801.5723,815.5,2805.5723,819.5,2801.5723" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="821.5" y1="2801.5723" y2="2801.5723"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2789.1748">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="680.5" y="2781.5195">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="680.5" y="2796.8301">using reference</text><polygon fill="#A80036" points="662.5,2826.8828,652.5,2830.8828,662.5,2834.8828,658.5,2830.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="656.5" x2="831.5" y1="2830.8828" y2="2830.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="668.5" y="2826.1406">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="690.5" y="2826.1406">Return payload</text><path d="M92,2845.8828 L159,2845.8828 L159,2852.8828 L149,2862.8828 L92,2862.8828 L92,2845.8828 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2402.5" x="92" y="2845.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="107" y="2859.4512">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="174" y="2858.5176">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#fozcvrg2rr0kn)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2384.5" x="99" y="2888.1934"/><polygon fill="#EEEEEE" points="99,2888.1934,163,2888.1934,163,2895.1934,153,2905.1934,99,2905.1934,99,2888.1934" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="112" y="2902.7617">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="1172.25" y="2921.7617">Send notification to Participant (Payee)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1176.25" y="2937.0723"/><polygon fill="#A80036" points="137.5,2966.4355,127.5,2970.4355,137.5,2974.4355,133.5,2970.4355" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="640.5" y1="2970.4355" y2="2970.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="2965.6934">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="165.5" y="2965.6934">Send callback notification</text><!--
@startuml
title 2.1.0. DFSP2 sends a Bulk Fulfil Success Transfer request

autonumber


actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API \nNotification Handler" as NOTIFY_HANDLER
collections "mongo-\nobject-store" as OBJECT_STORE
boundary "Central Service API" as CSAPI
collections "topic-\nbulk-fulfil" as TOPIC_BULK_FULFIL
control "Bulk Fulfil\nHandler" as BULK_FULFIL_HANDLER
collections "topic-\nfulfil" as TOPIC_FULFIL
control "Fulfil \nHandler" as FULF_HANDLER
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
control "Position \nHandler" as POS_HANDLER
collections "topic-\nbulk-processing" as TOPIC_BULK_PROCESSING
control "Bulk Processing\nHandler" as BULK_PROC_HANDLER
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant OBJECT_STORE
    participant CSAPI
    participant TOPIC_BULK_FULFIL
    participant BULK_FULFIL_HANDLER
	participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_BULK_PROCESSING
    participant BULK_PROC_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate BULK_FULFIL_HANDLER
activate FULF_HANDLER
activate POS_HANDLER
activate BULK_PROC_HANDLER
group DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1
    note right of DFSP2 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - bulkTransferMessage:
        {
            “completedTimestamp": <completedTimeStamp>,
            “bulkTransferState”: <bulkTransferState>,
            “individualTransferResults”: 
            [
                {
                    "transferId": <uuid>, 
                    “fulfilment”: <ilpCondition>,
                    "extensionList":
                    {
                        "extension":
                        [ 
                            { 
                                “key”: <key>, 
                                “value”: <value> 
                            }
                        ]
                    }
                }
            ],
            "extensionList": {
                "extension": [
                    {
                        “key”: <key>, 
                        “value”: <value> 
                    }
                ]
            }
        }
    end note
    DFSP2 ->> MLAPI: PUT - /bulkTransfers/<ID>
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming message\n<color #FF0000><b>Error codes:</b> 3000-3002, 3100-3107</color>
    MLAPI -> OBJECT_STORE: Persist incoming bulk message\nto object store
    activate OBJECT_STORE
    OBJECT_STORE - -> MLAPI: Return reference to the stored object
    deactivate OBJECT_STORE
    note right of MLAPI #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <bulkTransferHeaders>,
                payload: <bulkTransferMessage_Reference>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: bulk-fulfil,
                    action: bulk-commit,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_BULK_FULFIL: Route & Publish Bulk Fulfil event for Payee\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TOPIC_BULK_FULFIL
    TOPIC_BULK_FULFIL <-> TOPIC_BULK_FULFIL: Ensure event is replicated \nas configured (ACKS=all)\n<color #FF0000><b>Error code:</b> 2003</color>
    TOPIC_BULK_FULFIL - -> MLAPI: Respond replication acknowledgements \nhave been received
    deactivate TOPIC_BULK_FULFIL
    MLAPI - ->> DFSP2: Respond HTTP - 200 (OK)
    deactivate MLAPI
    TOPIC_BULK_FULFIL <- BULK_FULFIL_HANDLER: Consume message
    BULK_FULFIL_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> BULK_FULFIL_HANDLER: Return payload
    deactivate OBJECT_STORE
    ref over TOPIC_BULK_FULFIL, TOPIC_FULFIL: Bulk Fulfil Handler Consume\n
    alt Success
        BULK_FULFIL_HANDLER -> TOPIC_FULFIL: Produce message
    else Failure
        BULK_FULFIL_HANDLER - -> TOPIC_NOTIFICATIONS: Produce message
    end
    |||
    TOPIC_FULFIL <- FULF_HANDLER: Consume message
    ref over TOPIC_FULFIL, TOPIC_TRANSFER_POSITION: Fulfil Handler Consume (Success)\n
    alt Success
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Produce message
    else Failure
        FULF_HANDLER - -> TOPIC_BULK_PROCESSING: Produce message
    end
    |||
    TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume message
    ref over TOPIC_TRANSFER_POSITION, TOPIC_BULK_PROCESSING: Position Handler Consume (Success)\n
    POS_HANDLER -> TOPIC_BULK_PROCESSING: Produce message
    |||
    TOPIC_BULK_PROCESSING <- BULK_PROC_HANDLER: Consume message
    ref over TOPIC_BULK_PROCESSING, TOPIC_NOTIFICATIONS: Bulk Processing Handler Consume (Success)\n
    BULK_PROC_HANDLER -> OBJECT_STORE: Persist bulk message to object store
    activate OBJECT_STORE
    OBJECT_STORE - -> BULK_PROC_HANDLER: Return reference to the stored object
    deactivate OBJECT_STORE
    BULK_PROC_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    NOTIFY_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> NOTIFY_HANDLER: Return payload
    deactivate OBJECT_STORE
    opt action == 'commit'
        |||
        ref over DFSP1, TOPIC_NOTIFICATIONS: Send notification to Participant (Payer)\n
        NOTIFY_HANDLER -> DFSP1: Send callback notification
    end
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    NOTIFY_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> NOTIFY_HANDLER: Return payload
    deactivate OBJECT_STORE
    opt action == 'commit'
        |||
        ref over DFSP2, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee)\n
        NOTIFY_HANDLER -> DFSP2: Send callback notification
    end
    |||
end
deactivate POS_HANDLER
activate BULK_FULFIL_HANDLER
deactivate FULF_HANDLER
deactivate BULK_PROC_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2019.06(Fri May 24 22:40:25 IST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_151-b12
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>