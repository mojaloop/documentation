<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3248px" preserveAspectRatio="none" style="width:2666px;height:3248px;" version="1.1" viewBox="0 0 2666 3248" width="2666px" zoomAndPan="magnify"><defs><filter height="300%" id="f14be8qru47z29" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="411" x="1128.75" y="23.5352">2.1.0. DFSP2 sends a Bulk Fulfil Success Transfer request</text><rect fill="#D3D3D3" height="3203.0977" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="3203.0977" style="stroke: #A80036; stroke-width: 1.0;" width="407.5" x="314.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="439.75" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="3203.0977" style="stroke: #A80036; stroke-width: 1.0;" width="1864.5" x="775" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1656.75" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="775.7324" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="641.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="993.9922"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="44.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="1741.4141"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2476.3984"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2633.9512"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2908.7461"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1080.5" y="1520.6191"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2961.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1282.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1712.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2041.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2370.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2946.834" style="stroke: #000000; stroke-width: 2.0;" width="2632.5" x="23" y="170.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="106.1973" style="stroke: #000000; stroke-width: 2.0;" width="1404.5" x="1241" y="1861.9668"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="1404.5" x="1241" y="1923.8984"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1677.5" y="2097.4063"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="606.5" x="1677.5" y="2144.0273"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2612.5" x="33" y="2678.2617"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2553.5" x="92" y="2953.0566"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="373.5" x2="373.5" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="646" x2="646" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="832" x2="832" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="963" x2="963" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1085" x2="1085" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1287" x2="1287" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1548.5" x2="1548.5" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1717.5" x2="1717.5" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1877.5" x2="1877.5" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2046" x2="2046" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2206" x2="2206" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2375" x2="2375" y1="153.7754" y2="3134.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2585.5" x2="2585.5" y1="153.7754" y2="3134.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="134.334">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="150.8223">Payer</text><ellipse cx="67.5" cy="63.7988" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,71.7988 L67.5,98.7988 M54.5,79.7988 L80.5,79.7988 M67.5,98.7988 L54.5,113.7988 M67.5,98.7988 L80.5,113.7988 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="3147.1445">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="3163.6328">Payer</text><ellipse cx="67.5" cy="3176.5859" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,3184.5859 L67.5,3211.5859 M54.5,3192.5859 L80.5,3192.5859 M67.5,3211.5859 L54.5,3226.5859 M67.5,3211.5859 L80.5,3226.5859 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="134.334">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="150.8223">Payee</text><ellipse cx="126.5" cy="63.7988" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,71.7988 L126.5,98.7988 M113.5,79.7988 L139.5,79.7988 M126.5,98.7988 L113.5,113.7988 M126.5,98.7988 L139.5,113.7988 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="3147.1445">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="3163.6328">Payee</text><ellipse cx="126.5" cy="3176.5859" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,3184.5859 L126.5,3211.5859 M113.5,3192.5859 L139.5,3192.5859 M126.5,3211.5859 L113.5,3226.5859 M126.5,3211.5859 L139.5,3226.5859 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="150.8223">ML API Adapter</text><path d="M353,109.2871 L353,133.2871 M353,121.2871 L370,121.2871 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="121.2871" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="3147.1445">ML API Adapter</text><path d="M353,3154.0977 L353,3178.0977 M353,3166.0977 L370,3166.0977 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="3166.0977" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="619" y="134.334">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="575" y="150.8223">Notification Handler</text><ellipse cx="646.5" cy="104.7988" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="642.5,92.7988,648.5,87.7988,646.5,92.7988,648.5,97.7988,642.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="619" y="3147.1445">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="575" y="3163.6328">Notification Handler</text><ellipse cx="646.5" cy="3182.5859" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="642.5,3170.5859,648.5,3165.5859,646.5,3170.5859,648.5,3175.5859,642.5,3170.5859" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="783" y="97.7988"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="779" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="800" y="122.334">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="786" y="138.8223">object-store</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="783" y="3133.6094"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="779" y="3137.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="800" y="3158.1445">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="786" y="3174.6328">object-store</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="896" y="150.8223">Central Service API</text><path d="M942.5,109.2871 L942.5,133.2871 M942.5,121.2871 L959.5,121.2871 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="971.5" cy="121.2871" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="896" y="3147.1445">Central Service API</text><path d="M942.5,3154.0977 L942.5,3178.0977 M942.5,3166.0977 L959.5,3166.0977 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="971.5" cy="3166.0977" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1044" y="97.7988"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1040" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1060.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="1047" y="138.8223">bulk-fulfil</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1044" y="3133.6094"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="1040" y="3137.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1060.5" y="3158.1445">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="1047" y="3174.6328">bulk-fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1251" y="134.334">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1257.5" y="150.8223">Handler</text><ellipse cx="1287.5" cy="104.7988" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1283.5,92.7988,1289.5,87.7988,1287.5,92.7988,1289.5,97.7988,1283.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1251" y="3147.1445">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1257.5" y="3163.6328">Handler</text><ellipse cx="1287.5" cy="3182.5859" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1283.5,3170.5859,1289.5,3165.5859,1287.5,3170.5859,1289.5,3175.5859,1283.5,3170.5859" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1520.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1516.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1523.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1529" y="138.8223">fulfil</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1520.5" y="3133.6094"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1516.5" y="3137.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1523.5" y="3158.1445">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1529" y="3174.6328">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1695.5" y="134.334">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1687.5" y="150.8223">Handler</text><ellipse cx="1717.5" cy="104.7988" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1713.5,92.7988,1719.5,87.7988,1717.5,92.7988,1719.5,97.7988,1713.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1695.5" y="3147.1445">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1687.5" y="3163.6328">Handler</text><ellipse cx="1717.5" cy="3182.5859" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1713.5,3170.5859,1719.5,3165.5859,1717.5,3170.5859,1719.5,3175.5859,1713.5,3170.5859" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1811.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1807.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1852.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1814.5" y="138.8223">transfer-position</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1811.5" y="3133.6094"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1807.5" y="3137.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1852.5" y="3158.1445">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1814.5" y="3174.6328">transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="2014" y="134.334">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2016.5" y="150.8223">Handler</text><ellipse cx="2046.5" cy="104.7988" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2042.5,92.7988,2048.5,87.7988,2046.5,92.7988,2048.5,97.7988,2042.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="2014" y="3147.1445">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2016.5" y="3163.6328">Handler</text><ellipse cx="2046.5" cy="3182.5859" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2042.5,3170.5859,2048.5,3165.5859,2046.5,3170.5859,2048.5,3175.5859,2042.5,3170.5859" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2143" y="97.7988"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2139" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2181.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="2146" y="138.8223">bulk-processing</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2143" y="3133.6094"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="2139" y="3137.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2181.5" y="3158.1445">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="2146" y="3174.6328">bulk-processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2319" y="134.334">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2345.5" y="150.8223">Handler</text><ellipse cx="2375.5" cy="104.7988" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2371.5,92.7988,2377.5,87.7988,2375.5,92.7988,2377.5,97.7988,2371.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2319" y="3147.1445">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2345.5" y="3163.6328">Handler</text><ellipse cx="2375.5" cy="3182.5859" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2371.5,3170.5859,2377.5,3165.5859,2375.5,3170.5859,2377.5,3175.5859,2371.5,3170.5859" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2539.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2535.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2560.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2542.5" y="138.8223">notification</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2539.5" y="3133.6094"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2535.5" y="3137.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2560.5" y="3158.1445">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2542.5" y="3174.6328">notification</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="775.7324" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="641.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="993.9922"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="44.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="1741.4141"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2476.3984"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2633.9512"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="827.5" y="2908.7461"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1080.5" y="1520.6191"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2961.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1282.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1712.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2041.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2960.834" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2370.5" y="163.7754"/><path d="M23,170.7754 L471,170.7754 L471,177.7754 L461,187.7754 L23,187.7754 L23,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2946.834" style="stroke: #000000; stroke-width: 2.0;" width="2632.5" x="23" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="403" x="38" y="184.3438">DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1</text><path d="M131,193.0859 L131,861.0859 L482,861.0859 L482,203.0859 L472,193.0859 L131,193.0859 " fill="#FFFF00" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M472,193.0859 L472,203.0859 L482,203.0859 L472,193.0859 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="137" y="210.6543">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="153" y="225.9648">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="153" y="241.2754">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="153" y="256.5859">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="271.8965">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="153" y="287.207">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="153" y="302.5176">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="153" y="317.8281">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="333.1387">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="348.4492">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="153" y="363.7598">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="379.0703">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="141" y="394.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="137" y="409.6914">Payload - bulkTransferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="425.002">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="153" y="440.3125">“completedTimestamp": &lt;completedTimeStamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="153" y="455.623">“bulkTransferState”: &lt;bulkTransferState&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="470.9336">“individualTransferResults”:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="486.2441">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="501.5547">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="185" y="516.8652">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="185" y="532.1758">“fulfilment”: &lt;ilpCondition&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="185" y="547.4863">"extensionList":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="562.7969">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="201" y="578.1074">"extension":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="593.418">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="608.7285">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="233" y="624.0391">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="233" y="639.3496">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="654.6602">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="669.9707">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="685.2813">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="700.5918">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="153" y="715.9023">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="153" y="731.2129">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="169" y="746.5234">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="761.834">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="201" y="777.1445">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="201" y="792.4551">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="807.7656">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="823.0762">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="838.3867">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="853.6973">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="887.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="895.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="367.5" y1="891.75" y2="891.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="133.5" y="887.0078">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="146.5" y="887.0078">PUT - /bulkTransfers/&lt;ID&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="420.5" y1="936.3711" y2="936.3711"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="420.5" x2="420.5" y1="936.3711" y2="949.3711"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="420.5" y1="949.3711" y2="949.3711"/><polygon fill="#A80036" points="389.5,945.3711,379.5,949.3711,389.5,953.3711,385.5,949.3711" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="923.9736">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="398.5" y="916.3184">Validate incoming message</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="398.5" y="931.6289">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="482.5" y="931.6289">3000-3002, 3100-3107</text><polygon fill="#A80036" points="815.5,989.9922,825.5,993.9922,815.5,997.9922,819.5,993.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="821.5" y1="993.9922" y2="993.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="981.5947">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="398.5" y="973.9395">Persist incoming bulk message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="398.5" y="989.25">to object store</text><polygon fill="#A80036" points="389.5,1019.3027,379.5,1023.3027,389.5,1027.3027,385.5,1023.3027" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="383.5" x2="831.5" y1="1023.3027" y2="1023.3027"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="395.5" y="1018.5605">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="408.5" y="1018.5605">Return reference to the stored object</text><path d="M383,1036.3027 L383,1474.3027 L878,1474.3027 L878,1046.3027 L868,1036.3027 L383,1036.3027 " fill="#FFFF00" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M868,1036.3027 L868,1046.3027 L878,1046.3027 L868,1036.3027 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="389" y="1053.8711">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1069.1816">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="405" y="1084.4922">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="405" y="1099.8027">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="405" y="1115.1133">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="405" y="1130.4238">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="405" y="1145.7344">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="421" y="1161.0449">headers: &lt;bulkTransferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="421" y="1176.3555">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="437" y="1191.666">objstore: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="469" y="1206.9766">transactionid: &lt;bulkTransferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="394" x="469" y="1222.2871">referenceid: &lt;bulkTransferMessage_ObjectStoreReference_ID&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="437" y="1237.5977">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="421" y="1252.9082">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="405" y="1268.2188">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="405" y="1283.5293">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="421" y="1298.8398">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="437" y="1314.1504">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="437" y="1329.4609">type: bulk-fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="437" y="1344.7715">action: bulk-commit,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="437" y="1360.082">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="437" y="1375.3926">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="453" y="1390.7031">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="453" y="1406.0137">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="437" y="1421.3242">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="421" y="1436.6348">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="405" y="1451.9453">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1467.2559">}</text><polygon fill="#A80036" points="1068.5,1516.6191,1078.5,1520.6191,1068.5,1524.6191,1072.5,1520.6191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="1074.5" y1="1520.6191" y2="1520.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="1508.2217">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="398.5" y="1500.5664">Route &amp; Publish Bulk Fulfil event for Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="398.5" y="1515.877">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="475.5" y="1515.877">2003</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1090.5" x2="1132.5" y1="1580.5508" y2="1580.5508"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1132.5" x2="1132.5" y1="1580.5508" y2="1593.5508"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1091.5" x2="1132.5" y1="1593.5508" y2="1593.5508"/><polygon fill="#A80036" points="1101.5,1589.5508,1091.5,1593.5508,1101.5,1597.5508,1097.5,1593.5508" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1097.5" y="1560.498">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="1110.5" y="1545.1875">Ensure event is replicated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="1110.5" y="1560.498">as configured (ACKS=all)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="1110.5" y="1575.8086">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1187.5" y="1575.8086">2003</text><polygon fill="#A80036" points="389.5,1634.1719,379.5,1638.1719,389.5,1642.1719,385.5,1638.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="383.5" x2="1084.5" y1="1638.1719" y2="1638.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="395.5" y="1625.7744">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="408.5" y="1618.1191">Respond replication acknowledgements</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="408.5" y="1633.4297">have been received</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1667.4824" y2="1663.4824"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1667.4824" y2="1671.4824"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="126.5" x2="372.5" y1="1667.4824" y2="1667.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="143.5" y="1662.7402">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="156.5" y="1662.7402">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="1096.5,1692.793,1086.5,1696.793,1096.5,1700.793,1092.5,1696.793" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1090.5" x2="1281.5" y1="1696.793" y2="1696.793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1102.5" y="1692.0508">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1115.5" y="1692.0508">Consume message</text><polygon fill="#A80036" points="848.5,1737.4141,838.5,1741.4141,848.5,1745.4141,844.5,1741.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="842.5" x2="1281.5" y1="1741.4141" y2="1741.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="854.5" y="1729.0166">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="876.5" y="1721.3613">Retrieve bulk payload using reference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="876.5" y="1736.6719">by streaming individual transfers</text><polygon fill="#A80036" points="1270.5,1782.0352,1280.5,1786.0352,1270.5,1790.0352,1274.5,1786.0352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="832.5" x2="1276.5" y1="1786.0352" y2="1786.0352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="839.5" y="1773.6377">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="861.5" y="1765.9824">Return individual transfers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="861.5" y="1781.293">part of the payload</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="542.5" x="1037" y="1794.0352"/><polygon fill="#EEEEEE" points="1037,1794.0352,1101,1794.0352,1101,1801.0352,1091,1811.0352,1037,1811.0352,1037,1794.0352" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1050" y="1808.6035">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1220.75" y="1827.6035">Bulk Fulfil Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1224.75" y="1842.9141"/><path d="M1241,1861.9668 L1303,1861.9668 L1303,1868.9668 L1293,1878.9668 L1241,1878.9668 L1241,1861.9668 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.1973" style="stroke: #000000; stroke-width: 2.0;" width="1404.5" x="1241" y="1861.9668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1256" y="1875.5352">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1318" y="1874.6016">[Success]</text><polygon fill="#A80036" points="1536.5,1911.8984,1546.5,1915.8984,1536.5,1919.8984,1540.5,1915.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1292.5" x2="1542.5" y1="1915.8984" y2="1915.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1299.5" y="1903.501">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="1321.5" y="1895.8457">Produce single transfer message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1321.5" y="1911.1563">for each individual transfer [loop]</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1241" x2="2645.5" y1="1924.8984" y2="1924.8984"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1246" y="1935.5332">[Failure]</text><polygon fill="#A80036" points="2573.5,1956.1641,2583.5,1960.1641,2573.5,1964.1641,2577.5,1960.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1292.5" x2="2579.5" y1="1960.1641" y2="1960.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1299.5" y="1955.4219">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="1321.5" y="1955.4219">Produce message for the bulk transfer</text><polygon fill="#A80036" points="1559.5,2017.4746,1549.5,2021.4746,1559.5,2025.4746,1555.5,2021.4746" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1553.5" x2="1711.5" y1="2021.4746" y2="2021.4746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1565.5" y="2016.7324">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1587.5" y="2016.7324">Consume message</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="433" x="1513.5" y="2029.4746"/><polygon fill="#EEEEEE" points="1513.5,2029.4746,1577.5,2029.4746,1577.5,2036.4746,1567.5,2046.4746,1513.5,2046.4746,1513.5,2029.4746" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1526.5" y="2044.043">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1627" y="2063.043">Fulfil Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1631" y="2078.3535"/><path d="M1677.5,2097.4063 L1739.5,2097.4063 L1739.5,2104.4063 L1729.5,2114.4063 L1677.5,2114.4063 L1677.5,2097.4063 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1677.5" y="2097.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1692.5" y="2110.9746">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1754.5" y="2110.041">[Success]</text><polygon fill="#A80036" points="1865.5,2132.0273,1875.5,2136.0273,1865.5,2140.0273,1869.5,2136.0273" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1722.5" x2="1871.5" y1="2136.0273" y2="2136.0273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1729.5" y="2131.2852">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1751.5" y="2131.2852">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1677.5" x2="2284" y1="2145.0273" y2="2145.0273"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1682.5" y="2155.6621">[Failure]</text><polygon fill="#A80036" points="2194.5,2176.293,2204.5,2180.293,2194.5,2184.293,2198.5,2180.293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1722.5" x2="2200.5" y1="2180.293" y2="2180.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1729.5" y="2175.5508">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1751.5" y="2175.5508">Produce message</text><polygon fill="#A80036" points="1888.5,2237.6035,1878.5,2241.6035,1888.5,2245.6035,1884.5,2241.6035" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1882.5" x2="2040.5" y1="2241.6035" y2="2241.6035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1894.5" y="2236.8613">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1916.5" y="2236.8613">Consume message</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="468.5" x="1804.5" y="2249.6035"/><polygon fill="#EEEEEE" points="1804.5,2249.6035,1868.5,2249.6035,1868.5,2256.6035,1858.5,2266.6035,1804.5,2266.6035,1804.5,2249.6035" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1817.5" y="2264.1719">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="1926.25" y="2283.1719">Position Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1930.25" y="2298.4824"/><polygon fill="#A80036" points="2194.5,2327.8457,2204.5,2331.8457,2194.5,2335.8457,2198.5,2331.8457" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2051.5" x2="2200.5" y1="2331.8457" y2="2331.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2058.5" y="2327.1035">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="2080.5" y="2327.1035">Produce message</text><polygon fill="#A80036" points="2217.5,2382.1563,2207.5,2386.1563,2217.5,2390.1563,2213.5,2386.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2211.5" x2="2369.5" y1="2386.1563" y2="2386.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2223.5" y="2381.4141">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="2245.5" y="2381.4141">Consume message</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="498.5" x="2136" y="2394.1563"/><polygon fill="#EEEEEE" points="2136,2394.1563,2200,2394.1563,2200,2401.1563,2190,2411.1563,2136,2411.1563,2136,2394.1563" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="2149" y="2408.7246">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="2248.75" y="2427.7246">Bulk Processing Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="2252.75" y="2443.0352"/><polygon fill="#A80036" points="848.5,2472.3984,838.5,2476.3984,848.5,2480.3984,844.5,2476.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="842.5" x2="2369.5" y1="2476.3984" y2="2476.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="854.5" y="2471.6563">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="876.5" y="2471.6563">Persist bulk message to object store</text><polygon fill="#A80036" points="2358.5,2501.709,2368.5,2505.709,2358.5,2509.709,2362.5,2505.709" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="832.5" x2="2364.5" y1="2505.709" y2="2505.709"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="839.5" y="2500.9668">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="861.5" y="2500.9668">Return reference to the stored object</text><polygon fill="#A80036" points="2573.5,2531.0195,2583.5,2535.0195,2573.5,2539.0195,2577.5,2535.0195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2380.5" x2="2579.5" y1="2535.0195" y2="2535.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2387.5" y="2530.2773">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="2409.5" y="2530.2773">Produce bulk notification</text><polygon fill="#A80036" points="2573.5,2585.3301,2583.5,2589.3301,2573.5,2593.3301,2577.5,2589.3301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="2579.5" y1="2589.3301" y2="2589.3301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2584.5879">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="680.5" y="2584.5879">Consume message</text><polygon fill="#A80036" points="815.5,2629.9512,825.5,2633.9512,815.5,2637.9512,819.5,2633.9512" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="821.5" y1="2633.9512" y2="2633.9512"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2621.5537">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="680.5" y="2613.8984">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="680.5" y="2629.209">using reference</text><polygon fill="#A80036" points="662.5,2659.2617,652.5,2663.2617,662.5,2667.2617,658.5,2663.2617" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="656.5" x2="831.5" y1="2663.2617" y2="2663.2617"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="668.5" y="2658.5195">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="690.5" y="2658.5195">Return payload</text><path d="M33,2678.2617 L100,2678.2617 L100,2685.2617 L90,2695.2617 L33,2695.2617 L33,2678.2617 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2612.5" x="33" y="2678.2617"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="48" y="2691.8301">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="115" y="2690.8965">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2594.5" x="40" y="2720.5723"/><polygon fill="#EEEEEE" points="40,2720.5723,104,2720.5723,104,2727.5723,94,2737.5723,40,2737.5723,40,2720.5723" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="53" y="2735.1406">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="1219.25" y="2754.1406">Send notification to Participant (Payer)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1223.25" y="2769.4512"/><polygon fill="#A80036" points="78.5,2798.8145,68.5,2802.8145,78.5,2806.8145,74.5,2802.8145" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="640.5" y1="2802.8145" y2="2802.8145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="2798.0723">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="106.5" y="2798.0723">Send callback notification</text><polygon fill="#A80036" points="2573.5,2860.125,2583.5,2864.125,2573.5,2868.125,2577.5,2864.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="2579.5" y1="2864.125" y2="2864.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2859.3828">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="680.5" y="2859.3828">Consume message</text><polygon fill="#A80036" points="815.5,2904.7461,825.5,2908.7461,815.5,2912.7461,819.5,2908.7461" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="821.5" y1="2908.7461" y2="2908.7461"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2896.3486">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="680.5" y="2888.6934">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="680.5" y="2904.0039">using reference</text><polygon fill="#A80036" points="662.5,2934.0566,652.5,2938.0566,662.5,2942.0566,658.5,2938.0566" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="656.5" x2="831.5" y1="2938.0566" y2="2938.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="668.5" y="2933.3145">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="690.5" y="2933.3145">Return payload</text><path d="M92,2953.0566 L159,2953.0566 L159,2960.0566 L149,2970.0566 L92,2970.0566 L92,2953.0566 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2553.5" x="92" y="2953.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="107" y="2966.625">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="174" y="2965.6914">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2535.5" x="99" y="2995.3672"/><polygon fill="#EEEEEE" points="99,2995.3672,163,2995.3672,163,3002.3672,153,3012.3672,99,3012.3672,99,2995.3672" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="112" y="3009.9355">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="1247.75" y="3028.9355">Send notification to Participant (Payee)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1251.75" y="3044.2461"/><polygon fill="#A80036" points="137.5,3073.6094,127.5,3077.6094,137.5,3081.6094,133.5,3077.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="640.5" y1="3077.6094" y2="3077.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="3072.8672">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="165.5" y="3072.8672">Send callback notification</text><!--
@startuml
title 2.1.0. DFSP2 sends a Bulk Fulfil Success Transfer request

autonumber


actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API \nNotification Handler" as NOTIFY_HANDLER
collections "mongo-\nobject-store" as OBJECT_STORE
boundary "Central Service API" as CSAPI
collections "topic-\nbulk-fulfil" as TOPIC_BULK_FULFIL
control "Bulk Fulfil\nHandler" as BULK_FULFIL_HANDLER
collections "topic-\nfulfil" as TOPIC_FULFIL
control "Fulfil \nHandler" as FULF_HANDLER
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
control "Position \nHandler" as POS_HANDLER
collections "topic-\nbulk-processing" as TOPIC_BULK_PROCESSING
control "Bulk Processing\nHandler" as BULK_PROC_HANDLER
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant OBJECT_STORE
    participant CSAPI
    participant TOPIC_BULK_FULFIL
    participant BULK_FULFIL_HANDLER
	participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_BULK_PROCESSING
    participant BULK_PROC_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate BULK_FULFIL_HANDLER
activate FULF_HANDLER
activate POS_HANDLER
activate BULK_PROC_HANDLER
group DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1
    note right of DFSP2 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - bulkTransferMessage:
        {
            “completedTimestamp": <completedTimeStamp>,
            “bulkTransferState”: <bulkTransferState>,
            “individualTransferResults”: 
            [
                {
                    "transferId": <uuid>, 
                    “fulfilment”: <ilpCondition>,
                    "extensionList":
                    {
                        "extension":
                        [ 
                            { 
                                “key”: <key>, 
                                “value”: <value> 
                            }
                        ]
                    }
                }
            ],
            "extensionList": {
                "extension": [
                    {
                        “key”: <key>, 
                        “value”: <value> 
                    }
                ]
            }
        }
    end note
    DFSP2 ->> MLAPI: PUT - /bulkTransfers/<ID>
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming message\n<color #FF0000><b>Error codes:</b> 3000-3002, 3100-3107</color>
    MLAPI -> OBJECT_STORE: Persist incoming bulk message\nto object store
    activate OBJECT_STORE
    OBJECT_STORE - -> MLAPI: Return reference to the stored object
    deactivate OBJECT_STORE
    note right of MLAPI #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <bulkTransferHeaders>,
                payload: {
                    objstore: {
                            transactionid: <bulkTransferId>
                            referenceid: <bulkTransferMessage_ObjectStoreReference_ID>
                    }
                }
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: bulk-fulfil,
                    action: bulk-commit,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_BULK_FULFIL: Route & Publish Bulk Fulfil event for Payee\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TOPIC_BULK_FULFIL
    TOPIC_BULK_FULFIL <-> TOPIC_BULK_FULFIL: Ensure event is replicated \nas configured (ACKS=all)\n<color #FF0000><b>Error code:</b> 2003</color>
    TOPIC_BULK_FULFIL - -> MLAPI: Respond replication acknowledgements \nhave been received
    deactivate TOPIC_BULK_FULFIL
    MLAPI - ->> DFSP2: Respond HTTP - 200 (OK)
    deactivate MLAPI
    TOPIC_BULK_FULFIL <- BULK_FULFIL_HANDLER: Consume message
    BULK_FULFIL_HANDLER -> OBJECT_STORE: Retrieve bulk payload using reference\nby streaming individual transfers
    activate OBJECT_STORE
    OBJECT_STORE - -> BULK_FULFIL_HANDLER: Return individual transfers\npart of the payload
    deactivate OBJECT_STORE
    ref over TOPIC_BULK_FULFIL, TOPIC_FULFIL: Bulk Fulfil Handler Consume\n
    alt Success
        BULK_FULFIL_HANDLER -> TOPIC_FULFIL: Produce single transfer message\nfor each individual transfer [loop]
    else Failure
        BULK_FULFIL_HANDLER - -> TOPIC_NOTIFICATIONS: Produce message for the bulk transfer
    end
    |||
    TOPIC_FULFIL <- FULF_HANDLER: Consume message
    ref over TOPIC_FULFIL, TOPIC_TRANSFER_POSITION: Fulfil Handler Consume (Success)\n
    alt Success
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Produce message
    else Failure
        FULF_HANDLER - -> TOPIC_BULK_PROCESSING: Produce message
    end
    |||
    TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume message
    ref over TOPIC_TRANSFER_POSITION, TOPIC_BULK_PROCESSING: Position Handler Consume (Success)\n
    POS_HANDLER -> TOPIC_BULK_PROCESSING: Produce message
    |||
    TOPIC_BULK_PROCESSING <- BULK_PROC_HANDLER: Consume message
    ref over TOPIC_BULK_PROCESSING, TOPIC_NOTIFICATIONS: Bulk Processing Handler Consume (Success)\n
    BULK_PROC_HANDLER -> OBJECT_STORE: Persist bulk message to object store
    activate OBJECT_STORE
    OBJECT_STORE - -> BULK_PROC_HANDLER: Return reference to the stored object
    deactivate OBJECT_STORE
    BULK_PROC_HANDLER -> TOPIC_NOTIFICATIONS: Produce bulk notification
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    NOTIFY_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> NOTIFY_HANDLER: Return payload
    deactivate OBJECT_STORE
    opt action == 'commit'
        |||
        ref over DFSP1, TOPIC_NOTIFICATIONS: Send notification to Participant (Payer)\n
        NOTIFY_HANDLER -> DFSP1: Send callback notification
    end
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    NOTIFY_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> NOTIFY_HANDLER: Return payload
    deactivate OBJECT_STORE
    opt action == 'commit'
        |||
        ref over DFSP2, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee)\n
        NOTIFY_HANDLER -> DFSP2: Send callback notification
    end
    |||
end
deactivate POS_HANDLER
activate BULK_FULFIL_HANDLER
deactivate FULF_HANDLER
deactivate BULK_PROC_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.14.5
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>