<svg xmlns="http://www.w3.org/2000/svg" height="4944" preserveAspectRatio="none" style="width:2062px;height:4944px" width="2062">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="523" x="767.5" y="28.708">
    6.1.2. Close Settlement Window (closeSettlementWindow)
  </text>
  <path fill="#FFB6C1" stroke="#a80036" d="M46 40.953h114v4897.438H46z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="58.5" y="53.02">
    Central HUB
  </text>
  <path fill="#90EE90" stroke="#a80036" d="M288.5 40.953H1259v4897.438H288.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="704.25" y="53.02">
    Settlement Service
  </text>
  <path fill="#FFFFE0" stroke="#a80036" d="M1587.5 40.953h125v4897.438h-125z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="1590.5" y="53.02">
    Central Services
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M98 153.383h10v2048.086H98zM98 4820.094h10v15H98zM368 283.18h10v1918.289h-10zM368 4671.164h10v148.93h-10zM621 2012.406h10v30h-10zM621 2269.867h10v30h-10zM860 153.383h10v4681.711h-10zM1191.5 559.773h10v197.063h-10zM1191.5 849.367h10v694.32h-10zM1191.5 2677.727h10v136.531h-10zM1191.5 2882.656h10v1243.906h-10zM1191.5 4241.094h10v59.133h-10zM1191.5 4461.5h10v59.133h-10zM1645 588.906h10v30h-10zM1645 941.766h10v92.531h-10zM1645 1063.43h10v30h-10zM1645 1185.961h10v77.398h-10zM1645 1292.492h10v92.531h-10zM1645 1414.156h10v30h-10zM1645 2706.859h10v30h-10zM1645 2975.055h10v30h-10zM1645 3097.586h10v398.258h-10zM1645 3524.977h10v30h-10zM1645 3874.5h10v30h-10zM1645 4027.297h10v30h-10zM1645 4270.227h10v30h-10zM1645 4490.633h10v30h-10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M10 160.383h2038v4674.711H10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M40 355.445h697v161.063H40zM20 771.836h2018v4056.258H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M282.5 795.969H1957v755.719H282.5z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M1128 864.367h819v651.188h-819zM539 2216.469h1489v2416.563H539z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M785 2314.867h353v156.664H785zM775 2554.93h1243v2071.102H775z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M785 2829.258h1223v1305.305H785z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M1128 2897.656h870v1200.773h-870zM785 4148.563h1018v470.469H785z"/>
  <path fill="#FFF" d="M785 4356.492h1018v53.938H785zM785 4410.43h1018v208.602H785zM20 4640.031h2018v188.063H20z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M103 143.383v4708.711M372.5 143.383v4708.711M626 143.383v4708.711M865 143.383v4708.711M1078 143.383v4708.711M1196 143.383v4708.711M1650 143.383v4708.711"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="50" y="140.081">
    Hub Employee
  </text>
  <circle cx="103" cy="70.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="8"/>
  <path d="M103 78.086v27m-13-19h26m-13 19l-13 15m13-15l13 15" fill="none" filter="url(#a)" stroke="#a80036" stroke-width="2"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="50" y="4864.089">
    Hub Employee
  </text>
  <circle cx="103" cy="4877.391" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="8"/>
  <path d="M103 4885.39v27m-13-19h26m-13 19l-13 15m13-15l13 15" fill="none" filter="url(#a)" stroke="#a80036" stroke-width="2"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="155" x="292.5" y="140.081">
    Settlement Service API
  </text>
  <path d="M352.5 99.086v24m0-12h17" fill="none" filter="url(#a)" stroke="#a80036" stroke-width="2"/>
  <circle cx="381.5" cy="111.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="155" x="292.5" y="4864.089">
    Settlement Service API
  </text>
  <path d="M352.5 4871.39v24m0-12h17" fill="none" filter="url(#a)" stroke="#a80036" stroke-width="2"/>
  <circle cx="381.5" cy="4883.391" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M553 87.789h146v46.594H553z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M549 91.789h146v46.594H549z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="602.5" y="111.784">
    topic-
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="556" y="128.081">
    settlement-window
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M553 4851.094h146v46.594H553z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M549 4855.094h146v46.594H549z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="602.5" y="4875.089">
    topic-
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="556" y="4891.386">
    settlement-window
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="795" y="123.784">
    Settlement Window
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="835.5" y="140.081">
    Handler
  </text>
  <circle cx="865" cy="94.789" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M861 82.79l6-5-2 5 2 5-6-5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="795" y="4864.089">
    Settlement Window
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="835.5" y="4880.386">
    Handler
  </text>
  <circle cx="865" cy="4899.688" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M861 4887.688l6-5-2 5 2 5-6-5z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1032 104.086h92v30.297h-92z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1028 108.086h92v30.297h-92z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1035" y="128.081">
    topic-event
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1032 4851.094h92v30.297h-92z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1028 4855.094h92v30.297h-92z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1035" y="4875.089">
    topic-event
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1138" y="140.081">
    Settlement DAO
  </text>
  <circle cx="1196.5" cy="111.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M1184.5 125.086h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1138" y="4864.089">
    Settlement DAO
  </text>
  <circle cx="1196.5" cy="4883.391" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M1184.5 4897.391h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1602" y="140.081">
    Central Store
  </text>
  <path d="M1632 91.086c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10v-26" fill="#FEFECE" filter="url(#a)" stroke="#000" stroke-width="1.5"/>
  <path d="M1632 91.086c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#000" stroke-width="1.5"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1602" y="4864.089">
    Central Store
  </text>
  <path d="M1632 4877.39c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10v-26" fill="#FEFECE" filter="url(#a)" stroke="#000" stroke-width="1.5"/>
  <path d="M1632 4877.39c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#000" stroke-width="1.5"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M98 153.383h10v2048.086H98zM98 4820.094h10v15H98zM368 283.18h10v1918.289h-10zM368 4671.164h10v148.93h-10zM621 2012.406h10v30h-10zM621 2269.867h10v30h-10zM860 153.383h10v4681.711h-10zM1191.5 559.773h10v197.063h-10zM1191.5 849.367h10v694.32h-10zM1191.5 2677.727h10v136.531h-10zM1191.5 2882.656h10v1243.906h-10zM1191.5 4241.094h10v59.133h-10zM1191.5 4461.5h10v59.133h-10zM1645 588.906h10v30h-10zM1645 941.766h10v92.531h-10zM1645 1063.43h10v30h-10zM1645 1185.961h10v77.398h-10zM1645 1292.492h10v92.531h-10zM1645 1414.156h10v30h-10zM1645 2706.859h10v30h-10zM1645 2975.055h10v30h-10zM1645 3097.586h10v398.258h-10zM1645 3524.977h10v30h-10zM1645 3874.5h10v30h-10zM1645 4027.297h10v30h-10zM1645 4270.227h10v30h-10zM1645 4490.633h10v30h-10z"/>
  <path d="M10 160.383h234v7l-10 10H10v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M10 160.383h2038v4674.711H10z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="189" x="25" y="173.45">
    Close Settlement Window
  </text>
  <path d="M113 182.516v70h157v-60l-10-10H113" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M260 182.516v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="119" y="199.583">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="135" y="214.715">
    &quot;state&quot;: &quot;CLOSED&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="135" y="229.848">
    &quot;reason&quot;: &lt;string&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="119" y="244.981">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M356 279.18l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M108 283.18h254"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="115" y="278.114">
    1
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="128" y="278.114">
    POST - /settlementWindows/{id}
  </text>
  <path stroke="#a80036" d="M378 327.445h42M420 327.445v13M379 340.445h41"/>
  <path fill="#A80036" stroke="#a80036" d="M389 336.445l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385" y="314.813">
    2
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="398" y="307.247">
    Validate payload, existing window,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="398" y="322.379">
    state, assigned transfers, etc.
  </text>
  <path d="M40 355.445h88v7l-10 10H40v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M40 355.445h697v161.063H40z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="55" y="368.512">
    break
  </text>
  <path d="M383 377.578v100h340v-90l-10-10H383" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M713 377.578v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="389" y="394.645">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="405" y="409.778">
    &quot;errorInformation&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="421" y="424.911">
    &quot;errorCode&quot;: &lt;integer&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="287" x="421" y="440.043">
    &quot;errorDescription&quot;: &quot;FSPIOP Error Description&quot;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="405" y="455.176">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="389" y="470.309">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M119 504.508l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M113 508.508h254"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="125" y="503.442">
    3
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="138" y="503.442">
    Respond HTTP - 400 (Bad Request)
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1179.5 555.773l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M378 559.773h807.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385" y="547.141">
    4
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="398" y="539.575">
    Get requested settlementWindow and state
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="398" y="554.707">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="484" y="554.707">
    2001
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 584.906l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 588.906H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1208.5" y="583.84">
    5
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="1221.5" y="583.84">
    Get settlementWindow state
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1423 631.906h454l10 49-10 49h-454l-10-49 10-49z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="409" x="1425" y="647.973">
    SELECT sw.settlementWindowId, swsc.settlementWindowStateId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="398" x="1453" y="663.106">
    swsc.reason, sw.createdDate, swsc.createdDate changedDate
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1425" y="678.239">
    FROM
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="1465" y="678.239">
    settlementWindow
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="1607" y="678.239">
    AS sw
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1425" y="693.372">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="233" x="1455" y="693.372">
    settlementWindowStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="1692" y="693.372">
    AS swsc
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="450" x="1425" y="708.504">
    ON swsc.settlementWindowStateChangeId = sw.currentStateChangeId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="1425" y="723.637">
    WHERE sw.settlementWindowId = {id}
  </text>
  <path fill="#A80036" stroke="#a80036" d="M389 752.836l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M383 756.836h812.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="395" y="751.77">
    6
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="408" y="751.77">
    Return result
  </text>
  <path d="M20 771.836h64v7l-10 10H20v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M20 771.836h2018v4056.258H20z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="35" y="784.903">
    alt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="434" x="99" y="784.046">
    [settlementWindow found &amp;&amp; settlementWindowStateId == &apos;OPEN&apos;]
  </text>
  <path d="M282.5 795.969h249v7l-10 10h-239v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M282.5 795.969H1957v755.719H282.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="204" x="297.5" y="809.036">
    Process settlement window
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1179.5 845.367l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M378 849.367h807.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385" y="836.735">
    7
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="398" y="829.168">
    Terminate current window and open a new one
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="398" y="844.301">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="484" y="844.301">
    2001
  </text>
  <path d="M1128 864.367h490v7l-10 10h-480v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M1128 864.367h819v651.188h-819z"/>
  <text fill="#00F" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="445" x="1143" y="877.434">
    DB TRANSACTION: Terminate window usage and initate next
  </text>
  <path d="M1206 886.5v25h260v-15l-10-10h-250" fill="#D3D3D3" filter="url(#a)" stroke="#a80036"/>
  <path d="M1456 886.5v10h10l-10-10" fill="#D3D3D3" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="1212" y="903.567">
    let
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="1232" y="903.567">
    transactionTimestamp
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="1401" y="903.567">
    = now()
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 937.766l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 941.766H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1208.5" y="936.7">
    8
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="1221.5" y="936.7">
    Terminate requested window
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1407 954.766h485l10 26-10 27h-485l-10-27 10-26z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="1409" y="970.832">
    INSERT INTO
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="233" x="1492" y="970.832">
    settlementWindowStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="449" x="1425" y="985.965">
    (settlementWindowId, settlementWindowStateId, reason, createdDate)
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="481" x="1409" y="1001.098">
    VALUES ({id}, &apos;PROCESSING&apos;, {payload.reason}, {transactionTimestamp})
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1212.5 1030.297l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M1206.5 1034.297H1649"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1218.5" y="1029.231">
    9
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="1231.5" y="1029.231">
    Return
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="247" x="1277.5" y="1029.231">
    settlementWindowStateChangeId
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 1059.43l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 1063.43H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="1058.364">
    10
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="1230.5" y="1058.364">
    Update pointer to current state change id
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1440 1106.43h420l10 26-10 27h-420l-10-27 10-26z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="1442" y="1122.497">
    UPDATE
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="1498" y="1122.497">
    settlementWindow
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="416" x="1442" y="1137.629">
    SET currentStateChangeId = {settlementWindowStateChangeId}
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1442" y="1152.762">
    WHERE settlementWindowId = {id}
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 1181.96l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 1185.961H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="1180.895">
    11
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="1230.5" y="1180.895">
    Create new settlementWindow
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1464 1198.96h371l10 19-10 19h-371l-10-19 10-19z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="1466" y="1215.028">
    INSERT INTO
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="1549" y="1215.028">
    settlementWindow
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1691" y="1215.028">
    (reason, createdDate)
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="348" x="1466" y="1230.161">
    VALUES ({payload.reason}, {transactionTimestamp})
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1212.5 1259.36l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M1206.5 1263.359H1649"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1218.5" y="1258.293">
    12
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="1240.5" y="1258.293">
    Return
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="1286.5" y="1258.293">
    settlementWindowId
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 1288.492l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 1292.492H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="1287.426">
    13
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="1230.5" y="1287.426">
    Insert intial state for the created window
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1373 1305.492h554l10 26-10 27h-554l-10-27 10-26z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="1375" y="1321.559">
    INSERT INTO
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="233" x="1458" y="1321.559">
    settlementWindowStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="449" x="1391" y="1336.692">
    (settlementWindowId, settlementWindowStateId, reason, createdDate)
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="550" x="1375" y="1351.825">
    VALUES ({settlementWindowId}, &apos;OPEN&apos;, {payload.reason}, {transactionTimestamp})
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1212.5 1381.023l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M1206.5 1385.023H1649"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1218.5" y="1379.957">
    14
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="1240.5" y="1379.957">
    Return
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="278" x="1286.5" y="1379.957">
    newSettlementWindowStateChangeId
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 1410.156l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 1414.156H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="1409.09">
    15
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="1230.5" y="1409.09">
    Update pointer to current state change id
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1426 1457.156h447l10 26-10 27h-447l-10-27 10-26z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="1428" y="1473.223">
    UPDATE
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="1484" y="1473.223">
    settlementWindow
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="443" x="1428" y="1488.356">
    SET currentStateChangeId = {newSettlementWindowStateChangeId}
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="1428" y="1503.489">
    WHERE settlementWindowId = {settlementWindowId}
  </text>
  <path fill="#A80036" stroke="#a80036" d="M389 1539.688l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M383 1543.688h812.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="395" y="1538.622">
    16
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="417" y="1538.622">
    Return success
  </text>
  <path d="M383 1563.688v388h236v-378l-10-10H383" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M609 1563.688v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="389" y="1580.754">
    Message:
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="389" y="1595.887">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="405" y="1611.02">
    id: &lt;uuid&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="405" y="1626.153">
    from: switch,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="405" y="1641.286">
    to: switch,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="405" y="1656.418">
    type: application/json
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="405" y="1671.551">
    content: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="421" y="1686.684">
    payload: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="437" y="1701.817">
    settlementWindowId: {id}
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="421" y="1716.95">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="405" y="1732.082">
    },
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="405" y="1747.215">
    metadata: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="421" y="1762.348">
    event: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="437" y="1777.481">
    id: &lt;uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="437" y="1792.614">
    responseTo: null,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="437" y="1807.747">
    type: setwin,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="437" y="1822.879">
    action: close,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="437" y="1838.012">
    createdAt: &lt;timestamp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="437" y="1853.145">
    state: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="453" y="1868.278">
    status: &quot;success&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="453" y="1883.411">
    code: 0
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="437" y="1898.543">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="421" y="1913.676">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="405" y="1928.809">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="389" y="1943.942">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M609 2008.406l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M378 2012.406h237"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="385" y="1992.207">
    17
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="407" y="1977.075">
    Produce Settlement Window
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="407" y="1992.207">
    event message
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="407" y="2007.34">
    Error codes:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="501" y="2007.34">
    2003
  </text>
  <path d="M74 2055.406v115h285v-105l-10-10H74" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M349 2055.406v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="80" y="2072.473">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="96" y="2087.606">
    &quot;id&quot;: settlementWindowId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="96" y="2102.739">
    &quot;state&quot;: &apos;OPEN&apos;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="96" y="2117.872">
    &quot;reason&quot;: payload.reason,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="96" y="2133.004">
    &quot;createdDate&quot;: transactionTimestamp,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="96" y="2148.137">
    &quot;changedDate&quot;: transactionTimestamp
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="80" y="2163.27">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M114 2197.469l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M108 2201.469h264"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="120" y="2196.403">
    18
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="142" y="2196.403">
    Respond HTTP - 201 (Created)
  </text>
  <path d="M539 2216.469h377v7l-10 10H539v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M539 2216.469h1489v2416.563H539z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="332" x="554" y="2229.536">
    Close settlement window (Deferred Handler)
  </text>
  <path fill="#A80036" stroke="#a80036" d="M642 2265.867l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M636 2269.867h223"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="648" y="2257.235">
    19
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="670" y="2249.669">
    Consume Settlement Window
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="670" y="2264.801">
    event message
  </text>
  <path d="M785 2314.867h232v7l-10 10H785v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M785 2314.867h353v156.664H785z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="800" y="2327.934">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1066 2374.133l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M870 2378.133h202"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="877" y="2373.067">
    20
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="899" y="2373.067">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M792 2386.133h335v55.398H792z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M792 2386.133h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="805" y="2400.2">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="884" y="2419.2">
    Event Handler Consume
  </text>
  <path d="M875 2483.531v55h372v-45l-10-10H875" fill="#D3D3D3" filter="url(#a)" stroke="#a80036"/>
  <path d="M1237 2483.531v10h10l-10-10" fill="#D3D3D3" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="881" y="2500.598">
    let
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="901" y="2500.598">
    id
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="919" y="2500.598">
    = message.content.payload.settlementWindowId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="881" y="2515.731">
    let
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="160" x="901" y="2515.731">
    windowContentReady
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="1065" y="2515.731">
    = false
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="881" y="2530.864">
    let
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="901" y="2530.864">
    iter
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="930" y="2530.864">
    = 0
  </text>
  <path d="M775 2554.93h77v7l-10 10h-67v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M775 2554.93h1243v2071.102H775z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="790" y="2567.997">
    loop
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="487" x="867" y="2567.14">
    [iter &lt; Config.WIN_AGGREGATION_RETRY_COUNT &amp;&amp; !windowContentReady]
  </text>
  <path d="M875 2577.063v25h64v-15l-10-10h-54" fill="#D3D3D3" filter="url(#a)" stroke="#a80036"/>
  <path d="M929 2577.063v10h10l-10-10" fill="#D3D3D3" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="881" y="2594.129">
    iter++
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1179.5 2673.727l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M870 2677.727h315.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="877" y="2649.961">
    21
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="899" y="2627.262">
    Check if all transferParticipant records
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="899" y="2642.395">
    for the requested window have been set
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="899" y="2657.528">
    (currentStateChangeId is NOT NULL).
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="899" y="2672.661">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="985" y="2672.661">
    2001
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 2702.86l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 2706.859H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="2701.794">
    22
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="1230.5" y="2701.794">
    Use EXISTS query to find NULL currentStateChangeId records
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1589 2749.86h122l10 19-10 19h-122l-10-19 10-19z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="1591" y="2765.926">
    transferFulfilment
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1591" y="2781.059">
    transferParticipant
  </text>
  <path fill="#A80036" stroke="#a80036" d="M881 2810.258l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M875 2814.258h320.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="887" y="2809.192">
    23
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="909" y="2809.192">
    Return result (success / failure)
  </text>
  <path d="M785 2829.258h70v7l-10 10h-60v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M785 2829.258h1223v1305.305H785z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="800" y="2842.325">
    opt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="601" x="870" y="2841.468">
    [transferParticipant records have been processed by central-ledger SettlementModelHandler]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1179.5 2878.656l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M870 2882.656h315.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="877" y="2870.024">
    24
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="899" y="2862.457">
    Generate window content and aggregations
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="899" y="2877.59">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="985" y="2877.59">
    2001
  </text>
  <path d="M1128 2897.656h510v7l-10 10h-500v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M1128 2897.656h870v1200.773h-870z"/>
  <text fill="#00F" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="465" x="1143" y="2910.723">
    DB TRANSACTION: Generate window content and aggregations
  </text>
  <path d="M1206 2919.79v25h260v-15l-10-10h-250" fill="#D3D3D3" filter="url(#a)" stroke="#a80036"/>
  <path d="M1456 2919.79v10h10l-10-10" fill="#D3D3D3" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="1212" y="2936.856">
    let
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="1232" y="2936.856">
    transactionTimestamp
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="1401" y="2936.856">
    = now()
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 2971.055l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 2975.055H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="2969.989">
    25
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="1230.5" y="2969.989">
    Change all applicable entries to CLOSED state
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1547 3018.055h206l10 26-10 27h-206l-10-27 10-26z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="1549" y="3034.122">
    transferParticipantStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1549" y="3049.254">
    transferParticipant
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 3093.586l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 3097.586H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3092.52">
    26
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="1230.5" y="3092.52">
    Determine window content and insert
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 3122.719l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 3126.719H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3121.653">
    27
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="1230.5" y="3121.653">
    Get all Settlement Models
  </text>
  <path stroke="#a80036" d="M1201.5 3155.852h42M1243.5 3155.852v13M1202.5 3168.852h41"/>
  <path fill="#A80036" stroke="#a80036" d="M1212.5 3164.852l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3150.786">
    28
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="300" x="1230.5" y="3150.786">
    create Settlement Models &lt;-&gt; currencyId map
  </text>
  <path stroke="#a80036" d="M1201.5 3197.984h42M1243.5 3197.984v13M1202.5 3210.984h41"/>
  <path fill="#A80036" stroke="#a80036" d="M1212.5 3206.984l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3192.919">
    29
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="1230.5" y="3192.919">
    create list of currencies with Settlement Models
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 3236.117l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 3240.117H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3235.051">
    30
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="1230.5" y="3235.051">
    Get Settlement Window Content list
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1429 3253.117h441l10 87-10 87h-441l-10-87 10-87z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="437" x="1431" y="3269.184">
    SELECT DISTINCT {id} settlementWindowId, pc.ledgerAccountTypeId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="1447" y="3284.317">
    pc.currencyId, m.settlementModelId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1431" y="3299.45">
    FROM
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="1471" y="3299.45">
    transferFulfilment
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="9" x="1608" y="3299.45">
    tf
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1431" y="3314.582">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="1461" y="3314.582">
    transferParticipant
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="13" x="1605" y="3314.582">
    tp
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="1431" y="3329.715">
    ON tp.transferId = tf.transferId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1431" y="3344.848">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="1461" y="3344.848">
    participantCurrency
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="1611" y="3344.848">
    pc
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="351" x="1431" y="3359.981">
    ON pc.participantCurrencyId = tp.participantCurrencyId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1431" y="3375.114">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="125" x="1461" y="3375.114">
    settlementModel
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="13" x="1590" y="3375.114">
    m
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="345" x="1431" y="3390.247">
    ON m.ledgerAccountTypeId = pc.ledgerAccountTypeId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="1431" y="3405.379">
    WHERE tf.settlementWindowId = {id}
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="1431" y="3420.512">
    AND m.settlementGranularityId = &apos;NET&apos;
  </text>
  <path stroke="#a80036" d="M1201.5 3453.711h42M1243.5 3453.711v13M1202.5 3466.711h41"/>
  <path fill="#A80036" stroke="#a80036" d="M1212.5 3462.71l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3448.645">
    31
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="385" x="1230.5" y="3448.645">
    filter swcList to add currency to each record based on model
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1638 3491.844l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 3495.844H1644"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3490.778">
    32
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="1230.5" y="3490.778">
    Insert filtered list
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 3520.977l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 3524.977H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3519.911">
    33
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="1230.5" y="3519.911">
    Aggregate window data and insert
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1321 3567.977h657l10 140-10 140h-657l-10-140 10-140z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="1323" y="3584.044">
    INSERT INTO
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="230" x="1406" y="3584.044">
    settlementContentAggregation
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="332" x="1640" y="3584.044">
    (settlementWindowContentId, participantCurrencyId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="559" x="1339" y="3599.176">
    transferParticipantRoleTypeId, ledgerEntryTypeId, currentStateId, createdDate, amount)
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="636" x="1323" y="3614.309">
    SELECT swc.settlementWindowContentId, pc.participantCurrencyId, tp.transferParticipantRoleTypeId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="465" x="1339" y="3629.442">
    tp.ledgerEntryTypeId, &apos;CLOSED&apos;, transactionTimestamp, SUM(tp.amount)
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1323" y="3644.575">
    FROM
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="1363" y="3644.575">
    transferFulfilment
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="9" x="1500" y="3644.575">
    tf
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1323" y="3659.707">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="1353" y="3659.707">
    transferParticipant
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="13" x="1497" y="3659.707">
    tp
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="1323" y="3674.84">
    ON tf.transferId = tp.transferId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1323" y="3689.973">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="1353" y="3689.973">
    participantCurrency
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="1503" y="3689.973">
    pc
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="351" x="1323" y="3705.106">
    ON pc.participantCurrencyId = tp.participantCurrencyId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1323" y="3720.239">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="1353" y="3720.239">
    settlementWindowContent
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="1553" y="3720.239">
    swc
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="339" x="1323" y="3735.372">
    ON swc.settlementWindowId = tf.settlementWindowId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="364" x="1323" y="3750.504">
    AND swc.ledgerAccountTypeId = pc.ledgerAccountTypeId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1323" y="3765.637">
    AND swc.currencyId = pc.currencyId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1323" y="3780.77">
    JOIN
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="125" x="1353" y="3780.77">
    settlementModel
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="13" x="1482" y="3780.77">
    m
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="1323" y="3795.903">
    ON m.settlementModelId = swc.settlementModelId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="1323" y="3811.036">
    WHERE ttf.settlementWindowId = {id}
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="443" x="1323" y="3826.169">
    GROUP BY swc.settlementWindowContentId, pc.participantCurrencyId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="342" x="1339" y="3841.301">
    tp.transferParticipantRoleTypeId, tp.ledgerEntryTypeId
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 3870.5l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 3874.5H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="3869.434">
    34
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="263" x="1230.5" y="3869.434">
    Insert initial window content state change
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1460 3917.5h380l10 41-10 42h-380l-10-42 10-41z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="1462" y="3933.567">
    INSERT INTO
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="291" x="1545" y="3933.567">
    settlementWindowContentStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="360" x="1478" y="3948.7">
    (settlementWindowContentId, settlementWindowStateId)
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="1462" y="3963.832">
    SELECT swc.settlementWindowContentId, &apos;CLOSED&apos;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1462" y="3978.965">
    FROM
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="1502" y="3978.965">
    settlementWindowContent
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="1702" y="3978.965">
    swc
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="1462" y="3994.098">
    WHERE swc.settlementWindowId = {id}
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 4023.297l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 4027.297H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="4022.231">
    35
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="1230.5" y="4022.231">
    Update pointers to current state change ids
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1564 4070.297h172l10 11-10 12h-172l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="1566" y="4086.364">
    settlementWindowContent
  </text>
  <path fill="#A80036" stroke="#a80036" d="M881 4122.563l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M875 4126.563h320.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="887" y="4121.497">
    36
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="909" y="4121.497">
    Return result (success / failure)
  </text>
  <path d="M785 4148.563h64v7l-10 10h-54v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M785 4148.563h1018v470.469H785z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="800" y="4161.629">
    alt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="864" y="4160.773">
    [success]
  </text>
  <path d="M875 4170.695v25h201v-15l-10-10H875" fill="#D3D3D3" filter="url(#a)" stroke="#a80036"/>
  <path d="M1066 4170.695v10h10l-10-10" fill="#D3D3D3" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="881" y="4187.762">
    windowContentReady = true
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1179.5 4237.094l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M870 4241.094h315.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="877" y="4228.461">
    37
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="899" y="4220.895">
    Close requested window
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="899" y="4236.028">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="985" y="4236.028">
    2001
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 4266.227l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 4270.227H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="4265.161">
    38
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="1230.5" y="4265.161">
    Change window state to &apos;CLOSED&apos;
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1517 4313.227h266l10 19-10 19h-266l-10-19 10-19z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="1519" y="4329.293">
    settlementWindowStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="1519" y="4344.426">
    settlementWindow.currentStateChangeId
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M785 4357.492h1018"/>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="384" x="790" y="4367.703">
    [failure &amp;&amp; iter &lt; Config.WIN_AGGREGATION_RETRY_COUNT]
  </text>
  <path d="M875 4376.297v25h404v-15l-10-10H875" fill="#D3D3D3" filter="url(#a)" stroke="#a80036"/>
  <path d="M1269 4376.297v10h10l-10-10" fill="#D3D3D3" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="881" y="4393.364">
    sleep
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="339" x="925" y="4393.364">
    Config.WIN_AGGREGATION_RETRY_INTERVAL seconds
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M785 4411.43h1018"/>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="52" x="790" y="4421.64">
    [failure]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1179.5 4457.5l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M870 4461.5h315.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="877" y="4448.868">
    39
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="899" y="4441.301">
    Fail requested window
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="899" y="4456.434">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="985" y="4456.434">
    2001
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1633 4486.633l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1201.5 4490.633H1639"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1208.5" y="4485.567">
    40
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="1230.5" y="4485.567">
    Change window state to &apos;FAILED&apos;
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1517 4533.633h266l10 19-10 19h-266l-10-19 10-19z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="1519" y="4549.7">
    settlementWindowStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="1519" y="4564.833">
    settlementWindow.currentStateChangeId
  </text>
  <path stroke="#a80036" d="M870 4598.031h42M912 4598.031v13M871 4611.031h41M871 4611.031l10-4M871 4611.031l10 4"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="877" y="4592.965">
    41
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="899" y="4592.965">
    Log ERROR event
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M20 4641.031h2018"/>
  <path stroke="#a80036" d="M373 4658.164h47M420 4658.164v13M379 4671.164h41M379 4671.164l10-4M379 4671.164l10 4"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="385" y="4653.098">
    42
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="407" y="4653.098">
    Log ERROR event
  </text>
  <path d="M30 4689.164v100h329v-90l-10-10H30" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M349 4689.164v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="36" y="4706.231">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="52" y="4721.364">
    &quot;errorInformation&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="68" y="4736.497">
    &quot;errorCode&quot;: &lt;integer&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="68" y="4751.629">
    &quot;errorDescription&quot;: &quot;Client error description&quot;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52" y="4766.762">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="36" y="4781.895">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M119 4816.094l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M113 4820.094h259"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="125" y="4815.028">
    43
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="147" y="4815.028">
    Respond HTTP - 4xx (Client error)
  </text>
</svg>
