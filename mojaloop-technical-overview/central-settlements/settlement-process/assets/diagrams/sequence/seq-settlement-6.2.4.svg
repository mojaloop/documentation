<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1836px" preserveAspectRatio="none" style="width:1092px;height:1836px;" version="1.1" viewBox="0 0 1092 1836" width="1092px" zoomAndPan="magnify"><defs><filter height="300%" id="fvv4v9api6mur" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="336" x="379" y="23.5352">6.2.4. Get Settlement By Id (getSettlementById)</text><rect fill="#FFB6C1" height="1790.8887" style="stroke: #A80036; stroke-width: 1.0;" width="112" x="70" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="85.5" y="47.0566">Central HUB</text><rect fill="#90EE90" height="1790.8887" style="stroke: #A80036; stroke-width: 1.0;" width="367.5" x="313.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="435.25" y="47.0566">Settlement Service</text><rect fill="#FFFFE0" height="1790.8887" style="stroke: #A80036; stroke-width: 1.0;" width="114" x="731" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="734" y="47.0566">Central Services</text><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="1559.6016" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="121" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="1513.9805" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="391" y="192.9082"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="183.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="615" y="237.5293"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="229.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="615" y="489.6348"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="229.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="615" y="763.3613"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="783" y="266.8398"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="783" y="518.9453"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="783" y="792.6719"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="1567.6016" style="stroke: #000000; stroke-width: 2.0;" width="1068" x="13" y="154.2871"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="1279.1855" style="stroke: #000000; stroke-width: 2.0;" width="1048" x="23" y="435.7031"/><rect fill="#FFFFFF" height="186.4844" style="stroke: none; stroke-width: 1.0;" width="1048" x="23" y="1528.4043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="137.2871" y2="1738.8887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="395.5" x2="395.5" y1="137.2871" y2="1738.8887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="620" x2="620" y1="137.2871" y2="1738.8887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="788" x2="788" y1="137.2871" y2="1738.8887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="74" y="134.334">Hub Employee</text><ellipse cx="126" cy="63.7988" fill="#FEFECE" filter="url(#fvv4v9api6mur)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126,71.7988 L126,98.7988 M113,79.7988 L139,79.7988 M126,98.7988 L113,113.7988 M126,98.7988 L139,113.7988 " fill="none" filter="url(#fvv4v9api6mur)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="74" y="1751.4238">Hub Employee</text><ellipse cx="126" cy="1764.377" fill="#FEFECE" filter="url(#fvv4v9api6mur)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126,1772.377 L126,1799.377 M113,1780.377 L139,1780.377 M126,1799.377 L113,1814.377 M126,1799.377 L139,1814.377 " fill="none" filter="url(#fvv4v9api6mur)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="317.5" y="134.334">Settlement Service API</text><path d="M375.5,92.7988 L375.5,116.7988 M375.5,104.7988 L392.5,104.7988 " fill="none" filter="url(#fvv4v9api6mur)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="404.5" cy="104.7988" fill="#FEFECE" filter="url(#fvv4v9api6mur)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="317.5" y="1751.4238">Settlement Service API</text><path d="M375.5,1758.377 L375.5,1782.377 M375.5,1770.377 L392.5,1770.377 " fill="none" filter="url(#fvv4v9api6mur)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="404.5" cy="1770.377" fill="#FEFECE" filter="url(#fvv4v9api6mur)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="563" y="134.334">Settlement DAO</text><ellipse cx="620" cy="104.7988" fill="#FEFECE" filter="url(#fvv4v9api6mur)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="608" x2="632" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="563" y="1751.4238">Settlement DAO</text><ellipse cx="620" cy="1770.377" fill="#FEFECE" filter="url(#fvv4v9api6mur)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="608" x2="632" y1="1784.377" y2="1784.377"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="740" y="134.334">Central Store</text><path d="M770,84.7988 C770,74.7988 788,74.7988 788,74.7988 C788,74.7988 806,74.7988 806,84.7988 L806,110.7988 C806,120.7988 788,120.7988 788,120.7988 C788,120.7988 770,120.7988 770,110.7988 L770,84.7988 " fill="#FEFECE" filter="url(#fvv4v9api6mur)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M770,84.7988 C770,94.7988 788,94.7988 788,94.7988 C788,94.7988 806,94.7988 806,84.7988 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="740" y="1751.4238">Central Store</text><path d="M770,1764.377 C770,1754.377 788,1754.377 788,1754.377 C788,1754.377 806,1754.377 806,1764.377 L806,1790.377 C806,1800.377 788,1800.377 788,1800.377 C788,1800.377 770,1800.377 770,1790.377 L770,1764.377 " fill="#FEFECE" filter="url(#fvv4v9api6mur)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M770,1764.377 C770,1774.377 788,1774.377 788,1774.377 C788,1774.377 806,1774.377 806,1764.377 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="1559.6016" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="121" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="1513.9805" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="391" y="192.9082"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="183.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="615" y="237.5293"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="229.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="615" y="489.6348"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="229.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="615" y="763.3613"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="783" y="266.8398"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="783" y="518.9453"/><rect fill="#FFFFFF" filter="url(#fvv4v9api6mur)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="783" y="792.6719"/><path d="M13,154.2871 L194,154.2871 L194,161.2871 L184,171.2871 L13,171.2871 L13,154.2871 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1567.6016" style="stroke: #000000; stroke-width: 2.0;" width="1068" x="13" y="154.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="28" y="167.8555">Get Settlement By Id</text><polygon fill="#A80036" points="379,188.9082,389,192.9082,379,196.9082,383,192.9082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131" x2="385" y1="192.9082" y2="192.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="138" y="188.166">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="151" y="188.166">GET - /settlements/{id}</text><polygon fill="#A80036" points="603,233.5293,613,237.5293,603,241.5293,607,237.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="401" x2="609" y1="237.5293" y2="237.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="408" y="225.1318">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="421" y="217.4766">Request settlement state</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="421" y="232.7871">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="498" y="232.7871">2001</text><polygon fill="#A80036" points="771,262.8398,781,266.8398,771,270.8398,775,266.8398" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="625" x2="777" y1="266.8398" y2="266.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="632" y="262.0977">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="645" y="262.0977">Retrieve settlement</text><polygon fill="#FFFFE0" filter="url(#fvv4v9api6mur)" points="567,309.8398,1008,309.8398,1018,351.8398,1008,393.8398,567,393.8398,557,351.8398,567,309.8398" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="437" x="569" y="326.4082">SELECT s.settlementId, ssc.settlementStateId, s.reason, s.createdDate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="569" y="341.7188">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="609" y="341.7188">settlement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="685" y="341.7188">s</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="569" y="357.0293">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="601" y="357.0293">settlementStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="762" y="357.0293">ssc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="569" y="372.3398">ON ssc.settlementStateChangeId = s.currentStateChangeId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="569" y="387.6504">WHERE s.settlementId = {id}</text><polygon fill="#A80036" points="412,416.7031,402,420.7031,412,424.7031,408,420.7031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="406" x2="619" y1="420.7031" y2="420.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="418" y="415.9609">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="431" y="415.9609">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="476" y="415.9609">settlement</text><path d="M23,435.7031 L85,435.7031 L85,442.7031 L75,452.7031 L23,452.7031 L23,435.7031 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1279.1855" style="stroke: #000000; stroke-width: 2.0;" width="1048" x="23" y="435.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="38" y="449.2715">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="100" y="448.3379">[settlement found]</text><polygon fill="#A80036" points="603,485.6348,613,489.6348,603,493.6348,607,489.6348" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="401" x2="609" y1="489.6348" y2="489.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="408" y="477.2373">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="421" y="469.582">Request settlement windows</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="421" y="484.8926">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="498" y="484.8926">2001</text><polygon fill="#A80036" points="771,514.9453,781,518.9453,771,522.9453,775,518.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="625" x2="777" y1="518.9453" y2="518.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="632" y="514.2031">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="645" y="514.2031">Retrieve windows</text><polygon fill="#FFFFE0" filter="url(#fvv4v9api6mur)" points="566,561.9453,1009,561.9453,1019,626.9453,1009,691.9453,566,691.9453,556,626.9453,566,561.9453" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="404" x="568" y="578.5137">SELECT sw.settlementWindowId, swsc.settlementWindowStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="385" x="596" y="593.8242">swsc.reason, sw.createdDate, swsc.createdDate changedDate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="568" y="609.1348">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="197" x="608" y="609.1348">settlementSettlementWindow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="809" y="609.1348">ssw</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="568" y="624.4453">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="125" x="600" y="624.4453">settlementWindow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="17" x="729" y="624.4453">sw</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="347" x="568" y="639.7559">ON sw.settlementWindowId = ssw.settlementWindowId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="568" y="655.0664">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="210" x="600" y="655.0664">settlementWindowStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="814" y="655.0664">swsc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="439" x="568" y="670.377">ON swsc.settlementWindowStateChangeId = sw.currentStateChangeId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="568" y="685.6875">WHERE ssw.settlementId = {id}</text><polygon fill="#A80036" points="412,714.7402,402,718.7402,412,722.7402,408,718.7402" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="406" x2="619" y1="718.7402" y2="718.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="418" y="713.998">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="431" y="713.998">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="59" x="476" y="713.998">windows</text><polygon fill="#A80036" points="603,759.3613,613,763.3613,603,767.3613,607,763.3613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="401" x2="609" y1="763.3613" y2="763.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="408" y="750.9639">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="421" y="743.3086">Request settlement accounts</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="421" y="758.6191">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="498" y="758.6191">2001</text><polygon fill="#A80036" points="771,788.6719,781,792.6719,771,796.6719,775,792.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="625" x2="777" y1="792.6719" y2="792.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="632" y="787.9297">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="645" y="787.9297">Retrieve accounts</text><polygon fill="#FFFFE0" filter="url(#fvv4v9api6mur)" points="524,835.6719,1051,835.6719,1061,900.6719,1051,965.6719,524,965.6719,514,900.6719,524,835.6719" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="480" x="526" y="852.2402">SELECT pc.participantId, spc.participantCurrencyId, spcsc.settlementStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="554" y="867.5508">spcsc.reason, spc.netAmount, pc.currencyId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="526" y="882.8613">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="566" y="882.8613">settlementParticipantCurrency</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="777" y="882.8613">spc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="526" y="898.1719">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="292" x="558" y="898.1719">settlementParticipantCurrencyStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="854" y="898.1719">spcsc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="523" x="526" y="913.4824">ON spcsc.settlementParticipantCurrencyStateChangeId = spc.currentStateChangeId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="526" y="928.793">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="558" y="928.793">participantCurrency</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="698" y="928.793">pc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="359" x="526" y="944.1035">ON pc.participantCurrencyId = spc.participantCurrencyId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="526" y="959.4141">WHERE spc.settlementId = {id}</text><polygon fill="#A80036" points="412,988.4668,402,992.4668,412,996.4668,408,992.4668" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="406" x2="619" y1="992.4668" y2="992.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="418" y="987.7246">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="440" y="987.7246">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="485" y="987.7246">accounts</text><path d="M33,1005.4668 L33,1489.4668 L382,1489.4668 L382,1015.4668 L372,1005.4668 L33,1005.4668 " fill="#FFFF00" filter="url(#fvv4v9api6mur)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M372,1005.4668 L372,1015.4668 L382,1015.4668 L372,1005.4668 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="39" y="1023.0352">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="55" y="1038.3457">"id": settlement.settlementId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="55" y="1053.6563">"state": settlement.settlementStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="55" y="1068.9668">"settlementWindows": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="71" y="1084.2773">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="87" y="1099.5879">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="103" y="1114.8984">"id": window.settlementWindowId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="103" y="1130.209">"reason": window.reason,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="103" y="1145.5195">"state": window.settlementWindowStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="103" y="1160.8301">"createdDate": window.createdDate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="103" y="1176.1406">"changedDate": window.changedDate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="87" y="1191.4512">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="71" y="1206.7617">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="55" y="1222.0723">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="55" y="1237.3828">"participants": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="71" y="1252.6934">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="87" y="1268.0039">"id": account.participantId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="87" y="1283.3145">"accounts": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="103" y="1298.625">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="119" y="1313.9355">"id": account.participantCurrencyId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="119" y="1329.2461">"reason": account.reason,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="119" y="1344.5566">"state": account.settlementStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="119" y="1359.8672">"netSettlementAmount": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="135" y="1375.1777">"amount": account.netAmount,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="135" y="1390.4883">"currency": account.currencyId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="119" y="1405.7988">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="103" y="1421.1094">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="87" y="1436.4199">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="71" y="1451.7305">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="55" y="1467.041">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="39" y="1482.3516">}</text><polygon fill="#A80036" points="142,1516.4043,132,1520.4043,142,1524.4043,138,1520.4043" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="136" x2="390" y1="1520.4043" y2="1520.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="148" y="1515.6621">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="170" y="1515.6621">Respond HTTP - 200 (OK)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1071" y1="1529.4043" y2="1529.4043"/><path d="M406,1535.4043 L406,1560.4043 L533,1560.4043 L533,1545.4043 L523,1535.4043 L406,1535.4043 " fill="#D3D3D3" filter="url(#fvv4v9api6mur)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M523,1535.4043 L523,1545.4043 L533,1545.4043 L523,1535.4043 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="412" y="1552.9727">Log ERROR event</text><path d="M52,1574.7148 L52,1675.7148 L382,1675.7148 L382,1584.7148 L372,1574.7148 L52,1574.7148 " fill="#FFFF00" filter="url(#fvv4v9api6mur)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M372,1574.7148 L372,1584.7148 L382,1584.7148 L372,1574.7148 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="58" y="1592.2832">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="74" y="1607.5938">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="90" y="1622.9043">"errorCode": &lt;integer&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="90" y="1638.2148">"errorDescription": "Client error description"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="74" y="1653.5254">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="58" y="1668.8359">}</text><polygon fill="#A80036" points="137,1702.8887,127,1706.8887,137,1710.8887,133,1706.8887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="131" x2="395" y1="1706.8887" y2="1706.8887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143" y="1702.1465">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="165" y="1702.1465">Respond HTTP - 4xx (Client error)</text><!--
@startuml
title 6.2.4. Get Settlement By Id (getSettlementById)
autonumber

actor "Hub Employee" as OPERATOR
boundary "Settlement Service API" as SSAPI
entity "Settlement DAO" as SETTLE_DAO
database "Central Store" as DB

box "Central HUB" #lightpink
    participant OPERATOR
end box

box "Settlement Service" #lightgreen
    participant SSAPI
    participant SETTLE_DAO
end box

box "Central Services" #lightyellow
    participant DB
end box

group Get Settlement By Id
activate OPERATOR
    OPERATOR -> SSAPI: GET - /settlements/{id}
    activate SSAPI

    SSAPI-> SETTLE_DAO: Request settlement state\n<color #FF0000><b>Error code:</b> 2001</color>
    activate SETTLE_DAO
    SETTLE_DAO -> DB: Retrieve settlement
    activate DB
    hnote over DB #lightyellow
        SELECT s.settlementId, ssc.settlementStateId, s.reason, s.createdDate
        FROM **settlement** s
        JOIN **settlementStateChange** ssc
        ON ssc.settlementStateChangeId = s.currentStateChangeId
        WHERE s.settlementId = {id}
    end hnote
    deactivate DB
    SSAPI <- - SETTLE_DAO: Return **settlement**
    deactivate SETTLE_DAO

    alt settlement found
        SSAPI-> SETTLE_DAO: Request settlement windows\n<color #FF0000><b>Error code:</b> 2001</color>
        activate SETTLE_DAO
        SETTLE_DAO -> DB: Retrieve windows
        activate DB
        hnote over DB #lightyellow
            SELECT sw.settlementWindowId, swsc.settlementWindowStateId,
                   swsc.reason, sw.createdDate, swsc.createdDate changedDate
            FROM **settlementSettlementWindow** ssw
            JOIN **settlementWindow** sw
            ON sw.settlementWindowId = ssw.settlementWindowId
            JOIN **settlementWindowStateChange** swsc
            ON swsc.settlementWindowStateChangeId = sw.currentStateChangeId
            WHERE ssw.settlementId = {id}
        end hnote
        deactivate DB
        SSAPI <- - SETTLE_DAO: Return **windows**
        deactivate SETTLE_DAO

        SSAPI-> SETTLE_DAO: Request settlement accounts\n<color #FF0000><b>Error code:</b> 2001</color>
        activate SETTLE_DAO
        SETTLE_DAO -> DB: Retrieve accounts
        activate DB
        hnote over DB #lightyellow
            SELECT pc.participantId, spc.participantCurrencyId, spcsc.settlementStateId, 
                   spcsc.reason, spc.netAmount, pc.currencyId
            FROM **settlementParticipantCurrency** spc
            JOIN **settlementParticipantCurrencyStateChange** spcsc
            ON spcsc.settlementParticipantCurrencyStateChangeId = spc.currentStateChangeId
            JOIN **participantCurrency** pc
            ON pc.participantCurrencyId = spc.participantCurrencyId
            WHERE spc.settlementId = {id}
        end hnote
        deactivate DB
        SSAPI <- - SETTLE_DAO: Return **accounts**
        deactivate SETTLE_DAO

        note left of SSAPI #yellow
            {
                "id": settlement.settlementId,
                "state": settlement.settlementStateId,
                "settlementWindows": [
                    [
                        {
                            "id": window.settlementWindowId,
                            "reason": window.reason,
                            "state": window.settlementWindowStateId,
                            "createdDate": window.createdDate,
                            "changedDate": window.changedDate
                        }
                    ]
                ],
                "participants": [
                    {
                        "id": account.participantId,
                        "accounts": [
                            {
                                "id": account.participantCurrencyId,
                                "reason": account.reason,
                                "state": account.settlementStateId,
                                "netSettlementAmount": {
                                    "amount": account.netAmount,
                                    "currency": account.currencyId
                                }
                            }
                        ]
                    }
                ]
            }
        end note
        OPERATOR <- - SSAPI: Respond HTTP - 200 (OK)
    else
        note right of SSAPI #lightgray
            Log ERROR event
        end note
        note left of SSAPI #yellow
            {
                errorInformation: {
                    "errorCode": <integer>,
                    "errorDescription": "Client error description"
                }
            }
        end note
        OPERATOR <- - SSAPI: Respond HTTP - 4xx (Client error)
        deactivate SSAPI
        deactivate OPERATOR
    end
end
@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>