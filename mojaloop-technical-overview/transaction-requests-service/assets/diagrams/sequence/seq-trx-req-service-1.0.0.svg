<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1520px" preserveAspectRatio="none" style="width:942px;height:1520px;" version="1.1" viewBox="0 0 942 1520" width="942px" zoomAndPan="magnify"><defs><filter height="300%" id="fifd7phruxysq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="276" x="333.5" y="23.5352">Transaction Requests Service - Create</text><rect fill="#FFFFFF" filter="url(#fifd7phruxysq)" height="1146.4238" style="stroke: #000000; stroke-width: 2.0;" width="917" x="13" y="300.3281"/><rect fill="#FFFFFF" filter="url(#fifd7phruxysq)" height="777.3633" style="stroke: #000000; stroke-width: 2.0;" width="897" x="23" y="549.502"/><rect fill="#FFFFFF" filter="url(#fifd7phruxysq)" height="394.9922" style="stroke: #000000; stroke-width: 2.0;" width="877" x="33" y="714.0547"/><rect fill="#FFFFFF" height="182.8184" style="stroke: none; stroke-width: 1.0;" width="877" x="33" y="926.2285"/><rect fill="#FFFFFF" height="210.8184" style="stroke: none; stroke-width: 1.0;" width="897" x="23" y="1116.0469"/><rect fill="#FFFFFF" height="112.8867" style="stroke: none; stroke-width: 1.0;" width="917" x="13" y="1333.8652"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="115" x2="115" y1="85.4648" y2="1463.752"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="390" x2="390" y1="85.4648" y2="1463.752"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="768" x2="768" y1="85.4648" y2="1463.752"/><rect fill="#FEFECE" filter="url(#fifd7phruxysq)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="74" y="49.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="81" y="70.5117">Payer FSP</text><rect fill="#FEFECE" filter="url(#fifd7phruxysq)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="74" y="1462.752"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="81" y="1483.2871">Payer FSP</text><rect fill="#FEFECE" filter="url(#fifd7phruxysq)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="213" x="282" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="366.5" y="54.0234">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="199" x="289" y="70.5117">transaction-requests-service</text><rect fill="#FEFECE" filter="url(#fifd7phruxysq)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="213" x="282" y="1462.752"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="366.5" y="1483.2871">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="199" x="289" y="1499.7754">transaction-requests-service</text><rect fill="#FEFECE" filter="url(#fifd7phruxysq)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="726" y="49.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="733" y="70.5117">Payee FSP</text><rect fill="#FEFECE" filter="url(#fifd7phruxysq)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="726" y="1462.752"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="733" y="1483.2871">Payee FSP</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="810.5" y1="132.0859" y2="132.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="810.5" x2="810.5" y1="132.0859" y2="145.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="769.5" x2="810.5" y1="145.0859" y2="145.0859"/><polygon fill="#A80036" points="779.5,141.0859,769.5,145.0859,779.5,145.0859" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="775.5" y="119.6885">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="788.5" y="112.0332">Lookup process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="788.5" y="127.3438">(not shown here)</text><path d="M317,158.0859 L317,183.0859 L841,183.0859 L841,168.0859 L831,158.0859 L317,158.0859 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M831,158.0859 L831,168.0859 L841,168.0859 L831,158.0859 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="369" x="388" y="175.6543">Payee FSP generates a transaction-request to the Payer FSP</text><polygon fill="#A80036" points="401.5,209.707,391.5,213.707,401.5,213.707" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="767.5" y1="213.707" y2="213.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="407.5" y="208.9648">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="420.5" y="208.9648">POST /transactionRequests</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="432.5" y1="243.0176" y2="243.0176"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="432.5" y1="243.0176" y2="256.0176"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="391.5" x2="432.5" y1="256.0176" y2="256.0176"/><polygon fill="#A80036" points="401.5,252.0176,391.5,256.0176,401.5,260.0176,397.5,256.0176" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="397.5" y="238.2754">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="410.5" y="238.2754">Validate POST /transactionRequests schema</text><polygon fill="#A80036" points="756.5,286.3281,766.5,286.3281,756.5,290.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="390.5" x2="767.5" y1="285.3281" y2="285.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="397.5" y="280.5859">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="410.5" y="280.5859">202 Accepted</text><path d="M13,300.3281 L75,300.3281 L75,307.3281 L65,317.3281 L13,317.3281 L13,300.3281 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1146.4238" style="stroke: #000000; stroke-width: 2.0;" width="917" x="13" y="300.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="28" y="313.8965">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="164" x="90" y="312.9629">[transaction-request is valid]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="432.5" y1="338.9492" y2="338.9492"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="432.5" y1="338.9492" y2="351.9492"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="391.5" x2="432.5" y1="351.9492" y2="351.9492"/><polygon fill="#A80036" points="401.5,347.9492,391.5,351.9492,401.5,355.9492,397.5,351.9492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="397.5" y="334.207">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="351" x="410.5" y="334.207">Validate POST /transactionRequests (internal validation)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="432.5" y1="381.2598" y2="381.2598"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="432.5" y1="381.2598" y2="394.2598"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="391.5" x2="432.5" y1="394.2598" y2="394.2598"/><polygon fill="#A80036" points="401.5,390.2598,391.5,394.2598,401.5,398.2598,397.5,394.2598" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="397.5" y="376.5176">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="410.5" y="376.5176">Retrieve corresponding end-points for Payer FSP</text><path d="M38,407.2598 L38,432.2598 L464,432.2598 L464,417.2598 L454,407.2598 L38,407.2598 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M454,407.2598 L454,417.2598 L464,417.2598 L454,407.2598 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="405" x="44" y="424.8281">Switch forwards POST /transactionRequests request to Payer FSP</text><polygon fill="#A80036" points="126.5,458.8809,116.5,462.8809,126.5,462.8809" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="115.5" x2="389.5" y1="462.8809" y2="462.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="132.5" y="458.1387">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="145.5" y="458.1387">POST /transactionRequests</text><polygon fill="#A80036" points="378.5,493.1914,388.5,493.1914,378.5,497.1914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="115.5" x2="389.5" y1="492.1914" y2="492.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="122.5" y="487.4492">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="135.5" y="487.4492">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="115.5" x2="157.5" y1="521.502" y2="521.502"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="157.5" x2="157.5" y1="521.502" y2="534.502"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116.5" x2="157.5" y1="534.502" y2="534.502"/><polygon fill="#A80036" points="126.5,530.502,116.5,534.502,126.5,538.502,122.5,534.502" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="122.5" y="516.7598">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="135.5" y="516.7598">Process transaction-request</text><path d="M23,549.502 L85,549.502 L85,556.502 L75,566.502 L23,566.502 L23,549.502 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="777.3633" style="stroke: #000000; stroke-width: 2.0;" width="897" x="23" y="549.502"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="38" y="563.0703">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="307" x="100" y="562.1367">[Payer FSP successfully processes transaction-request]</text><path d="M43,571.8125 L43,596.8125 L463,596.8125 L463,581.8125 L453,571.8125 L43,571.8125 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M453,571.8125 L453,581.8125 L463,581.8125 L453,571.8125 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="90.5" y="589.3809">Payer FSP responds to POST /transactionRequests</text><polygon fill="#A80036" points="378.5,623.4336,388.5,627.4336,378.5,627.4336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="115.5" x2="389.5" y1="627.4336" y2="627.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="122.5" y="622.6914">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="144.5" y="622.6914">PUT /transactionRequests/{ID}</text><polygon fill="#A80036" points="126.5,657.7441,116.5,657.7441,126.5,661.7441" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="115.5" x2="389.5" y1="656.7441" y2="656.7441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="132.5" y="652.002">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="154.5" y="652.002">200 Ok</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="432.5" y1="686.0547" y2="686.0547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="432.5" y1="686.0547" y2="699.0547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="391.5" x2="432.5" y1="699.0547" y2="699.0547"/><polygon fill="#A80036" points="401.5,695.0547,391.5,699.0547,401.5,703.0547,397.5,699.0547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="397.5" y="681.3125">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="419.5" y="681.3125">Validate PUT /transactionRequests/{ID}</text><path d="M33,714.0547 L95,714.0547 L95,721.0547 L85,731.0547 L33,731.0547 L33,714.0547 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="394.9922" style="stroke: #000000; stroke-width: 2.0;" width="877" x="33" y="714.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="48" y="727.623">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="110" y="726.6895">[response is ok]</text><path d="M317,736.3652 L317,761.3652 L841,761.3652 L841,746.3652 L831,736.3652 L317,736.3652 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M831,736.3652 L831,746.3652 L841,746.3652 L831,736.3652 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="372" x="386.5" y="753.9336">Switch forwards transaction-request response to Payee FSP</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="432.5" y1="791.9863" y2="791.9863"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="432.5" y1="791.9863" y2="804.9863"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="391.5" x2="432.5" y1="804.9863" y2="804.9863"/><polygon fill="#A80036" points="401.5,800.9863,391.5,804.9863,401.5,808.9863,397.5,804.9863" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="397.5" y="787.2441">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="306" x="419.5" y="787.2441">Retrieve corresponding end-points for Payee FSP</text><polygon fill="#A80036" points="756.5,830.2969,766.5,834.2969,756.5,834.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="767.5" y1="834.2969" y2="834.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="397.5" y="829.5547">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="419.5" y="829.5547">PUT /transactionRequests/{ID}</text><polygon fill="#A80036" points="401.5,864.6074,391.5,864.6074,401.5,868.6074" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="390.5" x2="767.5" y1="863.6074" y2="863.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="407.5" y="858.8652">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="429.5" y="858.8652">200 Ok</text><path d="M637,876.6074 L637,916.6074 L896,916.6074 L896,886.6074 L886,876.6074 L637,876.6074 " fill="#3498DB" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M886,876.6074 L886,886.6074 L896,886.6074 L886,876.6074 " fill="#3498DB" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="643" y="894.1758">Wait for a quote, transfer by Payer FSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="643" y="909.4863">or a rejected transaction-request</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="910" y1="927.2285" y2="927.2285"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="38" y="937.8633">[response invalid]</text><path d="M43,946.1836 L43,971.1836 L463,971.1836 L463,956.1836 L453,946.1836 L43,946.1836 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M453,946.1836 L453,956.1836 L463,956.1836 L453,946.1836 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="145" y="963.752">Switch returns error to Payer FSP</text><polygon fill="#A80036" points="126.5,997.8047,116.5,1001.8047,126.5,1001.8047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="115.5" x2="389.5" y1="1001.8047" y2="1001.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="132.5" y="997.0625">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="154.5" y="997.0625">PUT /transactionRequests/{ID}/error</text><polygon fill="#A80036" points="378.5,1032.1152,388.5,1032.1152,378.5,1036.1152" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="115.5" x2="389.5" y1="1031.1152" y2="1031.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="122.5" y="1026.373">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="144.5" y="1026.373">200 Ok</text><path d="M43,1044.1152 L43,1099.1152 L463,1099.1152 L463,1054.1152 L453,1044.1152 L43,1044.1152 " fill="#EC7063" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M453,1044.1152 L453,1054.1152 L463,1054.1152 L453,1044.1152 " fill="#EC7063" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="161" y="1061.6836">Note that under this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="161" y="1076.9941">scenario the Payee FSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="161" y="1092.3047">may not receive a response</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="920" y1="1117.0469" y2="1117.0469"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="278" x="28" y="1127.6816">[Payer FSP calculation fails or rejects the request]</text><path d="M43,1136.002 L43,1161.002 L463,1161.002 L463,1146.002 L453,1136.002 L43,1136.002 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M453,1136.002 L453,1146.002 L463,1146.002 L453,1136.002 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="145" y="1153.5703">Payer FSP returns error to Switch</text><polygon fill="#A80036" points="378.5,1187.623,388.5,1191.623,378.5,1191.623" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="115.5" x2="389.5" y1="1191.623" y2="1191.623"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="122.5" y="1186.8809">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="144.5" y="1186.8809">PUT /transactionRequests/{ID}/error</text><polygon fill="#A80036" points="126.5,1221.9336,116.5,1221.9336,126.5,1225.9336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="115.5" x2="389.5" y1="1220.9336" y2="1220.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="132.5" y="1216.1914">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="154.5" y="1216.1914">200 OK</text><path d="M317,1233.9336 L317,1258.9336 L841,1258.9336 L841,1243.9336 L831,1233.9336 L317,1233.9336 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M831,1233.9336 L831,1243.9336 L841,1243.9336 L831,1233.9336 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="470" y="1251.502">Switch returns error to Payee FSP</text><polygon fill="#A80036" points="756.5,1285.5547,766.5,1289.5547,756.5,1289.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="767.5" y1="1289.5547" y2="1289.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="397.5" y="1284.8125">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="419.5" y="1284.8125">PUT /transactionRequests/{ID}/error</text><polygon fill="#A80036" points="401.5,1319.8652,391.5,1319.8652,401.5,1323.8652" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="390.5" x2="767.5" y1="1318.8652" y2="1318.8652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="407.5" y="1314.123">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="429.5" y="1314.123">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="930" y1="1334.8652" y2="1334.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="18" y="1345.5">[transaction-request is invalid]</text><path d="M317,1353.8203 L317,1378.8203 L841,1378.8203 L841,1363.8203 L831,1353.8203 L317,1353.8203 " fill="#FBFB77" filter="url(#fifd7phruxysq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M831,1353.8203 L831,1363.8203 L841,1363.8203 L831,1353.8203 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="470" y="1371.3887">Switch returns error to Payee FSP</text><polygon fill="#A80036" points="756.5,1405.4414,766.5,1409.4414,756.5,1409.4414" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="390.5" x2="767.5" y1="1409.4414" y2="1409.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="397.5" y="1404.6992">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="419.5" y="1404.6992">PUT /transactionRequests/{ID}/error</text><polygon fill="#A80036" points="401.5,1439.752,391.5,1439.752,401.5,1443.752" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="390.5" x2="767.5" y1="1438.752" y2="1438.752"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="407.5" y="1434.0098">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="429.5" y="1434.0098">200 OK</text><!--
@startuml
Title Transaction Requests Service - Create
participant "Payer FSP"
participant "Switch\ntransaction-requests-service" as Switch
participant "Payee FSP"

autonumber
"Payee FSP" -\ "Payee FSP": Lookup process\n(not shown here)
note over "Payee FSP", Switch: Payee FSP generates a transaction-request to the Payer FSP
"Payee FSP" -\ Switch: POST /transactionRequests
Switch -> Switch: Validate POST /transactionRequests schema
Switch - -/ "Payee FSP": 202 Accepted

alt transaction-request is valid
    
    Switch -> Switch: Validate POST /transactionRequests (internal validation)
    Switch -> Switch: Retrieve corresponding end-points for Payer FSP
    note over Switch, "Payer FSP": Switch forwards POST /transactionRequests request to Payer FSP
    Switch -\ "Payer FSP": POST /transactionRequests
    "Payer FSP" - -/ Switch: 202 Accepted
    "Payer FSP" -> "Payer FSP": Process transaction-request
    
    alt Payer FSP successfully processes transaction-request
    
        note over "Payer FSP", Switch: Payer FSP responds to POST /transactionRequests
        "Payer FSP" -\ Switch: PUT /transactionRequests/{ID}
        Switch - -/ "Payer FSP": 200 Ok
        
        Switch -> Switch: Validate PUT /transactionRequests/{ID}
        
        alt response is ok
        
            note over Switch, "Payee FSP": Switch forwards transaction-request response to Payee FSP
            Switch -> Switch: Retrieve corresponding end-points for Payee FSP
            
            Switch -\ "Payee FSP": PUT /transactionRequests/{ID}
            "Payee FSP" - -/ Switch: 200 Ok
            
            note over "Payee FSP" #3498db: Wait for a quote, transfer by Payer FSP\nor a rejected transaction-request
        else response invalid
        
            note over Switch, "Payer FSP": Switch returns error to Payer FSP
        
            Switch -\ "Payer FSP": PUT /transactionRequests/{ID}/error
            "Payer FSP" - -/ Switch : 200 Ok
            
            note over Switch, "Payer FSP" #ec7063: Note that under this\nscenario the Payee FSP\nmay not receive a response
        
        end
    else Payer FSP calculation fails or rejects the request
    
        note over "Payer FSP", Switch: Payer FSP returns error to Switch
    
        "Payer FSP" -\ Switch: PUT /transactionRequests/{ID}/error
        Switch - -/ "Payer FSP": 200 OK
        
        note over "Payee FSP", Switch: Switch returns error to Payee FSP
        
        Switch -\ "Payee FSP": PUT /transactionRequests/{ID}/error
        "Payee FSP" - -/ Switch: 200 OK
    
    end
else transaction-request is invalid
    note over "Payee FSP", Switch: Switch returns error to Payee FSP
    Switch -\ "Payee FSP": PUT /transactionRequests/{ID}/error
    "Payee FSP" - -/ Switch: 200 OK
end
@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>