<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2140px" preserveAspectRatio="none" style="width:1262px;height:2140px;" version="1.1" viewBox="0 0 1262 2140" width="1262px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mkwv9iprmpo4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="199" x="532" y="23.5352">Retrieve Quote Information</text><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="123.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="954.5" y="876.0273"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="1648.2344" style="stroke: #000000; stroke-width: 2.0;" width="1238" x="12" y="402.0586"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="1333.1738" style="stroke: #000000; stroke-width: 2.0;" width="1110.5" x="22" y="581.9219"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="846.5605" style="stroke: #000000; stroke-width: 2.0;" width="1090.5" x="32" y="746.4746"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="244.1055" style="stroke: #000000; stroke-width: 2.0;" width="786" x="303" y="770.7852"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="170.4844" style="stroke: #000000; stroke-width: 2.0;" width="766" x="313" y="837.4063"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="116.8867" style="stroke: #000000; stroke-width: 2.0;" width="355.5" x="313" y="1028.8906"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="355.5" x="313" y="1088.5117"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="243.4395" style="stroke: #000000; stroke-width: 2.0;" width="1070.5" x="42" y="1159.7773"/><rect fill="#FFFFFF" height="112.8867" style="stroke: none; stroke-width: 1.0;" width="1070.5" x="42" y="1290.3301"/><rect fill="#FFFFFF" height="182.8184" style="stroke: none; stroke-width: 1.0;" width="1090.5" x="32" y="1410.2168"/><rect fill="#FFFFFF" height="315.0605" style="stroke: none; stroke-width: 1.0;" width="1110.5" x="22" y="1600.0352"/><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="253" x="313" y="1735.2324"/><rect fill="#FFFFFF" height="128.1973" style="stroke: none; stroke-width: 1.0;" width="1238" x="12" y="1922.0957"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="179" x2="179" y1="101.9531" y2="2067.293"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="362" x2="362" y1="101.9531" y2="2067.293"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="959.5" x2="959.5" y1="101.9531" y2="2067.293"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1059.5" x2="1059.5" y1="101.9531" y2="2067.293"/><rect fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="138" y="66.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="145" y="87">Payer FSP</text><rect fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="138" y="2066.293"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="145" y="2086.8281">Payer FSP</text><rect fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="323" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="338.5" y="54.0234">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="330" y="70.5117">[Quoting</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="334" y="87">Service]</text><rect fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="323" y="2066.293"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="338.5" y="2086.8281">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="330" y="2103.3164">[Quoting</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="334" y="2119.8047">Service]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="911.5" y="99">Central Store</text><path d="M941.5,49.4648 C941.5,39.4648 959.5,39.4648 959.5,39.4648 C959.5,39.4648 977.5,39.4648 977.5,49.4648 L977.5,75.4648 C977.5,85.4648 959.5,85.4648 959.5,85.4648 C959.5,85.4648 941.5,85.4648 941.5,75.4648 L941.5,49.4648 " fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M941.5,49.4648 C941.5,59.4648 959.5,59.4648 959.5,59.4648 C959.5,59.4648 977.5,59.4648 977.5,49.4648 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="911.5" y="2079.8281">Central Store</text><path d="M941.5,2092.7813 C941.5,2082.7813 959.5,2082.7813 959.5,2082.7813 C959.5,2082.7813 977.5,2082.7813 977.5,2092.7813 L977.5,2118.7813 C977.5,2128.7813 959.5,2128.7813 959.5,2128.7813 C959.5,2128.7813 941.5,2128.7813 941.5,2118.7813 L941.5,2092.7813 " fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M941.5,2092.7813 C941.5,2102.7813 959.5,2102.7813 959.5,2102.7813 C959.5,2102.7813 977.5,2102.7813 977.5,2092.7813 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="1017.5" y="66.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1024.5" y="87">Payee FSP</text><rect fill="#FEFECE" filter="url(#f1mkwv9iprmpo4)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="1017.5" y="2066.293"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1024.5" y="2086.8281">Payee FSP</text><rect fill="#FFFFFF" filter="url(#f1mkwv9iprmpo4)" height="123.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="954.5" y="876.0273"/><path d="M184,116.9531 L184,156.9531 L486,156.9531 L486,126.9531 L476,116.9531 L184,116.9531 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M476,116.9531 L476,126.9531 L486,126.9531 L476,116.9531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="190" y="134.5215">Payer FSP sends request to get quote details</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="190" y="149.832">to Payee FSP via the Switch</text><polygon fill="#A80036" points="350.5,183.8848,360.5,187.8848,350.5,187.8848" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179.5" x2="361.5" y1="187.8848" y2="187.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="186.5" y="183.1426">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="199.5" y="183.1426">GET /quotes/{ID}</text><path d="M367,200.8848 L367,271.8848 L596,271.8848 L596,210.8848 L586,200.8848 L367,200.8848 " fill="#AAAAAA" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M586,200.8848 L586,210.8848 L596,210.8848 L586,200.8848 " fill="#AAAAAA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="373" y="218.4531">Validate request against</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="373" y="233.7637">Mojaloop interface specification</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="373" y="249.0742">Error code: 300x, 310x</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="373" y="264.3848">HTTP error response code: 4xx</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="302.4375" y2="302.4375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="302.4375" y2="315.4375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="315.4375" y2="315.4375"/><polygon fill="#A80036" points="373.5,311.4375,363.5,315.4375,373.5,319.4375,369.5,315.4375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="369.5" y="297.6953">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="382.5" y="297.6953">Schema validation</text><polygon fill="#A80036" points="190.5,345.748,180.5,345.748,190.5,349.748" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="179.5" x2="361.5" y1="344.748" y2="344.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="196.5" y="340.0059">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="209.5" y="340.0059">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="374.0586" y2="374.0586"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="374.0586" y2="387.0586"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="387.0586" y2="387.0586"/><polygon fill="#A80036" points="373.5,383.0586,363.5,387.0586,373.5,391.0586,369.5,387.0586" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="369.5" y="369.3164">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="382.5" y="369.3164">Retrieve quotes endpoint for Payee FSP</text><path d="M12,402.0586 L74,402.0586 L74,409.0586 L64,419.0586 L12,419.0586 L12,402.0586 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1648.2344" style="stroke: #000000; stroke-width: 2.0;" width="1238" x="12" y="402.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="27" y="415.627">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="89" y="414.6934">[Payee FSP quotes endpoint is found]</text><path d="M367,424.3691 L367,464.3691 L758,464.3691 L758,434.3691 L748,424.3691 L367,424.3691 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M748,424.3691 L748,434.3691 L758,434.3691 L748,424.3691 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="373" y="441.9375">Switch forwards request to Payee FSP (pass-through mode)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="373" y="457.248">&lt;Payer based Rules&gt;</text><polygon fill="#A80036" points="1048,491.3008,1058,495.3008,1048,495.3008" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="1059" y1="495.3008" y2="495.3008"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="369.5" y="490.5586">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="382.5" y="490.5586">GET /quotes/{ID}</text><polygon fill="#A80036" points="373.5,525.6113,363.5,525.6113,373.5,529.6113" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="362.5" x2="1059" y1="524.6113" y2="524.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="379.5" y="519.8691">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="392.5" y="519.8691">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1060" x2="1102" y1="553.9219" y2="553.9219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1102" x2="1102" y1="553.9219" y2="566.9219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1061" x2="1102" y1="566.9219" y2="566.9219"/><polygon fill="#A80036" points="1071,562.9219,1061,566.9219,1071,570.9219,1067,566.9219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1067" y="549.1797">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1080" y="549.1797">Payee FSP retireves quote</text><path d="M22,581.9219 L84,581.9219 L84,588.9219 L74,598.9219 L22,598.9219 L22,581.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1333.1738" style="stroke: #000000; stroke-width: 2.0;" width="1110.5" x="22" y="581.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="37" y="595.4902">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="218" x="99" y="594.5566">[Payee FSP successfully retieves quote]</text><path d="M800,604.2324 L800,629.2324 L1051,629.2324 L1051,614.2324 L1041,604.2324 L800,604.2324 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1041,604.2324 L1041,614.2324 L1051,614.2324 L1041,604.2324 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="806" y="621.8008">Payee FSP responds to quote request</text><polygon fill="#A80036" points="373.5,655.8535,363.5,659.8535,373.5,659.8535" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="1059" y1="659.8535" y2="659.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="379.5" y="655.1113">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="392.5" y="655.1113">PUT /quotes/{ID}</text><polygon fill="#A80036" points="1048,690.1641,1058,690.1641,1048,694.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="362.5" x2="1059" y1="689.1641" y2="689.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="369.5" y="684.4219">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="382.5" y="684.4219">200 Ok</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="718.4746" y2="718.4746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="718.4746" y2="731.4746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="731.4746" y2="731.4746"/><polygon fill="#A80036" points="373.5,727.4746,363.5,731.4746,373.5,735.4746,369.5,731.4746" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="713.7324">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="391.5" y="713.7324">Validate response (schema, headers (</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="623.5" y="713.7324">Error code: 3100</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="736.5" y="713.7324">))</text><path d="M32,746.4746 L94,746.4746 L94,753.4746 L84,763.4746 L32,763.4746 L32,746.4746 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="846.5605" style="stroke: #000000; stroke-width: 2.0;" width="1090.5" x="32" y="746.4746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="47" y="760.043">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="109" y="759.1094">[Response is ok]</text><path d="M303,770.7852 L365,770.7852 L365,777.7852 L355,787.7852 L303,787.7852 L303,770.7852 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="244.1055" style="stroke: #000000; stroke-width: 2.0;" width="786" x="303" y="770.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="318" y="784.3535">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="380" y="783.4199">[SimpleRoutingMode is FALSE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="809.4063" y2="809.4063"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="809.4063" y2="822.4063"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="822.4063" y2="822.4063"/><polygon fill="#A80036" points="373.5,818.4063,363.5,822.4063,373.5,826.4063,369.5,822.4063" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="804.6641">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="440" x="391.5" y="804.6641">Validate response (duplicate response check, handle resend scenario (</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="831.5" y="804.6641">Error code: 3106</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="944.5" y="804.6641">))</text><path d="M313,837.4063 L375,837.4063 L375,844.4063 L365,854.4063 L313,854.4063 L313,837.4063 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="170.4844" style="stroke: #000000; stroke-width: 2.0;" width="766" x="313" y="837.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="328" y="850.9746">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="390" y="850.041">[Validation passed]</text><polygon fill="#A80036" points="942.5,872.0273,952.5,876.0273,942.5,876.0273" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="953.5" y1="876.0273" y2="876.0273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="871.2852">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="391.5" y="871.2852">Persist quote response</text><polygon fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" points="860,889.0273,1059,889.0273,1069,931.0273,1059,973.0273,860,973.0273,850,931.0273,860,889.0273" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="862" y="905.5957">quoteResponse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="862" y="920.9063">quoteResponseDuplicateCheck</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="862" y="936.2168">quoteResponseIlpPacket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="862" y="951.5273">quoteExtensions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="862" y="966.8379">geoCode</text><polygon fill="#A80036" points="373.5,1000.8906,363.5,1000.8906,373.5,1004.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="362.5" x2="958.5" y1="999.8906" y2="999.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="379.5" y="995.1484">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="401.5" y="995.1484">Quote response saved</text><path d="M313,1028.8906 L375,1028.8906 L375,1035.8906 L365,1045.8906 L313,1045.8906 L313,1028.8906 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="116.8867" style="stroke: #000000; stroke-width: 2.0;" width="355.5" x="313" y="1028.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="328" y="1042.459">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="390" y="1041.5254">[SimpleRoutingMode is TRUE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="1067.5117" y2="1067.5117"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="1067.5117" y2="1080.5117"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="1080.5117" y2="1080.5117"/><polygon fill="#A80036" points="373.5,1076.5117,363.5,1080.5117,373.5,1084.5117,369.5,1080.5117" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="1062.7695">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="391.5" y="1062.7695">Retrieve quotes endpoint for the Payer FSP</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="313" x2="668.5" y1="1089.5117" y2="1089.5117"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="318" y="1100.1465">[SimpleRoutingMode is FALSE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="1124.7773" y2="1124.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="1124.7773" y2="1137.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="1137.7773" y2="1137.7773"/><polygon fill="#A80036" points="373.5,1133.7773,363.5,1137.7773,373.5,1141.7773,369.5,1137.7773" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="1120.0352">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="391.5" y="1120.0352">Retrieve quote party endpoint (PAYER)</text><path d="M42,1159.7773 L104,1159.7773 L104,1166.7773 L94,1176.7773 L42,1176.7773 L42,1159.7773 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="243.4395" style="stroke: #000000; stroke-width: 2.0;" width="1070.5" x="42" y="1159.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="57" y="1173.3457">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="119" y="1172.4121">[Quotes callback endpoint found]</text><path d="M52,1182.0879 L52,1222.0879 L353,1222.0879 L353,1192.0879 L343,1182.0879 L52,1182.0879 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M343,1182.0879 L343,1192.0879 L353,1192.0879 L343,1182.0879 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="58" y="1199.6563">Switch forwards quote response to Payer FSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="58" y="1214.9668">&lt;Payee whole request Rule&gt;</text><polygon fill="#A80036" points="190.5,1249.0195,180.5,1253.0195,190.5,1253.0195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179.5" x2="361.5" y1="1253.0195" y2="1253.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="196.5" y="1248.2773">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="218.5" y="1248.2773">PUT /quotes/{ID}</text><polygon fill="#A80036" points="350.5,1283.3301,360.5,1283.3301,350.5,1287.3301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="179.5" x2="361.5" y1="1282.3301" y2="1282.3301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="186.5" y="1277.5879">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="208.5" y="1277.5879">200 Ok</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="42" x2="1112.5" y1="1291.3301" y2="1291.3301"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="209" x="47" y="1301.9648">[Quotes callback endpoint not found]</text><path d="M367,1310.2852 L367,1335.2852 L593,1335.2852 L593,1320.2852 L583,1310.2852 L367,1310.2852 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M583,1310.2852 L583,1320.2852 L593,1320.2852 L583,1310.2852 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="373" y="1327.8535">Switch returns error to Payee FSP</text><polygon fill="#A80036" points="1048,1361.9063,1058,1365.9063,1048,1365.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="1059" y1="1365.9063" y2="1365.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="1361.1641">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="391.5" y="1361.1641">PUT /quotes/{ID}/error</text><polygon fill="#A80036" points="373.5,1396.2168,363.5,1396.2168,373.5,1400.2168" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="362.5" x2="1059" y1="1395.2168" y2="1395.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="379.5" y="1390.4746">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="401.5" y="1390.4746">200 Ok</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="32" x2="1122.5" y1="1411.2168" y2="1411.2168"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="37" y="1421.8516">[Response is invalid]</text><path d="M367,1430.1719 L367,1455.1719 L593,1455.1719 L593,1440.1719 L583,1430.1719 L367,1430.1719 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M583,1430.1719 L583,1440.1719 L593,1440.1719 L583,1430.1719 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="373" y="1447.7402">Switch returns error to Payee FSP</text><polygon fill="#A80036" points="1048,1481.793,1058,1485.793,1048,1485.793" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="1059" y1="1485.793" y2="1485.793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="1481.0508">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="391.5" y="1481.0508">PUT /quotes/{ID}/error</text><polygon fill="#A80036" points="373.5,1516.1035,363.5,1516.1035,373.5,1520.1035" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="362.5" x2="1059" y1="1515.1035" y2="1515.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="379.5" y="1510.3613">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="401.5" y="1510.3613">200 Ok</text><path d="M324,1528.1035 L324,1583.1035 L1098,1583.1035 L1098,1538.1035 L1088,1528.1035 L324,1528.1035 " fill="#EC7063" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1088,1528.1035 L1088,1538.1035 L1098,1538.1035 L1088,1528.1035 " fill="#EC7063" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="619.25" y="1545.6719">Note that under this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="619.25" y="1560.9824">scenario the Payer FSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="619.25" y="1576.293">may not receive a response</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="22" x2="1132.5" y1="1601.0352" y2="1601.0352"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="27" y="1611.6699">[Quote not found]</text><path d="M825,1619.9902 L825,1659.9902 L1051,1659.9902 L1051,1629.9902 L1041,1619.9902 L825,1619.9902 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1041,1619.9902 L1041,1629.9902 L1051,1629.9902 L1041,1619.9902 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="831" y="1637.5586">Payee FSP returns error to Switch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="835" y="1652.8691"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="835" y="1652.8691">Error code: 3205</text><polygon fill="#A80036" points="373.5,1686.9219,363.5,1690.9219,373.5,1690.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="1059" y1="1690.9219" y2="1690.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="379.5" y="1686.1797">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="401.5" y="1686.1797">PUT quotes/{ID}/error</text><polygon fill="#A80036" points="1048,1721.2324,1058,1721.2324,1048,1725.2324" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="362.5" x2="1059" y1="1720.2324" y2="1720.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="1715.4902">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="391.5" y="1715.4902">200 OK</text><path d="M313,1735.2324 L375,1735.2324 L375,1742.2324 L365,1752.2324 L313,1752.2324 L313,1735.2324 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="253" x="313" y="1735.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="328" y="1748.8008">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="390" y="1747.8672">[SimpleRoutingMode is FALSE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="1773.8535" y2="1773.8535"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="1773.8535" y2="1786.8535"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="1786.8535" y2="1786.8535"/><polygon fill="#A80036" points="373.5,1782.8535,363.5,1786.8535,373.5,1790.8535,369.5,1786.8535" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="369.5" y="1769.1113">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="391.5" y="1769.1113">Persist error data</text><path d="M129,1806.8535 L129,1846.8535 L353,1846.8535 L353,1816.8535 L343,1806.8535 L129,1806.8535 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M343,1806.8535 L343,1816.8535 L353,1816.8535 L343,1806.8535 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="135" y="1824.4219">Switch returns error to Payer FSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="139" y="1839.7324"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="139" y="1839.7324">Error code: 3205</text><polygon fill="#A80036" points="190.5,1873.7852,180.5,1877.7852,190.5,1877.7852" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179.5" x2="361.5" y1="1877.7852" y2="1877.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="196.5" y="1873.043">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="218.5" y="1873.043">PUT quotes/{ID}/error</text><polygon fill="#A80036" points="350.5,1908.0957,360.5,1908.0957,350.5,1912.0957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="179.5" x2="361.5" y1="1907.0957" y2="1907.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="186.5" y="1902.3535">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="208.5" y="1902.3535">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="12" x2="1250" y1="1923.0957" y2="1923.0957"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="229" x="17" y="1933.7305">[Payee FSP quotes endpoint is not found]</text><path d="M129,1942.0508 L129,1982.0508 L353,1982.0508 L353,1952.0508 L343,1942.0508 L129,1942.0508 " fill="#FBFB77" filter="url(#f1mkwv9iprmpo4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M343,1942.0508 L343,1952.0508 L353,1952.0508 L343,1942.0508 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="135" y="1959.6191">Switch returns error to Payer FSP</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="135" y="1974.9297">Error code: 3201</text><polygon fill="#A80036" points="190.5,2008.9824,180.5,2012.9824,190.5,2012.9824" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179.5" x2="361.5" y1="2012.9824" y2="2012.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="196.5" y="2008.2402">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="218.5" y="2008.2402">PUT quotes/{ID}error</text><polygon fill="#A80036" points="350.5,2043.293,360.5,2043.293,350.5,2047.293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="179.5" x2="361.5" y1="2042.293" y2="2042.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="186.5" y="2037.5508">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="208.5" y="2037.5508">200 OK</text><!--
@startuml
Title Retrieve Quote Information
participant "Payer FSP" as PayerFSP
participant "Switch\n[Quoting\nService]" as Switch
database "Central Store" as DB
participant "Payee FSP" as PayeeFSP
autonumber
note right of PayerFSP: Payer FSP sends request to get quote details \nto Payee FSP via the Switch
PayerFSP -\ Switch: GET /quotes/{ID}
note right of Switch #aaa
    Validate request against 
    Mojaloop interface specification
    **<color #red>Error code: 300x, 310x</color>**
    **<color #red>HTTP error response code: 4xx</color>**
end note
Switch -> Switch: Schema validation
PayerFSP \- - Switch: 202 Accepted
Switch -> Switch: Retrieve quotes endpoint for Payee FSP
alt Payee FSP quotes endpoint is found
    note right of Switch: Switch forwards request to Payee FSP (pass-through mode)\n<Payer based Rules> 
    Switch -\ PayeeFSP: GET /quotes/{ID}
    PayeeFSP - -/ Switch: 202 Accepted
    PayeeFSP -> PayeeFSP: Payee FSP retireves quote
    alt Payee FSP successfully retieves quote
        note left of PayeeFSP: Payee FSP responds to quote request
        PayeeFSP -\ Switch: PUT /quotes/{ID}
        Switch - -/ PayeeFSP: 200 Ok
        Switch -> Switch: Validate response (schema, headers (<color #red>**Error code: 3100**</color>))
        alt Response is ok
            alt SimpleRoutingMode is FALSE
                Switch -> Switch: Validate response (duplicate response check, handle resend scenario (<color #red>**Error code: 3106**</color>))
                alt Validation passed
                    Switch -\ DB: Persist quote response
                    activate DB
                        hnote over DB
                            quoteResponse
                            quoteResponseDuplicateCheck
                            quoteResponseIlpPacket
                            quoteExtensions
                            geoCode
                        end hnote
                    Switch \- - DB: Quote response saved
                    deactivate DB
                end
            end
            alt SimpleRoutingMode is TRUE
                Switch -> Switch: Retrieve quotes endpoint for the Payer FSP
            else SimpleRoutingMode is FALSE
                Switch -> Switch: Retrieve quote party endpoint (PAYER)
            end
            alt Quotes callback endpoint found
                note left of Switch: Switch forwards quote response to Payer FSP\n<Payee \ whole request Rule>
                Switch -\ PayerFSP: PUT /quotes/{ID}
                PayerFSP - -/ Switch: 200 Ok    
            else Quotes callback endpoint not found
                note right of Switch: Switch returns error to Payee FSP
                Switch -\ PayeeFSP: PUT /quotes/{ID}/error
                PayeeFSP - -/ Switch : 200 Ok
            end
        else Response is invalid
            note right of Switch: Switch returns error to Payee FSP
            Switch -\ PayeeFSP: PUT /quotes/{ID}/error
            PayeeFSP - -/ Switch : 200 Ok
            note over Switch, PayeeFSP #ec7063: Note that under this\nscenario the Payer FSP\nmay not receive a response
        end

    else Quote not found
        note left of PayeeFSP: Payee FSP returns error to Switch\n <color #red>**Error code: 3205**</color>
        PayeeFSP -\ Switch: PUT quotes/{ID}/error
        Switch - -/ PayeeFSP: 200 OK
        alt SimpleRoutingMode is FALSE
            Switch -> Switch: Persist error data
        end
        note left of Switch: Switch returns error to Payer FSP\n <color #red>**Error code: 3205**</color>
        Switch -\ PayerFSP: PUT quotes/{ID}/error
        PayerFSP - -/ Switch: 200 OK
    end
else Payee FSP quotes endpoint is not found
    note left of Switch
        Switch returns error to Payer FSP
        **<color #red>Error code: 3201</color>**
    end note
    PayerFSP /- Switch: PUT quotes/{ID}error
    PayerFSP - -/ Switch: 200 OK
end
@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>