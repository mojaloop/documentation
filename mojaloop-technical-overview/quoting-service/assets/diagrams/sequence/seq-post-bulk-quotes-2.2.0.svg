<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1898px" preserveAspectRatio="none" style="width:964px;height:1898px;" version="1.1" viewBox="0 0 964 1898" width="964px" zoomAndPan="magnify"><defs><filter height="300%" id="f83zwhqui1a16" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="210" x="377.75" y="23.5352">Request Bulk Quote Creation</text><rect fill="#FFFFFF" filter="url(#f83zwhqui1a16)" height="237.8184" style="stroke: #000000; stroke-width: 2.0;" width="506.5" x="65" y="502.8809"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="506.5" x="65" y="683.4336"/><rect fill="#FFFFFF" filter="url(#f83zwhqui1a16)" height="987.2266" style="stroke: #000000; stroke-width: 2.0;" width="940.5" x="12" y="837.3203"/><rect fill="#FFFFFF" filter="url(#f83zwhqui1a16)" height="672.166" style="stroke: #000000; stroke-width: 2.0;" width="726" x="22" y="1017.1836"/><rect fill="#FFFFFF" filter="url(#f83zwhqui1a16)" height="75.9316" style="stroke: #000000; stroke-width: 2.0;" width="459.5" x="264.5" y="1224.0469"/><rect fill="#FFFFFF" filter="url(#f83zwhqui1a16)" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="316" x="264.5" y="1313.9785"/><rect fill="#FFFFFF" height="210.8184" style="stroke: none; stroke-width: 1.0;" width="726" x="22" y="1478.5313"/><rect fill="#FFFFFF" height="128.1973" style="stroke: none; stroke-width: 1.0;" width="940.5" x="12" y="1696.3496"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="122" x2="122" y1="85.4648" y2="1841.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="342.5" x2="342.5" y1="85.4648" y2="1841.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="671" x2="671" y1="85.4648" y2="1841.5469"/><rect fill="#FEFECE" filter="url(#f83zwhqui1a16)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="81" y="49.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="88" y="70.5117">Payer FSP</text><rect fill="#FEFECE" filter="url(#f83zwhqui1a16)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="81" y="1840.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="88" y="1861.082">Payer FSP</text><rect fill="#FEFECE" filter="url(#f83zwhqui1a16)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="274.5" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="318.5" y="54.0234">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="281.5" y="70.5117">[Quoting Service]</text><rect fill="#FEFECE" filter="url(#f83zwhqui1a16)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="274.5" y="1840.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="318.5" y="1861.082">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="281.5" y="1877.5703">[Quoting Service]</text><rect fill="#FEFECE" filter="url(#f83zwhqui1a16)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="629" y="49.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="636" y="70.5117">Payee FSP</text><rect fill="#FEFECE" filter="url(#f83zwhqui1a16)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="629" y="1840.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="636" y="1861.082">Payee FSP</text><path d="M70,100.4648 L70,140.4648 L394,140.4648 L394,110.4648 L384,100.4648 L70,100.4648 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M384,100.4648 L384,110.4648 L394,110.4648 L384,100.4648 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="114.75" y="118.0332">Payer FSP sends bulk quote request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="114.75" y="133.3438">to Payee FSP via the Switch</text><polygon fill="#A80036" points="330.5,167.3965,340.5,171.3965,330.5,171.3965" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122.5" x2="341.5" y1="171.3965" y2="171.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="129.5" y="166.6543">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="142.5" y="166.6543">POST /bulkQuotes</text><path d="M347,184.3965 L347,255.3965 L576,255.3965 L576,194.3965 L566,184.3965 L347,184.3965 " fill="#AAAAAA" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M566,184.3965 L566,194.3965 L576,194.3965 L566,184.3965 " fill="#AAAAAA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="353" y="201.9648">Validate request against</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="353" y="217.2754">Mojaloop interface specification</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="353" y="232.5859">Error code: 300x, 310x</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="353" y="247.8965">HTTP error response code: 4xx</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="285.9492" y2="285.9492"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="285.9492" y2="298.9492"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="298.9492" y2="298.9492"/><polygon fill="#A80036" points="353.5,294.9492,343.5,298.9492,353.5,302.9492,349.5,298.9492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="281.207">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="362.5" y="281.207">Schema validation</text><polygon fill="#A80036" points="133.5,329.2598,123.5,329.2598,133.5,333.2598" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122.5" x2="341.5" y1="328.2598" y2="328.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139.5" y="323.5176">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="152.5" y="323.5176">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="382.5703" y2="382.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="382.5703" y2="395.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="395.5703" y2="395.5703"/><polygon fill="#A80036" points="353.5,391.5703,343.5,395.5703,353.5,399.5703,349.5,395.5703" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="377.8281">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="302" x="362.5" y="377.8281">Bulk Quote request validation (rules engine etc.)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="449.8809" y2="449.8809"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="449.8809" y2="462.8809"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="462.8809" y2="462.8809"/><polygon fill="#A80036" points="353.5,458.8809,343.5,462.8809,353.5,466.8809,349.5,462.8809" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="445.1387">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="362.5" y="445.1387">Duplicate check</text><path d="M65,502.8809 L127,502.8809 L127,509.8809 L117,519.8809 L65,519.8809 L65,502.8809 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="237.8184" style="stroke: #000000; stroke-width: 2.0;" width="506.5" x="65" y="502.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="80" y="516.4492">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="226" x="142" y="515.5156">[Request is a duplicate but not a resend]</text><path d="M75,550.1914 L75,590.1914 L333,590.1914 L333,560.1914 L323,550.1914 L75,550.1914 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,550.1914 L323,560.1914 L333,560.1914 L323,550.1914 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="81" y="567.7598">Switch returns error back to Payer FSP</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="81" y="583.0703">Error code: 3106</text><polygon fill="#A80036" points="133.5,617.123,123.5,621.123,133.5,621.123" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122.5" x2="341.5" y1="621.123" y2="621.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139.5" y="616.3809">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="152.5" y="616.3809">PUT /bulkQuotes/{ID}/error</text><polygon fill="#A80036" points="330.5,651.4336,340.5,651.4336,330.5,655.4336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122.5" x2="341.5" y1="650.4336" y2="650.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="129.5" y="645.6914">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="142.5" y="645.6914">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="65" x2="571.5" y1="684.4336" y2="684.4336"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="70" y="695.0684">[Request is a duplicate and a resend]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="719.6992" y2="719.6992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="719.6992" y2="732.6992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="732.6992" y2="732.6992"/><polygon fill="#A80036" points="353.5,728.6992,343.5,732.6992,353.5,736.6992,349.5,732.6992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="714.957">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="362.5" y="714.957">Switch handles resend scenario</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="809.3203" y2="809.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="809.3203" y2="822.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="822.3203" y2="822.3203"/><polygon fill="#A80036" points="353.5,818.3203,343.5,822.3203,353.5,826.3203,349.5,822.3203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="796.9229">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="362.5" y="789.2676">Use fspiop-destination header to retrieve</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="366.5" y="804.5781">bulk quotes endpoint for Payee DFSP</text><path d="M12,837.3203 L74,837.3203 L74,844.3203 L64,854.3203 L12,854.3203 L12,837.3203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="987.2266" style="stroke: #000000; stroke-width: 2.0;" width="940.5" x="12" y="837.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="27" y="850.8887">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="199" x="89" y="849.9551">[Payee bulk quotes endpoint found]</text><path d="M347,859.6309 L347,884.6309 L672,884.6309 L672,869.6309 L662,859.6309 L347,859.6309 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M662,859.6309 L662,869.6309 L672,869.6309 L662,859.6309 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="353" y="877.1992">Switch forwards bulk quote request to Payee FSP</text><polygon fill="#A80036" points="659.5,911.252,669.5,915.252,659.5,915.252" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="670.5" y1="915.252" y2="915.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="910.5098">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="371.5" y="910.5098">POST /bulkQuotes</text><polygon fill="#A80036" points="353.5,945.5625,343.5,945.5625,353.5,949.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="670.5" y1="944.5625" y2="944.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="939.8203">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="381.5" y="939.8203">202 OK</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="671.5" x2="713.5" y1="989.1836" y2="989.1836"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="713.5" x2="713.5" y1="989.1836" y2="1002.1836"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="672.5" x2="713.5" y1="1002.1836" y2="1002.1836"/><polygon fill="#A80036" points="682.5,998.1836,672.5,1002.1836,682.5,1006.1836,678.5,1002.1836" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="678.5" y="976.7861">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="700.5" y="969.1309">Payee FSP calculates individual quotes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="700.5" y="984.4414">and responds with a bulk quote result</text><path d="M22,1017.1836 L84,1017.1836 L84,1024.1836 L74,1034.1836 L22,1034.1836 L22,1017.1836 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="672.166" style="stroke: #000000; stroke-width: 2.0;" width="726" x="22" y="1017.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="37" y="1030.752">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="235" x="99" y="1029.8184">[Payee bulkQuotes processing successful]</text><path d="M275,1039.4941 L275,1064.4941 L734,1064.4941 L734,1049.4941 L724,1039.4941 L275,1039.4941 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M724,1039.4941 L724,1049.4941 L734,1049.4941 L724,1039.4941 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="438" x="281" y="1057.0625">Payee FSP sends bulk quote response back to Payer FSP via the Switch</text><polygon fill="#A80036" points="353.5,1091.1152,343.5,1095.1152,353.5,1095.1152" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="670.5" y1="1095.1152" y2="1095.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1090.373">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="381.5" y="1090.373">PUT /bulkQuotes/{ID}</text><polygon fill="#A80036" points="659.5,1125.4258,669.5,1125.4258,659.5,1129.4258" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="670.5" y1="1124.4258" y2="1124.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1119.6836">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="371.5" y="1119.6836">200 OK</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1153.7363" y2="1153.7363"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1153.7363" y2="1166.7363"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1166.7363" y2="1166.7363"/><polygon fill="#A80036" points="353.5,1162.7363,343.5,1166.7363,353.5,1170.7363,349.5,1166.7363" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1148.9941">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="371.5" y="1148.9941">Validate bulk quote response</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1196.0469" y2="1196.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1196.0469" y2="1209.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1209.0469" y2="1209.0469"/><polygon fill="#A80036" points="353.5,1205.0469,343.5,1209.0469,353.5,1213.0469,349.5,1209.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1191.3047">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="371.5" y="1191.3047">Duplicate check</text><path d="M264.5,1224.0469 L326.5,1224.0469 L326.5,1231.0469 L316.5,1241.0469 L264.5,1241.0469 L264.5,1224.0469 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.9316" style="stroke: #000000; stroke-width: 2.0;" width="459.5" x="264.5" y="1224.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="279.5" y="1237.6152">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="225" x="341.5" y="1236.6816">[Response is duplicate but not a resend]</text><polygon fill="#A80036" points="659.5,1258.668,669.5,1262.668,659.5,1262.668" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="670.5" y1="1262.668" y2="1262.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1257.9258">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="371.5" y="1257.9258">PUT /bulkQuotes/{ID}/error</text><polygon fill="#A80036" points="353.5,1292.9785,343.5,1292.9785,353.5,1296.9785" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="670.5" y1="1291.9785" y2="1291.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1287.2363">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="381.5" y="1287.2363">200 OK</text><path d="M264.5,1313.9785 L326.5,1313.9785 L326.5,1320.9785 L316.5,1330.9785 L264.5,1330.9785 L264.5,1313.9785 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="316" x="264.5" y="1313.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="279.5" y="1327.5469">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="341.5" y="1326.6133">[Response is a duplicate and a resend]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1352.5996" y2="1352.5996"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1352.5996" y2="1365.5996"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1365.5996" y2="1365.5996"/><polygon fill="#A80036" points="353.5,1361.5996,343.5,1365.5996,353.5,1369.5996,349.5,1365.5996" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1347.8574">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="371.5" y="1347.8574">Switch handles resend scenario</text><path d="M32,1385.5996 L32,1410.5996 L333,1410.5996 L333,1395.5996 L323,1385.5996 L32,1385.5996 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,1385.5996 L323,1395.5996 L333,1395.5996 L323,1385.5996 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="38" y="1403.168">Switch forwards quote response to Payer FSP</text><polygon fill="#A80036" points="133.5,1437.2207,123.5,1441.2207,133.5,1441.2207" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122.5" x2="341.5" y1="1441.2207" y2="1441.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="139.5" y="1436.4785">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="161.5" y="1436.4785">PUT /bulkQuotes/{ID}</text><polygon fill="#A80036" points="330.5,1471.5313,340.5,1471.5313,330.5,1475.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122.5" x2="341.5" y1="1470.5313" y2="1470.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="129.5" y="1465.7891">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="151.5" y="1465.7891">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="22" x2="748" y1="1479.5313" y2="1479.5313"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="274" x="27" y="1490.166">[Payee rejects bulk quote or encounters an error]</text><path d="M280,1498.4863 L280,1523.4863 L662,1523.4863 L662,1508.4863 L652,1498.4863 L280,1498.4863 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M652,1498.4863 L652,1508.4863 L662,1508.4863 L652,1498.4863 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="361" x="286" y="1516.0547">Payee FSP sends error callback to Payer FSP via the Switch</text><polygon fill="#A80036" points="353.5,1550.1074,343.5,1554.1074,353.5,1554.1074" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="670.5" y1="1554.1074" y2="1554.1074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1549.3652">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="381.5" y="1549.3652">PUT /bulkQuotes/{ID}/error</text><polygon fill="#A80036" points="659.5,1584.418,669.5,1584.418,659.5,1588.418" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="670.5" y1="1583.418" y2="1583.418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1578.6758">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="371.5" y="1578.6758">200 OK</text><path d="M43,1596.418 L43,1621.418 L333,1621.418 L333,1606.418 L323,1596.418 L43,1596.418 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,1596.418 L323,1606.418 L333,1606.418 L323,1596.418 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="49" y="1613.9863">Switch forwards error callback to Payer FSP</text><polygon fill="#A80036" points="133.5,1648.0391,123.5,1652.0391,133.5,1652.0391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122.5" x2="341.5" y1="1652.0391" y2="1652.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="139.5" y="1647.2969">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="161.5" y="1647.2969">PUT /bulkQuotes/{ID}/error</text><polygon fill="#A80036" points="330.5,1682.3496,340.5,1682.3496,330.5,1686.3496" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122.5" x2="341.5" y1="1681.3496" y2="1681.3496"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="129.5" y="1676.6074">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="151.5" y="1676.6074">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="12" x2="952.5" y1="1697.3496" y2="1697.3496"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="17" y="1707.9844">[Payee FSP quotes endpoint not found]</text><path d="M38,1716.3047 L38,1756.3047 L333,1756.3047 L333,1726.3047 L323,1716.3047 L38,1716.3047 " fill="#FBFB77" filter="url(#f83zwhqui1a16)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,1716.3047 L323,1726.3047 L333,1726.3047 L323,1716.3047 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="270" x="44" y="1733.873">Switch sends an error callback to Payer FSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="48" y="1749.1836"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="48" y="1749.1836">Error code: 3201</text><polygon fill="#A80036" points="133.5,1783.2363,123.5,1787.2363,133.5,1787.2363" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122.5" x2="341.5" y1="1787.2363" y2="1787.2363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="139.5" y="1782.4941">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="161.5" y="1782.4941">PUT /bulkQuotes/{ID}/error</text><polygon fill="#A80036" points="330.5,1812.5469,340.5,1816.5469,330.5,1816.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122.5" x2="341.5" y1="1816.5469" y2="1816.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="129.5" y="1811.8047">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="151.5" y="1811.8047">200 OK</text><!--
@startuml
Title Request Bulk Quote Creation
participant "Payer FSP" as PayerFSP
participant "Switch\n[Quoting Service]" as Switch
participant "Payee FSP" as PayeeFSP
autonumber

note over PayerFSP, Switch: Payer FSP sends bulk quote request\nto Payee FSP via the Switch
PayerFSP -\ Switch: POST /bulkQuotes
note right of Switch #aaa
    Validate request against 
    Mojaloop interface specification
    **<color #red>Error code: 300x, 310x</color>**
    **<color #red>HTTP error response code: 4xx</color>**
end note
Switch -> Switch: Schema validation
PayerFSP \- - Switch: 202 Accepted
|||
Switch -> Switch: Bulk Quote request validation (rules engine etc.)
|||
Switch -> Switch: Duplicate check
|||
alt Request is a duplicate but not a resend
|||
    note left of Switch
        Switch returns error back to Payer FSP
        <color #red>**Error code: 3106**</color>
    end note
    PayerFSP /- Switch: PUT /bulkQuotes/{ID}/error
    PayerFSP - -/ Switch: 200 OK
|||
else Request is a duplicate and a resend
    Switch -> Switch: Switch handles resend scenario
end
|||
Switch -> Switch: Use fspiop-destination header to retrieve\n bulk quotes endpoint for Payee DFSP
alt Payee bulk quotes endpoint found
    note right of Switch: Switch forwards bulk quote request to Payee FSP
    Switch -\ PayeeFSP: POST /bulkQuotes
    Switch \- - PayeeFSP: 202 OK

    PayeeFSP -> PayeeFSP: Payee FSP calculates individual quotes\nand responds with a bulk quote result
    alt Payee bulkQuotes processing successful
        note over PayeeFSP, Switch: Payee FSP sends bulk quote response back to Payer FSP via the Switch
        Switch /- PayeeFSP: PUT /bulkQuotes/{ID}
        Switch - -/ PayeeFSP: 200 OK

        Switch -> Switch: Validate bulk quote response
        Switch -> Switch: Duplicate check
        alt Response is duplicate but not a resend
            Switch -\ PayeeFSP: PUT /bulkQuotes/{ID}/error
            Switch \- - PayeeFSP: 200 OK
        end
        alt Response is a duplicate and a resend
            Switch -> Switch: Switch handles resend scenario
        end

        note left of Switch: Switch forwards quote response to Payer FSP
        PayerFSP /- Switch: PUT /bulkQuotes/{ID}
        PayerFSP - -/ Switch: 200 OK
    else Payee rejects bulk quote or encounters an error
        note left of PayeeFSP: Payee FSP sends error callback to Payer FSP via the Switch
        Switch /- PayeeFSP: PUT /bulkQuotes/{ID}/error
        Switch - -/ PayeeFSP: 200 OK
        note left of Switch: Switch forwards error callback to Payer FSP
        PayerFSP /- Switch: PUT /bulkQuotes/{ID}/error
        PayerFSP - -/ Switch: 200 OK
    end
else Payee FSP quotes endpoint not found
    note left of Switch: Switch sends an error callback to Payer FSP \n <color #red>**Error code: 3201**</color>
    PayerFSP /- Switch: PUT /bulkQuotes/{ID}/error
    PayerFSP - -\ Switch: 200 OK
end

@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>