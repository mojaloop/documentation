<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2547px" preserveAspectRatio="none" style="width:1233px;height:2547px;" version="1.1" viewBox="0 0 1233 2547" width="1233px" zoomAndPan="magnify"><defs><filter height="300%" id="f1d9z4o69qkw63" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="530.5" y="23.5352">Request Quote Creation</text><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="139.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="826.5" y="834.8086"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="123.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="826.5" y="1750.459"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="826.5" y="2145.7617"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="529.9238" style="stroke: #000000; stroke-width: 2.0;" width="866" x="55" y="452.0586"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="237.8184" style="stroke: #000000; stroke-width: 2.0;" width="506.5" x="65" y="543.6797"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="506.5" x="65" y="724.2324"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="116.8867" style="stroke: #000000; stroke-width: 2.0;" width="543.5" x="293" y="1020.9824"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="543.5" x="293" y="1080.6035"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="1279.6426" style="stroke: #000000; stroke-width: 2.0;" width="1209" x="12" y="1176.8691"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="979.8926" style="stroke: #000000; stroke-width: 2.0;" width="982.5" x="22" y="1341.4219"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="376.3477" style="stroke: #000000; stroke-width: 2.0;" width="711.5" x="283" y="1505.9746"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="75.9316" style="stroke: #000000; stroke-width: 2.0;" width="691.5" x="293" y="1572.5957"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="297" x="293" y="1662.5273"/><rect fill="#FFFFFF" height="334.0605" style="stroke: none; stroke-width: 1.0;" width="982.5" x="22" y="1987.2539"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="109.2422" style="stroke: #000000; stroke-width: 2.0;" width="596.5" x="293" y="2107.1406"/><rect fill="#FFFFFF" height="128.1973" style="stroke: none; stroke-width: 1.0;" width="1209" x="12" y="2328.3145"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="152" x2="152" y1="101.9531" y2="2473.5117"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="342" x2="342" y1="101.9531" y2="2473.5117"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="831.5" x2="831.5" y1="101.9531" y2="2473.5117"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="931.5" x2="931.5" y1="101.9531" y2="2473.5117"/><rect fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="111" y="66.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="118" y="87">Payer FSP</text><rect fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="111" y="2472.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="118" y="2493.0469">Payer FSP</text><rect fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="303" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="318.5" y="54.0234">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="310" y="70.5117">[Quoting</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="314" y="87">Service]</text><rect fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="303" y="2472.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="318.5" y="2493.0469">Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="310" y="2509.5352">[Quoting</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="314" y="2526.0234">Service]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="783.5" y="99">Central Store</text><path d="M813.5,49.4648 C813.5,39.4648 831.5,39.4648 831.5,39.4648 C831.5,39.4648 849.5,39.4648 849.5,49.4648 L849.5,75.4648 C849.5,85.4648 831.5,85.4648 831.5,85.4648 C831.5,85.4648 813.5,85.4648 813.5,75.4648 L813.5,49.4648 " fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M813.5,49.4648 C813.5,59.4648 831.5,59.4648 831.5,59.4648 C831.5,59.4648 849.5,59.4648 849.5,49.4648 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="783.5" y="2486.0469">Central Store</text><path d="M813.5,2499 C813.5,2489 831.5,2489 831.5,2489 C831.5,2489 849.5,2489 849.5,2499 L849.5,2525 C849.5,2535 831.5,2535 831.5,2535 C831.5,2535 813.5,2535 813.5,2525 L813.5,2499 " fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M813.5,2499 C813.5,2509 831.5,2509 831.5,2509 C831.5,2509 849.5,2509 849.5,2499 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="889.5" y="66.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="896.5" y="87">Payee FSP</text><rect fill="#FEFECE" filter="url(#f1d9z4o69qkw63)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="889.5" y="2472.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="896.5" y="2493.0469">Payee FSP</text><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="139.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="826.5" y="834.8086"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="123.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="826.5" y="1750.459"/><rect fill="#FFFFFF" filter="url(#f1d9z4o69qkw63)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="826.5" y="2145.7617"/><path d="M114,116.9531 L114,156.9531 L380,156.9531 L380,126.9531 L370,116.9531 L114,116.9531 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M370,116.9531 L370,126.9531 L380,126.9531 L370,116.9531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="132.5" y="134.5215">Payer FSP sends request for quote</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="132.5" y="149.832">to Payee FSP via the Switch</text><polygon fill="#A80036" points="330.5,183.8848,340.5,187.8848,330.5,187.8848" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="152.5" x2="341.5" y1="187.8848" y2="187.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="159.5" y="183.1426">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="172.5" y="183.1426">POST /quotes</text><path d="M347,200.8848 L347,271.8848 L576,271.8848 L576,210.8848 L566,200.8848 L347,200.8848 " fill="#AAAAAA" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M566,200.8848 L566,210.8848 L576,210.8848 L566,200.8848 " fill="#AAAAAA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="353" y="218.4531">Validate request against</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="353" y="233.7637">Mojaloop interface specification</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="353" y="249.0742">Error code: 300x, 310x</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="353" y="264.3848">HTTP error response code: 4xx</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="302.4375" y2="302.4375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="302.4375" y2="315.4375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="315.4375" y2="315.4375"/><polygon fill="#A80036" points="353.5,311.4375,343.5,315.4375,353.5,319.4375,349.5,315.4375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="297.6953">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="362.5" y="297.6953">Schema validation</text><polygon fill="#A80036" points="163.5,345.748,153.5,345.748,163.5,349.748" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="152.5" x2="341.5" y1="344.748" y2="344.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="169.5" y="340.0059">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="182.5" y="340.0059">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="399.0586" y2="399.0586"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="399.0586" y2="412.0586"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="412.0586" y2="412.0586"/><polygon fill="#A80036" points="353.5,408.0586,343.5,412.0586,353.5,416.0586,349.5,412.0586" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="394.3164">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="271" x="362.5" y="394.3164">Quote request validation (rules engine etc.)</text><path d="M55,452.0586 L117,452.0586 L117,459.0586 L107,469.0586 L55,469.0586 L55,452.0586 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="529.9238" style="stroke: #000000; stroke-width: 2.0;" width="866" x="55" y="452.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="70" y="465.627">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="188" x="132" y="464.6934">[SimpleRoutingMode === FALSE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="490.6797" y2="490.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="490.6797" y2="503.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="503.6797" y2="503.6797"/><polygon fill="#A80036" points="353.5,499.6797,343.5,503.6797,353.5,507.6797,349.5,503.6797" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="485.9375">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="362.5" y="485.9375">Duplicate check</text><path d="M65,543.6797 L127,543.6797 L127,550.6797 L117,560.6797 L65,560.6797 L65,543.6797 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="237.8184" style="stroke: #000000; stroke-width: 2.0;" width="506.5" x="65" y="543.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="80" y="557.248">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="226" x="142" y="556.3145">[Request is a duplicate but not a resend]</text><path d="M75,590.9902 L75,630.9902 L333,630.9902 L333,600.9902 L323,590.9902 L75,590.9902 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,590.9902 L323,600.9902 L333,600.9902 L323,590.9902 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="81" y="608.5586">Switch returns error back to Payer FSP</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="81" y="623.8691">Error code: 3106</text><polygon fill="#A80036" points="163.5,657.9219,153.5,661.9219,163.5,661.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="152.5" x2="341.5" y1="661.9219" y2="661.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="169.5" y="657.1797">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="182.5" y="657.1797">PUT /quotes/{ID}/error</text><polygon fill="#A80036" points="330.5,692.2324,340.5,692.2324,330.5,696.2324" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="152.5" x2="341.5" y1="691.2324" y2="691.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="159.5" y="686.4902">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="172.5" y="686.4902">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="65" x2="571.5" y1="725.2324" y2="725.2324"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="70" y="735.8672">[Request is a duplicate and a resend]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="760.498" y2="760.498"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="760.498" y2="773.498"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="773.498" y2="773.498"/><polygon fill="#A80036" points="353.5,769.498,343.5,773.498,353.5,777.498,349.5,773.498" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="755.7559">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="362.5" y="755.7559">Switch handles resend scenario</text><polygon fill="#A80036" points="814.5,830.8086,824.5,834.8086,814.5,834.8086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="825.5" y1="834.8086" y2="834.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="349.5" y="830.0664">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="362.5" y="830.0664">Persist quote request</text><polygon fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" points="762,847.8086,901,847.8086,911,896.8086,901,946.8086,762,946.8086,752,896.8086,762,847.8086" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="764" y="864.377">quoteDuplicateCheck</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="764" y="879.6875">transactionReference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="764" y="894.998">quote</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="764" y="910.3086">quoteParty</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="764" y="925.6191">quoteExtension</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="764" y="940.9297">geoCode</text><polygon fill="#A80036" points="353.5,974.9824,343.5,974.9824,353.5,978.9824" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="830.5" y1="973.9824" y2="973.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="969.2402">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="381.5" y="969.2402">Quote request saved</text><path d="M293,1020.9824 L355,1020.9824 L355,1027.9824 L345,1037.9824 L293,1037.9824 L293,1020.9824 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="116.8867" style="stroke: #000000; stroke-width: 2.0;" width="543.5" x="293" y="1020.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="308" y="1034.5508">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="186" x="370" y="1033.6172">[SimpleRoutingMode === TRUE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1059.6035" y2="1059.6035"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1059.6035" y2="1072.6035"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1072.6035" y2="1072.6035"/><polygon fill="#A80036" points="353.5,1068.6035,343.5,1072.6035,353.5,1076.6035,349.5,1072.6035" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1054.8613">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="453" x="371.5" y="1054.8613">Use fspiop-destination header to retrieve quotes endpoint for Payee FSP</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="293" x2="836.5" y1="1081.6035" y2="1081.6035"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="188" x="298" y="1092.2383">[SimpleRoutingMode === FALSE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1116.8691" y2="1116.8691"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1116.8691" y2="1129.8691"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1129.8691" y2="1129.8691"/><polygon fill="#A80036" points="353.5,1125.8691,343.5,1129.8691,353.5,1133.8691,349.5,1129.8691" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1112.127">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="367" x="371.5" y="1112.127">Retireve Payee FSP endpoint using quote party information</text><path d="M12,1176.8691 L74,1176.8691 L74,1183.8691 L64,1193.8691 L12,1193.8691 L12,1176.8691 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1279.6426" style="stroke: #000000; stroke-width: 2.0;" width="1209" x="12" y="1176.8691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="27" y="1190.4375">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="89" y="1189.5039">[Payee quotes endpoint found]</text><path d="M347,1199.1797 L347,1224.1797 L640,1224.1797 L640,1209.1797 L630,1199.1797 L347,1199.1797 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M630,1199.1797 L630,1209.1797 L640,1209.1797 L630,1199.1797 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="353" y="1216.748">Switch forwards quote request to Payee FSP</text><polygon fill="#A80036" points="920,1250.8008,930,1254.8008,920,1254.8008" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="931" y1="1254.8008" y2="1254.8008"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1250.0586">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="371.5" y="1250.0586">POST /quotes</text><polygon fill="#A80036" points="353.5,1285.1113,343.5,1285.1113,353.5,1289.1113" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="931" y1="1284.1113" y2="1284.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1279.3691">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="381.5" y="1279.3691">202 OK</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="932" x2="974" y1="1313.4219" y2="1313.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="974" x2="974" y1="1313.4219" y2="1326.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="933" x2="974" y1="1326.4219" y2="1326.4219"/><polygon fill="#A80036" points="943,1322.4219,933,1326.4219,943,1330.4219,939,1326.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="939" y="1308.6797">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="961" y="1308.6797">Payee FSP presists and calculates quote</text><path d="M22,1341.4219 L84,1341.4219 L84,1348.4219 L74,1358.4219 L22,1358.4219 L22,1341.4219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="979.8926" style="stroke: #000000; stroke-width: 2.0;" width="982.5" x="22" y="1341.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="37" y="1354.9902">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="99" y="1354.0566">[Payee quotes processing successful]</text><path d="M496,1363.7324 L496,1388.7324 L923,1388.7324 L923,1373.7324 L913,1363.7324 L496,1363.7324 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M913,1363.7324 L913,1373.7324 L923,1373.7324 L913,1363.7324 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="502" y="1381.3008">Payee FSP sends quote response back to Payer FSP via the Switch</text><polygon fill="#A80036" points="353.5,1415.3535,343.5,1419.3535,353.5,1419.3535" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="931" y1="1419.3535" y2="1419.3535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1414.6113">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="381.5" y="1414.6113">PUT /quotes/{ID}</text><polygon fill="#A80036" points="920,1449.6641,930,1449.6641,920,1453.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="931" y1="1448.6641" y2="1448.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1443.9219">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="371.5" y="1443.9219">200 OK</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1477.9746" y2="1477.9746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1477.9746" y2="1490.9746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1490.9746" y2="1490.9746"/><polygon fill="#A80036" points="353.5,1486.9746,343.5,1490.9746,353.5,1494.9746,349.5,1490.9746" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1473.2324">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="371.5" y="1473.2324">Validate quote response</text><path d="M283,1505.9746 L345,1505.9746 L345,1512.9746 L335,1522.9746 L283,1522.9746 L283,1505.9746 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="376.3477" style="stroke: #000000; stroke-width: 2.0;" width="711.5" x="283" y="1505.9746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="298" y="1519.543">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="188" x="360" y="1518.6094">[SimpleRoutingMode === FALSE]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1544.5957" y2="1544.5957"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1544.5957" y2="1557.5957"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1557.5957" y2="1557.5957"/><polygon fill="#A80036" points="353.5,1553.5957,343.5,1557.5957,353.5,1561.5957,349.5,1557.5957" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1539.8535">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="371.5" y="1539.8535">Duplicate check</text><path d="M293,1572.5957 L355,1572.5957 L355,1579.5957 L345,1589.5957 L293,1589.5957 L293,1572.5957 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.9316" style="stroke: #000000; stroke-width: 2.0;" width="691.5" x="293" y="1572.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="308" y="1586.1641">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="225" x="370" y="1585.2305">[Response is duplicate but not a resend]</text><polygon fill="#A80036" points="920,1607.2168,930,1611.2168,920,1611.2168" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="931" y1="1611.2168" y2="1611.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1606.4746">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="371.5" y="1606.4746">PUT /quotes/{ID}/error</text><polygon fill="#A80036" points="353.5,1641.5273,343.5,1641.5273,353.5,1645.5273" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="931" y1="1640.5273" y2="1640.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1635.7852">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="381.5" y="1635.7852">200 OK</text><path d="M293,1662.5273 L355,1662.5273 L355,1669.5273 L345,1679.5273 L293,1679.5273 L293,1662.5273 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="297" x="293" y="1662.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="308" y="1676.0957">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="370" y="1675.1621">[Response is a duplicate and a resend]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="384.5" y1="1701.1484" y2="1701.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="384.5" x2="384.5" y1="1701.1484" y2="1714.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="384.5" y1="1714.1484" y2="1714.1484"/><polygon fill="#A80036" points="353.5,1710.1484,343.5,1714.1484,353.5,1718.1484,349.5,1714.1484" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1696.4063">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="371.5" y="1696.4063">Switch handles resend scenario</text><polygon fill="#A80036" points="814.5,1746.459,824.5,1750.459,814.5,1750.459" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="825.5" y1="1750.459" y2="1750.459"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="1745.7168">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="371.5" y="1745.7168">Persist quote response</text><polygon fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" points="753,1763.459,910,1763.459,920,1805.459,910,1847.459,753,1847.459,743,1805.459,753,1763.459" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="755" y="1780.0273">quoteResponse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="755" y="1795.3379">quoteDuplicateCheck</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="755" y="1810.6484">quoteResponseIlpPacket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="755" y="1825.959">geoCode</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="755" y="1841.2695">quoteExtension</text><polygon fill="#A80036" points="353.5,1875.3223,343.5,1875.3223,353.5,1879.3223" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="830.5" y1="1874.3223" y2="1874.3223"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1869.5801">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="381.5" y="1869.5801">Quote response saved</text><path d="M32,1894.3223 L32,1919.3223 L333,1919.3223 L333,1904.3223 L323,1894.3223 L32,1894.3223 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,1894.3223 L323,1904.3223 L333,1904.3223 L323,1894.3223 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="38" y="1911.8906">Switch forwards quote response to Payer FSP</text><polygon fill="#A80036" points="163.5,1945.9434,153.5,1949.9434,163.5,1949.9434" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="152.5" x2="341.5" y1="1949.9434" y2="1949.9434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="169.5" y="1945.2012">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="191.5" y="1945.2012">PUT /quotes/{ID}</text><polygon fill="#A80036" points="330.5,1980.2539,340.5,1980.2539,330.5,1984.2539" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="152.5" x2="341.5" y1="1979.2539" y2="1979.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="159.5" y="1974.5117">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="181.5" y="1974.5117">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="22" x2="1004.5" y1="1988.2539" y2="1988.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="258" x="27" y="1998.8887">[Payee rejects quotes or encounters and error]</text><path d="M541,2007.209 L541,2032.209 L923,2032.209 L923,2017.209 L913,2007.209 L541,2007.209 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M913,2007.209 L913,2017.209 L923,2017.209 L913,2007.209 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="361" x="547" y="2024.7773">Payee FSP sends error callback to Payer FSP via the Switch</text><polygon fill="#A80036" points="353.5,2058.8301,343.5,2062.8301,353.5,2062.8301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="931" y1="2062.8301" y2="2062.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="2058.0879">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="381.5" y="2058.0879">PUT /quotes/{ID}/error</text><polygon fill="#A80036" points="920,2093.1406,930,2093.1406,920,2097.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="931" y1="2092.1406" y2="2092.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="2087.3984">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="371.5" y="2087.3984">200 OK</text><path d="M293,2107.1406 L355,2107.1406 L355,2114.1406 L345,2124.1406 L293,2124.1406 L293,2107.1406 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="109.2422" style="stroke: #000000; stroke-width: 2.0;" width="596.5" x="293" y="2107.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="308" y="2120.709">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="188" x="370" y="2119.7754">[SimpleRoutingMode === FALSE]</text><polygon fill="#A80036" points="814.5,2141.7617,824.5,2145.7617,814.5,2145.7617" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="825.5" y1="2145.7617" y2="2145.7617"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="349.5" y="2141.0195">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="371.5" y="2141.0195">Store quote error</text><polygon fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" points="796,2158.7617,866,2158.7617,876,2169.7617,866,2181.7617,796,2181.7617,786,2169.7617,796,2158.7617" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="798" y="2175.3301">quoteError</text><polygon fill="#A80036" points="353.5,2209.3828,343.5,2209.3828,353.5,2213.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="830.5" y1="2208.3828" y2="2208.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="2203.6406">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="381.5" y="2203.6406">Quote error saved</text><path d="M43,2228.3828 L43,2253.3828 L333,2253.3828 L333,2238.3828 L323,2228.3828 L43,2228.3828 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,2228.3828 L323,2238.3828 L333,2238.3828 L323,2228.3828 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="49" y="2245.9512">Switch forwards error callback to Payer FSP</text><polygon fill="#A80036" points="163.5,2280.0039,153.5,2284.0039,163.5,2284.0039" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="152.5" x2="341.5" y1="2284.0039" y2="2284.0039"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="169.5" y="2279.2617">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="191.5" y="2279.2617">PUT /quotes/{ID}/error</text><polygon fill="#A80036" points="330.5,2314.3145,340.5,2314.3145,330.5,2318.3145" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="152.5" x2="341.5" y1="2313.3145" y2="2313.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="159.5" y="2308.5723">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="181.5" y="2308.5723">200 OK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="12" x2="1221" y1="2329.3145" y2="2329.3145"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="17" y="2339.9492">[Payee FSP quotes endpoint not found]</text><path d="M38,2348.2695 L38,2388.2695 L333,2388.2695 L333,2358.2695 L323,2348.2695 L38,2348.2695 " fill="#FBFB77" filter="url(#f1d9z4o69qkw63)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323,2348.2695 L323,2358.2695 L333,2358.2695 L323,2348.2695 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="270" x="44" y="2365.8379">Switch sends an error callback to Payer FSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="48" y="2381.1484"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="48" y="2381.1484">Error code: 3201</text><polygon fill="#A80036" points="163.5,2415.2012,153.5,2419.2012,163.5,2419.2012" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="152.5" x2="341.5" y1="2419.2012" y2="2419.2012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="169.5" y="2414.459">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="191.5" y="2414.459">PUT /quotes/{ID}/error</text><polygon fill="#A80036" points="330.5,2444.5117,340.5,2448.5117,330.5,2448.5117" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="152.5" x2="341.5" y1="2448.5117" y2="2448.5117"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="159.5" y="2443.7695">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="181.5" y="2443.7695">200 OK</text><!--
@startuml
Title Request Quote Creation
participant "Payer FSP" as PayerFSP
participant "Switch\n[Quoting\nService]" as Switch
database "Central Store" as DB
participant "Payee FSP" as PayeeFSP
autonumber

note over PayerFSP, Switch: Payer FSP sends request for quote \nto Payee FSP via the Switch
PayerFSP -\ Switch: POST /quotes
note right of Switch #aaa
    Validate request against 
    Mojaloop interface specification
    **<color #red>Error code: 300x, 310x</color>**
    **<color #red>HTTP error response code: 4xx</color>**
end note
Switch -> Switch: Schema validation
PayerFSP \- - Switch: 202 Accepted
|||
Switch -> Switch: Quote request validation (rules engine etc.)
|||
alt SimpleRoutingMode === FALSE
    Switch -> Switch: Duplicate check
    |||
    alt Request is a duplicate but not a resend
    |||
        note left of Switch
            Switch returns error back to Payer FSP
            <color #red>**Error code: 3106**</color>
        end note
        PayerFSP /- Switch: PUT /quotes/{ID}/error
        PayerFSP - -/ Switch: 200 OK
    |||
    else Request is a duplicate and a resend
        Switch -> Switch: Switch handles resend scenario
    end
    |||
    Switch -\ DB: Persist quote request
    activate DB
        hnote over DB
            quoteDuplicateCheck
            transactionReference
            quote
            quoteParty
            quoteExtension
            geoCode
        end hnote
    Switch \- - DB: Quote request saved
    deactivate DB
end
|||
alt SimpleRoutingMode === TRUE
    Switch -> Switch: Use fspiop-destination header to retrieve quotes endpoint for Payee FSP
else SimpleRoutingMode === FALSE
    Switch -> Switch: Retireve Payee FSP endpoint using quote party information
end
|||
alt Payee quotes endpoint found
    note right of Switch: Switch forwards quote request to Payee FSP
    Switch -\ PayeeFSP: POST /quotes
    Switch \- - PayeeFSP: 202 OK

    PayeeFSP -> PayeeFSP: Payee FSP presists and calculates quote
    alt Payee quotes processing successful
        note left of PayeeFSP: Payee FSP sends quote response back to Payer FSP via the Switch
        Switch /- PayeeFSP: PUT /quotes/{ID}
        Switch - -/ PayeeFSP: 200 OK

        Switch -> Switch: Validate quote response
        alt SimpleRoutingMode === FALSE
            Switch -> Switch: Duplicate check
            alt Response is duplicate but not a resend
                Switch -\ PayeeFSP: PUT /quotes/{ID}/error
                Switch \- - PayeeFSP: 200 OK
            end
            alt Response is a duplicate and a resend
                Switch -> Switch: Switch handles resend scenario
            end
            Switch -\ DB: Persist quote response
            activate DB
            hnote over DB
                quoteResponse
                quoteDuplicateCheck
                quoteResponseIlpPacket
                geoCode
                quoteExtension
            end hnote
            Switch \- - DB: Quote response saved
            deactivate DB
        end
        note left of Switch: Switch forwards quote response to Payer FSP
        PayerFSP /- Switch: PUT /quotes/{ID}
        PayerFSP - -/ Switch: 200 OK
    else Payee rejects quotes or encounters and error
        note left of PayeeFSP: Payee FSP sends error callback to Payer FSP via the Switch
        Switch /- PayeeFSP: PUT /quotes/{ID}/error
        Switch - -/ PayeeFSP: 200 OK
        alt SimpleRoutingMode === FALSE
            Switch -\ DB: Store quote error
            activate DB
            hnote over DB
                quoteError
            end hnote
            Switch \- - DB: Quote error saved
            deactivate DB
        end
        note left of Switch: Switch forwards error callback to Payer FSP
        PayerFSP /- Switch: PUT /quotes/{ID}/error
        PayerFSP - -/ Switch: 200 OK
    end
else Payee FSP quotes endpoint not found
    note left of Switch: Switch sends an error callback to Payer FSP \n <color #red>**Error code: 3201**</color>
    PayerFSP /- Switch: PUT /quotes/{ID}/error
    PayerFSP - -\ Switch: 200 OK
end

@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>