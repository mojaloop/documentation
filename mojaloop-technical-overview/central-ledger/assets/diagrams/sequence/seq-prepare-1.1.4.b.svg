<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="907px" preserveAspectRatio="none" style="width:2247px;height:907px;" version="1.1" viewBox="0 0 2247 907" width="2247px" zoomAndPan="magnify"><defs><filter height="300%" id="fywqtlp3ebqf9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="512" x="868.5" y="23.5352">1.1.4.b. Send notification to Participant (Payer/Payee) (batch messages)</text><rect fill="#D3D3D3" height="862.1641" style="stroke: #A80036; stroke-width: 1.0;" width="179" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="7" y="47.0566">Financial Service Provider</text><rect fill="#ADD8E6" height="862.1641" style="stroke: #A80036; stroke-width: 1.0;" width="241" x="659" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="701" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="862.1641" style="stroke: #A80036; stroke-width: 1.0;" width="1039.5" x="1167" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1636.25" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="619.9004" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="774.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239.5" y="209.3965"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1390" y="317.3281"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="179.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1390" y="552.502"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="140.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1594" y="346.6387"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1826.5" y="581.8125"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="173.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2149.5" y="611.123"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="605.9004" style="stroke: #000000; stroke-width: 2.0;" width="2202" x="34" y="170.7754"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="515.2793" style="stroke: #000000; stroke-width: 2.0;" width="2182" x="44" y="254.3965"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="1008.5" x="653" y="278.707"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="779" x2="779" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1244" x2="1244" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1395" x2="1395" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1598.5" x2="1598.5" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1711.5" x2="1711.5" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1831.5" x2="1831.5" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2154.5" x2="2154.5" y1="153.7754" y2="793.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="134.334">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="150.8223">Participant</text><ellipse cx="93.5" cy="63.7988" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,71.7988 L93.5,98.7988 M80.5,79.7988 L106.5,79.7988 M93.5,98.7988 L80.5,113.7988 M93.5,98.7988 L106.5,113.7988 " fill="none" filter="url(#fywqtlp3ebqf9)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="806.2109">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="822.6992">Participant</text><ellipse cx="93.5" cy="835.6523" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,843.6523 L93.5,870.6523 M80.5,851.6523 L106.5,851.6523 M93.5,870.6523 L80.5,885.6523 M93.5,870.6523 L106.5,885.6523 " fill="none" filter="url(#fywqtlp3ebqf9)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="663" y="150.8223">ML API Notification Event Handler</text><ellipse cx="779.5" cy="121.2871" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="775.5,109.2871,781.5,104.2871,779.5,109.2871,781.5,114.2871,775.5,109.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="663" y="806.2109">ML API Notification Event Handler</text><ellipse cx="779.5" cy="825.1641" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="775.5,813.1641,781.5,808.1641,779.5,813.1641,781.5,818.1641,775.5,813.1641" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1175" y="114.2871"/><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1171" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1178" y="138.8223">Notification-Topic</text><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1175" y="792.6758"/><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1171" y="796.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1178" y="817.2109">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1328" y="150.8223">Central Service API</text><path d="M1374.5,109.2871 L1374.5,133.2871 M1374.5,121.2871 L1391.5,121.2871 " fill="none" filter="url(#fywqtlp3ebqf9)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1403.5" cy="121.2871" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1328" y="806.2109">Central Service API</text><path d="M1374.5,813.1641 L1374.5,837.1641 M1374.5,825.1641 L1391.5,825.1641 " fill="none" filter="url(#fywqtlp3ebqf9)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1403.5" cy="825.1641" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1550.5" y="114.2871"/><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1546.5" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1553.5" y="138.8223">Event-Topic</text><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1550.5" y="792.6758"/><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1546.5" y="796.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1553.5" y="817.2109">Event-Topic</text><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="1661.5" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1668.5" y="138.8223">EVENT_DAO</text><rect fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="1661.5" y="792.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1668.5" y="813.2109">EVENT_DAO</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1771.5" y="150.8223">Notification DAO</text><ellipse cx="1831.5" cy="121.2871" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1819.5" x2="1843.5" y1="135.2871" y2="135.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1771.5" y="806.2109">Notification DAO</text><ellipse cx="1831.5" cy="825.1641" fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1819.5" x2="1843.5" y1="839.1641" y2="839.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="2106.5" y="150.8223">Central Store</text><path d="M2136.5,101.2871 C2136.5,91.2871 2154.5,91.2871 2154.5,91.2871 C2154.5,91.2871 2172.5,91.2871 2172.5,101.2871 L2172.5,127.2871 C2172.5,137.2871 2154.5,137.2871 2154.5,137.2871 C2154.5,137.2871 2136.5,137.2871 2136.5,127.2871 L2136.5,101.2871 " fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M2136.5,101.2871 C2136.5,111.2871 2154.5,111.2871 2154.5,111.2871 C2154.5,111.2871 2172.5,111.2871 2172.5,101.2871 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="2106.5" y="806.2109">Central Store</text><path d="M2136.5,819.1641 C2136.5,809.1641 2154.5,809.1641 2154.5,809.1641 C2154.5,809.1641 2172.5,809.1641 2172.5,819.1641 L2172.5,845.1641 C2172.5,855.1641 2154.5,855.1641 2154.5,855.1641 C2154.5,855.1641 2136.5,855.1641 2136.5,845.1641 L2136.5,819.1641 " fill="#FEFECE" filter="url(#fywqtlp3ebqf9)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M2136.5,819.1641 C2136.5,829.1641 2154.5,829.1641 2154.5,829.1641 C2154.5,829.1641 2172.5,829.1641 2172.5,819.1641 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="619.9004" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="774.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239.5" y="209.3965"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1390" y="317.3281"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="179.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1390" y="552.502"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="140.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1594" y="346.6387"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1826.5" y="581.8125"/><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="173.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2149.5" y="611.123"/><path d="M34,170.7754 L286,170.7754 L286,177.7754 L276,187.7754 L34,187.7754 L34,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="605.9004" style="stroke: #000000; stroke-width: 2.0;" width="2202" x="34" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="49" y="184.3438">Send notification to Participant</text><polygon fill="#A80036" points="1227.5,205.3965,1237.5,209.3965,1227.5,213.3965,1231.5,209.3965" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="784.5" x2="1233.5" y1="209.3965" y2="209.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="791.5" y="204.6543">1</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="423" x="804.5" y="204.6543">Consume Notifications event batch of messages for Participant</text><path d="M44,254.3965 L118,254.3965 L118,261.3965 L108,271.3965 L44,271.3965 L44,254.3965 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="515.2793" style="stroke: #000000; stroke-width: 2.0;" width="2182" x="44" y="254.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="59" y="267.9648">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="133" y="267.0313">[for each message in batch]</text><path d="M653,278.707 L868,278.707 L868,285.707 L858,295.707 L653,295.707 L653,278.707 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="1008.5" x="653" y="278.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="668" y="292.2754">Persist Event Information</text><polygon fill="#A80036" points="1378,313.3281,1388,317.3281,1378,321.3281,1382,317.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="784.5" x2="1384" y1="317.3281" y2="317.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="791.5" y="312.5859">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="342" x="804.5" y="312.5859">Request to persist event information - POST - /events</text><polygon fill="#A80036" points="1582,342.6387,1592,346.6387,1582,350.6387,1586,346.6387" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1400" x2="1588" y1="346.6387" y2="346.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1407" y="341.8965">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1420" y="341.8965">Publish event information</text><rect fill="#FFFFFF" filter="url(#fywqtlp3ebqf9)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="158" x="1543.5" y="379.6387"/><polygon fill="#EEEEEE" points="1543.5,379.6387,1607.5,379.6387,1607.5,386.6387,1597.5,396.6387,1543.5,396.6387,1543.5,379.6387" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1556.5" y="394.207">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="1549.5" y="413.207">Event Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1553.5" y="428.5176"/><polygon fill="#A80036" points="1411,482.8809,1401,486.8809,1411,490.8809,1407,486.8809" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1405" x2="1598" y1="486.8809" y2="486.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1417" y="482.1387">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1430" y="482.1387">Return success</text><polygon fill="#A80036" points="795.5,512.1914,785.5,516.1914,795.5,520.1914,791.5,516.1914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="789.5" x2="1394" y1="516.1914" y2="516.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="801.5" y="511.4492">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="814.5" y="511.4492">Return success</text><polygon fill="#A80036" points="1378,548.502,1388,552.502,1378,556.502,1382,552.502" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="784.5" x2="1384" y1="552.502" y2="552.502"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="791.5" y="547.7598">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="804.5" y="547.7598">Request Notifications details for Participant - GET - /notifications/DFPS(n)</text><polygon fill="#A80036" points="1814.5,577.8125,1824.5,581.8125,1814.5,585.8125,1818.5,581.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1400" x2="1820.5" y1="581.8125" y2="581.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1407" y="577.0703">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="1420" y="577.0703">Fetch Notifications details for Participant</text><polygon fill="#A80036" points="2137.5,607.123,2147.5,611.123,2137.5,615.123,2141.5,611.123" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1836.5" x2="2143.5" y1="611.123" y2="611.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1843.5" y="606.3809">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="1856.5" y="606.3809">Fetch Notifications details for Participant</text><polygon fill="#FFFFE0" filter="url(#fywqtlp3ebqf9)" points="2102,624.123,2206,624.123,2216,635.123,2206,647.123,2102,647.123,2092,635.123,2102,624.123" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="2104" y="640.6914">transferPosition</text><polygon fill="#A80036" points="1847.5,669.7441,1837.5,673.7441,1847.5,677.7441,1843.5,673.7441" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1841.5" x2="2148.5" y1="673.7441" y2="673.7441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1853.5" y="669.002">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="1866.5" y="669.002">Retrieved Notification details for Participant</text><polygon fill="#A80036" points="1411,699.0547,1401,703.0547,1411,707.0547,1407,703.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1405" x2="1830.5" y1="703.0547" y2="703.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1417" y="698.3125">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="1439" y="698.3125">Return Notifications details for Participant</text><polygon fill="#A80036" points="795.5,728.3652,785.5,732.3652,795.5,736.3652,791.5,732.3652" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="789.5" x2="1394" y1="732.3652" y2="732.3652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="801.5" y="727.623">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="823.5" y="727.623">Return Notifications details for Participant</text><polygon fill="#A80036" points="104.5,757.6758,94.5,761.6758,104.5,765.6758,100.5,761.6758" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="98.5" x2="773.5" y1="761.6758" y2="761.6758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="110.5" y="756.9336">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="589" x="132.5" y="756.9336">Callback with Prepare result to Participant to specified URL - PUT - /&lt;dfsp-host&gt;&gt;/transfers</text><!--
@startuml
title 1.1.4.b. Send notification to Participant (Payer/Payee) (batch messages)

autonumber


actor "DFSP(n)\nParticipant" as DFSP
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Notification-Topic" as TOPIC_NOTIFICATIONS
collections "Event-Topic" as TOPIC_EVENTS
entity "Notification DAO" as NOTIFY_DAO
database "Central Store" as DB

box "Financial Service Provider" #lightGray
	participant DFSP
end box

box "ML API Adapter Service" #LightBlue
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
participant TOPIC_NOTIFICATIONS
    participant CSAPI
    participant TOPIC_EVENTS
    participant EVENT_DAO
    participant NOTIFY_DAO
    participant DB
end box

activate NOTIFY_HANDLER
group Send notification to Participant
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: <color #FF0000>**Consume Notifications event batch of messages for Participant**</color>
    activate TOPIC_NOTIFICATIONS
    deactivate TOPIC_NOTIFICATIONS
    loop for each message in batch
        group Persist Event Information
            NOTIFY_HANDLER -> CSAPI: Request to persist event information - POST - /events
            activate CSAPI
            CSAPI -> TOPIC_EVENTS: Publish event information
            activate TOPIC_EVENTS
            |||
            ref over TOPIC_EVENTS :  Event Handler Consume\n
            |||
            TOPIC_EVENTS - -> CSAPI: Return success
            deactivate TOPIC_EVENTS
            CSAPI - -> NOTIFY_HANDLER: Return success
            deactivate CSAPI
        end
        NOTIFY_HANDLER -> CSAPI: Request Notifications details for Participant - GET - /notifications/DFPS(n)
        activate CSAPI
        CSAPI -> NOTIFY_DAO: Fetch Notifications details for Participant
        activate NOTIFY_DAO
        NOTIFY_DAO -> DB: Fetch Notifications details for Participant
        activate DB
        hnote over DB #lightyellow
            transferPosition
        end note
        DB - -> NOTIFY_DAO: Retrieved Notification details for Participant
        NOTIFY_DAO - -> CSAPI: Return Notifications details for Participant
        deactivate NOTIFY_DAO
        CSAPI - -> NOTIFY_HANDLER: Return Notifications details for Participant
        deactivate CSAPI
        NOTIFY_HANDLER - -> DFSP: Callback with Prepare result to Participant to specified URL - PUT - /<dfsp-host>>/transfers
    end
end
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>