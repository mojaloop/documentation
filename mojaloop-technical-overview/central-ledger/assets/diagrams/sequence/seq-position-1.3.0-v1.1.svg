<svg xmlns="http://www.w3.org/2000/svg" height="1684" preserveAspectRatio="none" style="width:1186px;height:1684px" width="1186">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="488" x="347" y="28.708">
    1.3.0. Position Handler Consume (single message) v1.1
  </text>
  <path fill="#FFFFE0" stroke="#a80036" d="M26 40.953h1130v1637.313H26z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="535.5" y="53.02">
    Central Service
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M112 187.781h10v30h-10zM112 666.445h10v30h-10zM112 1145.109h10v30h-10zM436 118.383h10v1498.586h-10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M10 125.383h1162v1484.586H10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M20 149.516h1142v1453.453H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M362 232.781h535v105.531H362z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M372 256.914h515v74.398H372zM372 352.313h639v156.664H372z"/>
  <path fill="#FFF" d="M20 630.508h1142v478.664H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M362 711.445h597v105.531H362z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M372 735.578h577v74.398H372zM372 830.977h639v156.664H372z"/>
  <path fill="#FFF" d="M20 1109.172h1142v493.797H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M362 1190.109h415v120.664H362z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M372 1214.242h395v89.531H372zM372 1324.773h639v156.664H372z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M117 108.383v1518.586M441 108.383v1518.586M949 108.383v1518.586M1081 108.383v1518.586"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M34 69.086h166v30.297H34z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M30 73.086h166v30.297H30z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="37" y="93.081">
    topic-transfer-position
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M34 1625.969h166v30.297H34z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M30 1629.969h166v30.297H30z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="37" y="1649.964">
    topic-transfer-position
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="382" y="105.081">
    Position Handler
  </text>
  <circle cx="441" cy="76.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M437 64.086l6-5-2 5 2 5-6-5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="382" y="1638.964">
    Position Handler
  </text>
  <circle cx="441" cy="1658.266" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M437 1646.266l6-5-2 5 2 5-6-5z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M901 69.086h96v30.297h-96z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M897 73.086h96v30.297h-96z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="904" y="93.081">
    Event-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M901 1625.969h96v30.297h-96z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M897 1629.969h96v30.297h-96z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="904" y="1649.964">
    Event-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1015 69.086h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1011 73.086h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1018" y="93.081">
    Notification-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1015 1625.969h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1011 1629.969h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1018" y="1649.964">
    Notification-Topic
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M112 187.781h10v30h-10zM112 666.445h10v30h-10zM112 1145.109h10v30h-10zM436 118.383h10v1498.586h-10z"/>
  <path d="M10 125.383h240v7l-10 10H10v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M10 125.383h1162v1484.586H10z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="195" x="25" y="138.45">
    Position Handler Consume
  </text>
  <path d="M20 149.516h64v7l-10 10H20v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M20 149.516h1142v1453.453H20z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="35" y="162.583">
    alt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="246" x="99" y="161.726">
    [Consume Prepare message for Payer]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M133 183.781l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M127 187.781h308"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139" y="182.715">
    1
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="152" y="182.715">
    Consume Position event message for Payer
  </text>
  <path d="M362 232.781h88v7l-10 10h-78v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M362 232.781h535v105.531H362z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="377" y="245.848">
    break
  </text>
  <path d="M372 256.914h152v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 256.914h515v74.398H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="387" y="269.981">
    Validate Event
  </text>
  <path stroke="#a80036" d="M446 310.313h42M488 310.313v13M447 323.313h41"/>
  <path fill="#A80036" stroke="#a80036" d="M457 319.313l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="297.68">
    2
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="409" x="466" y="290.114">
    Validate event - Rule: type == &apos;position&apos; &amp;&amp; action == &apos;prepare&apos;
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="466" y="305.247">
    Error codes:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="560" y="305.247">
    2001
  </text>
  <path d="M372 352.313h232v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 352.313h639v156.664H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="387" y="365.379">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M937 411.578l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 415.578h497"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="410.512">
    3
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="466" y="410.512">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 423.578h621v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 423.578h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="437.645">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="614" y="456.645">
    Event Handler Consume
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 540.977h231v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 540.977h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="555.043">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="385" y="574.043">
    Prepare Position Handler Consume
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1069.5 618.508l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 622.508h629.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="617.442">
    4
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="466" y="617.442">
    Produce message
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M20 631.508h1142"/>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="25" y="641.718">
    [Consume Fulfil message for Payee]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M133 662.445l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M127 666.445h308"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139" y="661.379">
    5
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="282" x="152" y="661.379">
    Consume Position event message for Payee
  </text>
  <path d="M362 711.445h88v7l-10 10h-78v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M362 711.445h597v105.531H362z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="377" y="724.512">
    break
  </text>
  <path d="M372 735.578h152v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 735.578h577v74.398H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="387" y="748.645">
    Validate Event
  </text>
  <path stroke="#a80036" d="M446 788.977h42M488 788.977v13M447 801.977h41"/>
  <path fill="#A80036" stroke="#a80036" d="M457 797.977l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="776.344">
    6
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="471" x="466" y="768.778">
    Validate event - Rule: type == &apos;position&apos; &amp;&amp; action IN [&apos;commit&apos;, &apos;reserve&apos;]
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="466" y="783.911">
    Error codes:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="560" y="783.911">
    2001
  </text>
  <path d="M372 830.977h232v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 830.977h639v156.664H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="387" y="844.043">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M937 890.242l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 894.242h497"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="889.176">
    7
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="466" y="889.176">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 902.242h621v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 902.242h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="916.309">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="614" y="935.309">
    Event Handler Consume
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 1019.641h209v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 1019.64h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="1033.707">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="385" y="1052.707">
    Fulfil Position Handler Consume
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1069.5 1097.172l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 1101.172h629.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="453" y="1096.106">
    8
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="466" y="1096.106">
    Produce message
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M20 1110.172h1142"/>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="25" y="1120.382">
    [Consume Abort message]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M133 1141.11l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M127 1145.109h308"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="139" y="1140.043">
    9
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="152" y="1140.043">
    Consume Position event message
  </text>
  <path d="M362 1190.11h88v7l-10 10h-78v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M362 1190.109h415v120.664H362z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="377" y="1203.176">
    break
  </text>
  <path d="M372 1214.242h152v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 1214.242h395v89.531H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="387" y="1227.309">
    Validate Event
  </text>
  <path stroke="#a80036" d="M446 1282.773h42M488 1282.773v13M447 1295.773h41"/>
  <path fill="#A80036" stroke="#a80036" d="M457 1291.773l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="453" y="1262.575">
    10
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="475" y="1247.442">
    Validate event - Rule: type == &apos;position&apos; &amp;&amp;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="475" y="1262.575">
    action IN [&apos;timeout-reserved&apos;, &apos;reject&apos;, &apos;fail&apos;]
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="475" y="1277.707">
    Error codes:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="569" y="1277.707">
    2001
  </text>
  <path d="M372 1324.773h232v7l-10 10H372v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M372 1324.773h639v156.664H372z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="387" y="1337.84">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M937 1384.04l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 1388.039h497"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="453" y="1382.973">
    11
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="475" y="1382.973">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 1396.039h621v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 1396.04h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="1410.106">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="614" y="1429.106">
    Event Handler Consume
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M379 1513.438h216v55.398H379z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M379 1513.438h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="392" y="1527.504">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="385" y="1546.504">
    Abort Position Handler Consume
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1069.5 1590.969l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M446 1594.969h629.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="453" y="1589.903">
    12
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="475" y="1589.903">
    Produce message
  </text>
</svg>
