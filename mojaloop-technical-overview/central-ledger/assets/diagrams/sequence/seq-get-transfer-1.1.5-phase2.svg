<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1787px" preserveAspectRatio="none" style="width:1595px;height:1787px;" version="1.1" viewBox="0 0 1595 1787" width="1595px" zoomAndPan="magnify"><defs><filter height="300%" id="f1uvoj5vrmy4rx" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="514" x="541" y="23.5352">1.1.5. Request transfer status (getTransferStatusById) - Phase2 version</text><rect fill="#D3D3D3" height="1741.6484" style="stroke: #A80036; stroke-width: 1.0;" width="179" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="7" y="47.0566">Financial Service Provider</text><rect fill="#ADD8E6" height="1741.6484" style="stroke: #A80036; stroke-width: 1.0;" width="241" x="438" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="480" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="1741.6484" style="stroke: #A80036; stroke-width: 1.0;" width="618" x="853.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1112" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="1492.3848" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="88.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="919.5" y="288.0176"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="257.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="919.5" y="567.8125"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="169.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1128.5" y="288.0176"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="167.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242.5" y="612.4336"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1414.5" y="641.7441"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="1485.3848" style="stroke: #000000; stroke-width: 2.0;" width="1559" x="24" y="170.7754"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="764" x="432" y="249.3965"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="809.2422" style="stroke: #000000; stroke-width: 2.0;" width="670" x="34" y="839.918"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="578.4922" style="stroke: #000000; stroke-width: 2.0;" width="641" x="44" y="864.2285"/><rect fill="#FFFFFF" height="267.3027" style="stroke: none; stroke-width: 1.0;" width="641" x="44" y="1175.418"/><rect fill="#FFFFFF" height="160.1289" style="stroke: none; stroke-width: 1.0;" width="670" x="34" y="1489.0313"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="153.7754" y2="1673.1602"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="558" x2="558" y1="153.7754" y2="1673.1602"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="924.5" x2="924.5" y1="153.7754" y2="1673.1602"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1133" x2="1133" y1="153.7754" y2="1673.1602"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1247" x2="1247" y1="153.7754" y2="1673.1602"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1419.5" x2="1419.5" y1="153.7754" y2="1673.1602"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="134.334">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="150.8223">Participant</text><ellipse cx="93.5" cy="63.7988" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,71.7988 L93.5,98.7988 M80.5,79.7988 L106.5,79.7988 M93.5,98.7988 L80.5,113.7988 M93.5,98.7988 L106.5,113.7988 " fill="none" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="1685.6953">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="1702.1836">Participant</text><ellipse cx="93.5" cy="1715.1367" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,1723.1367 L93.5,1750.1367 M80.5,1731.1367 L106.5,1731.1367 M93.5,1750.1367 L80.5,1765.1367 M93.5,1750.1367 L106.5,1765.1367 " fill="none" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="442" y="150.8223">ML API Notification Event Handler</text><ellipse cx="558.5" cy="121.2871" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="554.5,109.2871,560.5,104.2871,558.5,109.2871,560.5,114.2871,554.5,109.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="442" y="1685.6953">ML API Notification Event Handler</text><ellipse cx="558.5" cy="1704.6484" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="554.5,1692.6484,560.5,1687.6484,558.5,1692.6484,560.5,1697.6484,554.5,1692.6484" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="857.5" y="150.8223">Central Service API</text><path d="M904,109.2871 L904,133.2871 M904,121.2871 L921,121.2871 " fill="none" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="933" cy="121.2871" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="857.5" y="1685.6953">Central Service API</text><path d="M904,1692.6484 L904,1716.6484 M904,1704.6484 L921,1704.6484 " fill="none" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="933" cy="1704.6484" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1085" y="114.2871"/><rect fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1081" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1088" y="138.8223">Event-Topic</text><rect fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1085" y="1672.1602"/><rect fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1081" y="1676.1602"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1088" y="1696.6953">Event-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="1196" y="150.8223">Transfer-DAO</text><ellipse cx="1247.5" cy="121.2871" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1235.5" x2="1259.5" y1="135.2871" y2="135.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="1196" y="1685.6953">Transfer-DAO</text><ellipse cx="1247.5" cy="1704.6484" fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1235.5" x2="1259.5" y1="1718.6484" y2="1718.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1371.5" y="150.8223">Central Store</text><path d="M1401.5,101.2871 C1401.5,91.2871 1419.5,91.2871 1419.5,91.2871 C1419.5,91.2871 1437.5,91.2871 1437.5,101.2871 L1437.5,127.2871 C1437.5,137.2871 1419.5,137.2871 1419.5,137.2871 C1419.5,137.2871 1401.5,137.2871 1401.5,127.2871 L1401.5,101.2871 " fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1401.5,101.2871 C1401.5,111.2871 1419.5,111.2871 1419.5,111.2871 C1419.5,111.2871 1437.5,111.2871 1437.5,101.2871 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1371.5" y="1685.6953">Central Store</text><path d="M1401.5,1698.6484 C1401.5,1688.6484 1419.5,1688.6484 1419.5,1688.6484 C1419.5,1688.6484 1437.5,1688.6484 1437.5,1698.6484 L1437.5,1724.6484 C1437.5,1734.6484 1419.5,1734.6484 1419.5,1734.6484 C1419.5,1734.6484 1401.5,1734.6484 1401.5,1724.6484 L1401.5,1698.6484 " fill="#FEFECE" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1401.5,1698.6484 C1401.5,1708.6484 1419.5,1708.6484 1419.5,1708.6484 C1419.5,1708.6484 1437.5,1708.6484 1437.5,1698.6484 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="1492.3848" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="88.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="919.5" y="288.0176"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="257.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="919.5" y="567.8125"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="169.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1128.5" y="288.0176"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="167.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242.5" y="612.4336"/><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1414.5" y="641.7441"/><path d="M24,170.7754 L227,170.7754 L227,177.7754 L217,187.7754 L24,187.7754 L24,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1485.3848" style="stroke: #000000; stroke-width: 2.0;" width="1559" x="24" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="39" y="184.3438">Request transfer status</text><polygon fill="#A80036" points="546.5,205.3965,556.5,209.3965,546.5,213.3965,550.5,209.3965" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="98.5" x2="552.5" y1="209.3965" y2="209.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="105.5" y="204.6543">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="377" x="118.5" y="204.6543">Callback transfer status request URL - GET - /transfers/{ID}</text><path d="M432,249.3965 L647,249.3965 L647,256.3965 L637,266.3965 L432,266.3965 L432,249.3965 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="764" x="432" y="249.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="447" y="262.9648">Persist Event Information</text><polygon fill="#A80036" points="907.5,284.0176,917.5,288.0176,907.5,292.0176,911.5,288.0176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="913.5" y1="288.0176" y2="288.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="565.5" y="283.2754">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="329" x="578.5" y="283.2754">Request transfer information - GET - /transfers/{ID}</text><polygon fill="#A80036" points="1116.5,313.3281,1126.5,317.3281,1116.5,321.3281,1120.5,317.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="929.5" x2="1122.5" y1="317.3281" y2="317.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="936.5" y="312.5859">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="949.5" y="312.5859">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1uvoj5vrmy4rx)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="158" x="1078" y="350.3281"/><polygon fill="#EEEEEE" points="1078,350.3281,1142,350.3281,1142,357.3281,1132,367.3281,1078,367.3281,1078,350.3281" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1091" y="364.8965">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="1084" y="383.8965">Event Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1088" y="399.207"/><polygon fill="#A80036" points="940.5,453.5703,930.5,457.5703,940.5,461.5703,936.5,457.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="934.5" x2="1132.5" y1="457.5703" y2="457.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="946.5" y="452.8281">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="959.5" y="452.8281">Return success</text><polygon fill="#A80036" points="569.5,482.8809,559.5,486.8809,569.5,490.8809,565.5,486.8809" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="563.5" x2="923.5" y1="486.8809" y2="486.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="575.5" y="482.1387">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="588.5" y="482.1387">Return success</text><polygon fill="#A80036" points="109.5,519.1914,99.5,523.1914,109.5,527.1914,105.5,523.1914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="103.5" x2="557.5" y1="523.1914" y2="523.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="115.5" y="518.4492">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="128.5" y="518.4492">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="907.5,563.8125,917.5,567.8125,907.5,571.8125,911.5,567.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="913.5" y1="567.8125" y2="567.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="565.5" y="555.415">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="322" x="578.5" y="547.7598">Request details for Transfer - GET - /transfers/{ID}</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="578.5" y="563.0703">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="655.5" y="563.0703">2003</text><polygon fill="#A80036" points="1230.5,608.4336,1240.5,612.4336,1230.5,616.4336,1234.5,612.4336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="929.5" x2="1236.5" y1="612.4336" y2="612.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="936.5" y="600.0361">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="949.5" y="592.3809">Request transfer status</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="949.5" y="607.6914">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1026.5" y="607.6914">2003</text><polygon fill="#A80036" points="1402.5,637.7441,1412.5,641.7441,1402.5,645.7441,1406.5,641.7441" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1252.5" x2="1408.5" y1="641.7441" y2="641.7441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1259.5" y="637.002">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="1272.5" y="637.002">Fetch transfer status</text><polygon fill="#FFFFE0" filter="url(#f1uvoj5vrmy4rx)" points="1276,684.7441,1563,684.7441,1573,718.7441,1563,753.7441,1276,753.7441,1266,718.7441,1276,684.7441" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1278" y="701.3125">SELECT transferId, transferStateId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1278" y="716.623">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="1318" y="716.623">transferStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="1278" y="731.9336">WHERE transferId = {ID}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="1278" y="747.2441">ORDER BY transferStateChangeId desc limit 1</text><polygon fill="#A80036" points="940.5,776.2969,930.5,780.2969,940.5,784.2969,936.5,780.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="934.5" x2="1246.5" y1="780.2969" y2="780.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="946.5" y="775.5547">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="968.5" y="775.5547">Return transfer status</text><polygon fill="#A80036" points="569.5,820.918,559.5,824.918,569.5,828.918,565.5,824.918" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="563.5" x2="923.5" y1="824.918" y2="824.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="575.5" y="812.5205">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="597.5" y="804.8652">Return transfer status</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="597.5" y="820.1758">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="681.5" y="820.1758">3202, 3203</text><path d="M34,839.918 L96,839.918 L96,846.918 L86,856.918 L34,856.918 L34,839.918 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="809.2422" style="stroke: #000000; stroke-width: 2.0;" width="670" x="34" y="839.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="49" y="853.4863">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="346" x="111" y="852.5527">[Is there a transfer with the given ID recorded in the system?]</text><path d="M44,864.2285 L106,864.2285 L106,871.2285 L96,881.2285 L44,881.2285 L44,864.2285 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="578.4922" style="stroke: #000000; stroke-width: 2.0;" width="641" x="44" y="864.2285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="59" y="877.7969">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="218" x="121" y="876.8633">[Yes AND transferState is COMMITTED</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="462" x="121" y="889.8184">This implies that a succesful transfer with the given ID is recorded in the system]</text><path d="M85,897.4492 L85,1136.4492 L549,1136.4492 L549,907.4492 L539,897.4492 L85,897.4492 " fill="#FFFF00" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M539,897.4492 L539,907.4492 L549,907.4492 L539,897.4492 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="91" y="915.0176">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="427" x="107" y="930.3281">"fulfilment": "WLctttbu2HvTsa1XWvUoGRcQozHsqeu9Ahl2JW9Bsu8",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="384" x="107" y="945.6387">"completedTimestamp": "2018-09-24T08:38:08.699-04:00",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="107" y="960.9492">"transferState": "COMMITTED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="107" y="976.2598">extensionList:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="123" y="991.5703">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="123" y="1006.8809">extension:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="123" y="1022.1914">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="139" y="1037.502">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="139" y="1052.8125">"key": "Description",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="139" y="1068.123">"value": "This is a more detailed description"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="139" y="1083.4336">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="123" y="1098.7441">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="107" y="1114.0547">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="91" y="1129.3652">}</text><polygon fill="#A80036" points="109.5,1163.418,99.5,1167.418,109.5,1171.418,105.5,1167.418" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103.5" x2="557.5" y1="1167.418" y2="1167.418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="115.5" y="1162.6758">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="137.5" y="1162.6758">callback PUT on /transfers/{ID}</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="44" x2="685" y1="1176.418" y2="1176.418"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="293" x="49" y="1187.0527">[transferState in [RECEIVED, RESERVED, ABORTED]]</text><path d="M201,1195.373 L201,1404.373 L549,1404.373 L549,1205.373 L539,1195.373 L201,1195.373 " fill="#FFFF00" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M539,1195.373 L539,1205.373 L549,1205.373 L539,1195.373 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="207" y="1212.9414">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="223" y="1228.252">"transferState": "RECEIVED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="223" y="1243.5625">extensionList:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="239" y="1258.873">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="239" y="1274.1836">extension:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="239" y="1289.4941">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="255" y="1304.8047">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="255" y="1320.1152">"key": "Description",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="255" y="1335.4258">"value": "This is a more detailed description"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="255" y="1350.7363">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="239" y="1366.0469">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="223" y="1381.3574">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="207" y="1396.668">}</text><polygon fill="#A80036" points="109.5,1430.7207,99.5,1434.7207,109.5,1438.7207,105.5,1434.7207" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103.5" x2="557.5" y1="1434.7207" y2="1434.7207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="115.5" y="1429.9785">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="137.5" y="1429.9785">callback PUT on /transfers/{ID}</text><path d="M563,1454.7207 L563,1479.7207 L690,1479.7207 L690,1464.7207 L680,1454.7207 L563,1454.7207 " fill="#D3D3D3" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M680,1454.7207 L680,1464.7207 L690,1464.7207 L680,1454.7207 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="569" y="1472.2891">Log ERROR event</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="34" x2="704" y1="1490.0313" y2="1490.0313"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="485" x="39" y="1500.666">[A transfer with the given ID is not present in the System or this is an invalid request]</text><path d="M219,1508.9863 L219,1609.9863 L549,1609.9863 L549,1518.9863 L539,1508.9863 L219,1508.9863 " fill="#FFFF00" filter="url(#f1uvoj5vrmy4rx)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M539,1508.9863 L539,1518.9863 L549,1518.9863 L539,1508.9863 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="225" y="1526.5547">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="241" y="1541.8652">"errorInformation": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="257" y="1557.1758">"errorCode": &lt;integer&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="257" y="1572.4863">"errorDescription": "Client error description"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="241" y="1587.7969">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="225" y="1603.1074">}</text><polygon fill="#A80036" points="109.5,1637.1602,99.5,1641.1602,109.5,1645.1602,105.5,1641.1602" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103.5" x2="557.5" y1="1641.1602" y2="1641.1602"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="115.5" y="1636.418">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="137.5" y="1636.418">callback PUT on /transfers/{ID}/error</text><!--
@startuml
title 1.1.5. Request transfer status (getTransferStatusById) - Phase2 version

autonumber

actor "DFSP(n)\nParticipant" as DFSP
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Event-Topic" as TOPIC_EVENTS
entity "Transfer-DAO" as TRANSFER_DAO
database "Central Store" as DB

box "Financial Service Provider" #lightGray
	participant DFSP
end box

box "ML API Adapter Service" #LightBlue
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
    participant TOPIC_EVENTS
    participant TRANSFER_DAO
    participant DB
end box

group Request transfer status
    activate DFSP
    DFSP -> NOTIFY_HANDLER: Callback transfer status request URL - GET - /transfers/{ID}
    |||
    group Persist Event Information
        NOTIFY_HANDLER -> CSAPI: Request transfer information - GET - /transfers/{ID}
        activate CSAPI

        activate TOPIC_EVENTS
        CSAPI -> TOPIC_EVENTS: Publish event information
        |||
        ref over TOPIC_EVENTS :  Event Handler Consume\n
        |||
        CSAPI <- - TOPIC_EVENTS: Return success
        deactivate TOPIC_EVENTS
        CSAPI - -> NOTIFY_HANDLER: Return success
        deactivate CSAPI
    end
        DFSP <- - NOTIFY_HANDLER: Respond HTTP - 200 (OK)
    NOTIFY_HANDLER -> CSAPI: Request details for Transfer - GET - /transfers/{ID}\n<color #FF0000><b>Error code:</b> 2003</color>
    activate CSAPI
    CSAPI -> TRANSFER_DAO: Request transfer status\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TRANSFER_DAO
    TRANSFER_DAO -> DB: Fetch transfer status
    activate DB
    hnote over DB #lightyellow
        SELECT transferId, transferStateId
        FROM **transferStateChange**
        WHERE transferId = {ID}
        ORDER BY transferStateChangeId desc limit 1
    end note
    deactivate DB
    CSAPI <- - TRANSFER_DAO: Return transfer status
    deactivate TRANSFER_DAO
    NOTIFY_HANDLER <- - CSAPI: Return transfer status\n<color #FF0000><b>Error codes:</b> 3202, 3203</color>
    deactivate CSAPI

    alt Is there a transfer with the given ID recorded in the system?
        alt Yes AND transferState is COMMITTED \nThis implies that a succesful transfer with the given ID is recorded in the system
            note left of NOTIFY_HANDLER #yellow
                {
                    "fulfilment": "WLctttbu2HvTsa1XWvUoGRcQozHsqeu9Ahl2JW9Bsu8",
                    "completedTimestamp": "2018-09-24T08:38:08.699-04:00",
                    "transferState": "COMMITTED",
                    extensionList:
                        {
                        extension:
                        [
                            {
                            "key": "Description",
                            "value": "This is a more detailed description"
                            }
                        ]
                    }
                }
            end note
            DFSP <- NOTIFY_HANDLER: callback PUT on /transfers/{ID}
        else transferState in [RECEIVED, RESERVED, ABORTED]
            note left of NOTIFY_HANDLER #yellow
                {
                    "transferState": "RECEIVED",
                    extensionList:
                        {
                        extension:
                        [
                            {
                            "key": "Description",
                            "value": "This is a more detailed description"
                            }
                        ]
                    }
                }
            end note
            DFSP <- NOTIFY_HANDLER: callback PUT on /transfers/{ID}
        end
        note right of NOTIFY_HANDLER #lightgray
            Log ERROR event
        end note
    else A transfer with the given ID is not present in the System or this is an invalid request
        note left of NOTIFY_HANDLER #yellow
            {
                "errorInformation": {
                    "errorCode": <integer>,
                    "errorDescription": "Client error description"
                }
            }
        end note
        DFSP <- NOTIFY_HANDLER: callback PUT on /transfers/{ID}/error
    end
    deactivate NOTIFY_HANDLER
deactivate DFSP
end
@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>