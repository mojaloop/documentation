<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1021px" preserveAspectRatio="none" style="width:2014px;height:1021px;" version="1.1" viewBox="0 0 2014 1021" width="2014px" zoomAndPan="magnify"><defs><filter height="300%" id="f1lvnsg8d1daeb" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="508" x="753.5" y="23.5352">1.1.4.a. Send notification to Participant (Payer/Payee) (single message)</text><rect fill="#D3D3D3" height="976.0273" style="stroke: #A80036; stroke-width: 1.0;" width="179" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="7" y="47.0566">Financial Service Provider</text><rect fill="#ADD8E6" height="976.0273" style="stroke: #A80036; stroke-width: 1.0;" width="241" x="628" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="670" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="976.0273" style="stroke: #A80036; stroke-width: 1.0;" width="1081" x="889" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1379" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="733.7637" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="743.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="961.5" y="209.3965"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1285.5" y="293.0176"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="210.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1285.5" y="598.123"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="140.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1489.5" y="322.3281"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1609" y="642.7441"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1913" y="672.0547"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="719.7637" style="stroke: #000000; stroke-width: 2.0;" width="1958" x="44" y="170.7754"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="935" x="622" y="254.3965"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="153.7754" y2="907.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="748" x2="748" y1="153.7754" y2="907.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="966" x2="966" y1="153.7754" y2="907.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1290.5" x2="1290.5" y1="153.7754" y2="907.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1494" x2="1494" y1="153.7754" y2="907.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1614" x2="1614" y1="153.7754" y2="907.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1918" x2="1918" y1="153.7754" y2="907.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="134.334">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="150.8223">Participant</text><ellipse cx="93.5" cy="63.7988" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,71.7988 L93.5,98.7988 M80.5,79.7988 L106.5,79.7988 M93.5,98.7988 L80.5,113.7988 M93.5,98.7988 L106.5,113.7988 " fill="none" filter="url(#f1lvnsg8d1daeb)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="920.0742">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="936.5625">Participant</text><ellipse cx="93.5" cy="949.5156" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,957.5156 L93.5,984.5156 M80.5,965.5156 L106.5,965.5156 M93.5,984.5156 L80.5,999.5156 M93.5,984.5156 L106.5,999.5156 " fill="none" filter="url(#f1lvnsg8d1daeb)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="632" y="150.8223">ML API Notification Event Handler</text><ellipse cx="748.5" cy="121.2871" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="744.5,109.2871,750.5,104.2871,748.5,109.2871,750.5,114.2871,744.5,109.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="632" y="920.0742">ML API Notification Event Handler</text><ellipse cx="748.5" cy="939.0273" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="744.5,927.0273,750.5,922.0273,748.5,927.0273,750.5,932.0273,744.5,927.0273" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="897" y="114.2871"/><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="893" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="900" y="138.8223">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="897" y="906.5391"/><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="893" y="910.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="900" y="931.0742">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1223.5" y="150.8223">Central Service API</text><path d="M1270,109.2871 L1270,133.2871 M1270,121.2871 L1287,121.2871 " fill="none" filter="url(#f1lvnsg8d1daeb)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1299" cy="121.2871" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1223.5" y="920.0742">Central Service API</text><path d="M1270,927.0273 L1270,951.0273 M1270,939.0273 L1287,939.0273 " fill="none" filter="url(#f1lvnsg8d1daeb)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1299" cy="939.0273" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1446" y="114.2871"/><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1442" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1449" y="138.8223">Event-Topic</text><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1446" y="906.5391"/><rect fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1442" y="910.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1449" y="931.0742">Event-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="1557" y="150.8223">Participant DAO</text><ellipse cx="1614" cy="121.2871" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1602" x2="1626" y1="135.2871" y2="135.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="1557" y="920.0742">Participant DAO</text><ellipse cx="1614" cy="939.0273" fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1602" x2="1626" y1="953.0273" y2="953.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1870" y="150.8223">Central Store</text><path d="M1900,101.2871 C1900,91.2871 1918,91.2871 1918,91.2871 C1918,91.2871 1936,91.2871 1936,101.2871 L1936,127.2871 C1936,137.2871 1918,137.2871 1918,137.2871 C1918,137.2871 1900,137.2871 1900,127.2871 L1900,101.2871 " fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1900,101.2871 C1900,111.2871 1918,111.2871 1918,111.2871 C1918,111.2871 1936,111.2871 1936,101.2871 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1870" y="920.0742">Central Store</text><path d="M1900,933.0273 C1900,923.0273 1918,923.0273 1918,923.0273 C1918,923.0273 1936,923.0273 1936,933.0273 L1936,959.0273 C1936,969.0273 1918,969.0273 1918,969.0273 C1918,969.0273 1900,969.0273 1900,959.0273 L1900,933.0273 " fill="#FEFECE" filter="url(#f1lvnsg8d1daeb)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1900,933.0273 C1900,943.0273 1918,943.0273 1918,943.0273 C1918,943.0273 1936,943.0273 1936,933.0273 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="733.7637" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="743.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="961.5" y="209.3965"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1285.5" y="293.0176"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="210.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1285.5" y="598.123"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="140.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1489.5" y="322.3281"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1609" y="642.7441"/><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1913" y="672.0547"/><path d="M44,170.7754 L296,170.7754 L296,177.7754 L286,187.7754 L44,187.7754 L44,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="719.7637" style="stroke: #000000; stroke-width: 2.0;" width="1958" x="44" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="59" y="184.3438">Send notification to Participant</text><polygon fill="#A80036" points="949.5,205.3965,959.5,209.3965,949.5,213.3965,953.5,209.3965" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="753.5" x2="955.5" y1="209.3965" y2="209.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="760.5" y="204.6543">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="773.5" y="204.6543">Consume Notification event</text><path d="M622,254.3965 L837,254.3965 L837,261.3965 L827,271.3965 L622,271.3965 L622,254.3965 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="935" x="622" y="254.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="637" y="267.9648">Persist Event Information</text><polygon fill="#A80036" points="1273.5,289.0176,1283.5,293.0176,1273.5,297.0176,1277.5,293.0176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="753.5" x2="1279.5" y1="293.0176" y2="293.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="760.5" y="288.2754">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="342" x="773.5" y="288.2754">Request to persist event information - POST - /events</text><polygon fill="#A80036" points="1477.5,318.3281,1487.5,322.3281,1477.5,326.3281,1481.5,322.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1295.5" x2="1483.5" y1="322.3281" y2="322.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1302.5" y="317.5859">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1315.5" y="317.5859">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1lvnsg8d1daeb)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="206" x="1439" y="355.3281"/><polygon fill="#EEEEEE" points="1439,355.3281,1503,355.3281,1503,362.3281,1493,372.3281,1439,372.3281,1439,355.3281" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1452" y="369.8965">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1445" y="388.8965">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="32" x="1603" y="388.8965">9.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1603" x2="1635" y1="390.8965" y2="390.8965"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1635" y="388.8965">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1449" y="404.207"/><polygon fill="#A80036" points="1306.5,458.5703,1296.5,462.5703,1306.5,466.5703,1302.5,462.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1300.5" x2="1493.5" y1="462.5703" y2="462.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1312.5" y="457.8281">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1325.5" y="457.8281">Return success</text><polygon fill="#A80036" points="764.5,487.8809,754.5,491.8809,764.5,495.8809,760.5,491.8809" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="758.5" x2="1289.5" y1="491.8809" y2="491.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="770.5" y="487.1387">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="783.5" y="487.1387">Return success</text><path d="M758,511.8809 L758,551.8809 L1084,551.8809 L1084,521.8809 L1074,511.8809 L758,511.8809 " fill="#D3D3D3" filter="url(#f1lvnsg8d1daeb)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1074,511.8809 L1074,521.8809 L1084,521.8809 L1074,511.8809 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="305" x="764" y="529.4492">The endpoint details are cached, when the cache</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="764" y="544.7598">expires, the details are fetched again</text><polygon fill="#A80036" points="1273.5,594.123,1283.5,598.123,1273.5,602.123,1277.5,598.123" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="753.5" x2="1279.5" y1="598.123" y2="598.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="760.5" y="585.7256">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="500" x="773.5" y="578.0703">Request Endpoint details for Participant - GET - /participants/{{fsp}}/endpoints</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="773.5" y="593.3809">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="850.5" y="593.3809">2003</text><polygon fill="#A80036" points="1597,638.7441,1607,642.7441,1597,646.7441,1601,642.7441" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1295.5" x2="1603" y1="642.7441" y2="642.7441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1302.5" y="630.3467">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="1315.5" y="622.6914">Fetch Endpoint details for Participant</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="1315.5" y="638.002">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1392.5" y="638.002">2003</text><polygon fill="#A80036" points="1901,668.0547,1911,672.0547,1901,676.0547,1905,672.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1619" x2="1907" y1="672.0547" y2="672.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1626" y="667.3125">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="1639" y="667.3125">Fetch Endpoint details for Participant</text><polygon fill="#FFFFE0" filter="url(#f1lvnsg8d1daeb)" points="1854,685.0547,1982,685.0547,1992,696.0547,1982,708.0547,1854,708.0547,1844,696.0547,1854,685.0547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1856" y="701.623">participantEndpoint</text><polygon fill="#A80036" points="1630,730.6758,1620,734.6758,1630,738.6758,1626,734.6758" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1624" x2="1917" y1="734.6758" y2="734.6758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1636" y="729.9336">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="1649" y="729.9336">Retrieved Endpoint details for Participant</text><polygon fill="#A80036" points="1306.5,759.9863,1296.5,763.9863,1306.5,767.9863,1302.5,763.9863" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1300.5" x2="1613" y1="763.9863" y2="763.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1312.5" y="759.2441">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="1334.5" y="759.2441">Return Endpoint details for Participant</text><polygon fill="#A80036" points="764.5,804.6074,754.5,808.6074,764.5,812.6074,760.5,808.6074" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="758.5" x2="1289.5" y1="808.6074" y2="808.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="770.5" y="796.21">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="792.5" y="788.5547">Return Endpoint details for Participant</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="792.5" y="803.8652">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="876.5" y="803.8652">3202, 3203</text><polygon fill="#A80036" points="104.5,849.2285,94.5,853.2285,104.5,857.2285,100.5,853.2285" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="98.5" x2="742.5" y1="853.2285" y2="853.2285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="110.5" y="840.8311">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="554" x="132.5" y="833.1758">Callback with Prepare/fulfil result/error to Participant to specified Endpoint - POST/PUT</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="132.5" y="848.4863">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="209.5" y="848.4863">1001</text><polygon fill="#A80036" points="731.5,878.5391,741.5,882.5391,731.5,886.5391,735.5,882.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="93.5" x2="737.5" y1="882.5391" y2="882.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="100.5" y="877.7969">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="122.5" y="877.7969">HTTP 200 OK</text><!--
@startuml
title 1.1.4.a. Send notification to Participant (Payer/Payee) (single message)

autonumber


actor "DFSP(n)\nParticipant" as DFSP
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Notification-Topic" as TOPIC_NOTIFICATIONS
collections "Event-Topic" as TOPIC_EVENTS
entity "Participant DAO" as PARTICIPANT_DAO
database "Central Store" as DB

box "Financial Service Provider" #lightGray
	participant DFSP
end box

box "ML API Adapter Service" #LightBlue
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
participant TOPIC_NOTIFICATIONS
    participant CSAPI
    participant TOPIC_EVENTS
    participant PARTICIPANT_DAO
    participant DB
end box

activate NOTIFY_HANDLER
group Send notification to Participant
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume Notification event
    activate TOPIC_NOTIFICATIONS
    deactivate TOPIC_NOTIFICATIONS

    group Persist Event Information
        NOTIFY_HANDLER -> CSAPI: Request to persist event information - POST - /events
        activate CSAPI
        CSAPI -> TOPIC_EVENTS: Publish event information
        activate TOPIC_EVENTS
        |||
        ref over TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg 9.1.0]]} \n
        |||
        TOPIC_EVENTS - -> CSAPI: Return success
        deactivate TOPIC_EVENTS
        CSAPI - -> NOTIFY_HANDLER: Return success
        deactivate CSAPI
    end
    note right of NOTIFY_HANDLER #lightgray
        The endpoint details are cached, when the cache
        expires, the details are fetched again
    end note
    NOTIFY_HANDLER -> CSAPI: Request Endpoint details for Participant - GET - /participants/{{fsp}}/endpoints\n<color #FF0000><b>Error code:</b> 2003</color>

    activate CSAPI
    CSAPI -> PARTICIPANT_DAO: Fetch Endpoint details for Participant\n<color #FF0000><b>Error code:</b> 2003</color>
    activate PARTICIPANT_DAO
    PARTICIPANT_DAO -> DB: Fetch Endpoint details for Participant
    activate DB
    hnote over DB #lightyellow
        participantEndpoint
    end note
    DB -> PARTICIPANT_DAO: Retrieved Endpoint details for Participant
    deactivate DB
    PARTICIPANT_DAO - -> CSAPI: Return Endpoint details for Participant
    deactivate PARTICIPANT_DAO
    CSAPI - -> NOTIFY_HANDLER: Return Endpoint details for Participant\n<color #FF0000><b>Error codes:</b> 3202, 3203</color>
    deactivate CSAPI
    NOTIFY_HANDLER -> DFSP: Callback with Prepare/fulfil result/error to Participant to specified Endpoint - POST/PUT \n<color #FF0000><b>Error code:</b> 1001</color>
    NOTIFY_HANDLER <- - DFSP: HTTP 200 OK 
end
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.14.5
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>