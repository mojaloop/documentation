<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1075px" preserveAspectRatio="none" style="width:1094px;height:1075px;" version="1.1" viewBox="0 0 1094 1075" width="1094px" zoomAndPan="magnify"><defs><filter height="300%" id="fgyqxivzcufcz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="609" x="243.5" y="23.5352">9.1.1. Request Duplicate Check (incl. Transfers, Quotes, Bulk Transfers, Bulk Quotes)</text><rect fill="#FFFFE0" height="1029.9141" style="stroke: #A80036; stroke-width: 1.0;" width="1001.5" x="19" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="469.25" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="73" y="174.3965"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="858.6504" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="233" y="128.7754"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="206.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="727.5" y="315.6387"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="121.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="727.5" y="750.252"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="963.5" y="430.1914"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="963.5" y="779.5625"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="843.6504" style="stroke: #000000; stroke-width: 2.0;" width="1070" x="13" y="135.7754"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="268.416" style="stroke: #000000; stroke-width: 2.0;" width="875" x="188" y="261.707"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="343.0605" style="stroke: #000000; stroke-width: 2.0;" width="895" x="178" y="544.123"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="98.9316" style="stroke: #000000; stroke-width: 2.0;" width="384" x="188" y="568.4336"/><rect fill="#FFFFFF" height="212.8184" style="stroke: none; stroke-width: 1.0;" width="895" x="178" y="674.3652"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="183.8633" style="stroke: #000000; stroke-width: 2.0;" width="875" x="188" y="696.3203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="78" x2="78" y1="118.7754" y2="996.4258"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="238" x2="238" y1="118.7754" y2="996.4258"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="475.5" x2="475.5" y1="118.7754" y2="996.4258"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="605.5" x2="605.5" y1="118.7754" y2="996.4258"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="732.5" x2="732.5" y1="118.7754" y2="996.4258"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="968.5" x2="968.5" y1="118.7754" y2="996.4258"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="27" y="79.2871"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="23" y="83.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="30" y="103.8223">topic-source</text><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="27" y="995.4258"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="23" y="999.4258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="30" y="1019.9609">topic-source</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="198" y="99.334">Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="208" y="115.8223">Handler</text><ellipse cx="238" cy="69.7988" fill="#FEFECE" filter="url(#fgyqxivzcufcz)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="234,57.7988,240,52.7988,238,57.7988,240,62.7988,234,57.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="198" y="1008.9609">Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="208" y="1025.4492">Handler</text><ellipse cx="238" cy="1044.4023" fill="#FEFECE" filter="url(#fgyqxivzcufcz)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="234,1032.4023,240,1027.4023,238,1032.4023,240,1037.4023,234,1032.4023" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="429.5" y="79.2871"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="425.5" y="83.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="432.5" y="103.8223">topic-event</text><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="429.5" y="995.4258"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="425.5" y="999.4258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="432.5" y="1019.9609">topic-event</text><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="540.5" y="79.2871"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="536.5" y="83.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="543.5" y="103.8223">topic-notifcation</text><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="540.5" y="995.4258"/><rect fill="#FEFECE" filter="url(#fgyqxivzcufcz)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="536.5" y="999.4258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="543.5" y="1019.9609">topic-notifcation</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="684.5" y="115.8223">Request DAO</text><ellipse cx="732.5" cy="86.2871" fill="#FEFECE" filter="url(#fgyqxivzcufcz)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="720.5" x2="744.5" y1="100.2871" y2="100.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="684.5" y="1008.9609">Request DAO</text><ellipse cx="732.5" cy="1027.9141" fill="#FEFECE" filter="url(#fgyqxivzcufcz)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="720.5" x2="744.5" y1="1041.9141" y2="1041.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="920.5" y="115.8223">Central Store</text><path d="M950.5,66.2871 C950.5,56.2871 968.5,56.2871 968.5,56.2871 C968.5,56.2871 986.5,56.2871 986.5,66.2871 L986.5,92.2871 C986.5,102.2871 968.5,102.2871 968.5,102.2871 C968.5,102.2871 950.5,102.2871 950.5,92.2871 L950.5,66.2871 " fill="#FEFECE" filter="url(#fgyqxivzcufcz)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M950.5,66.2871 C950.5,76.2871 968.5,76.2871 968.5,76.2871 C968.5,76.2871 986.5,76.2871 986.5,66.2871 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="920.5" y="1008.9609">Central Store</text><path d="M950.5,1021.9141 C950.5,1011.9141 968.5,1011.9141 968.5,1011.9141 C968.5,1011.9141 986.5,1011.9141 986.5,1021.9141 L986.5,1047.9141 C986.5,1057.9141 968.5,1057.9141 968.5,1057.9141 C968.5,1057.9141 950.5,1057.9141 950.5,1047.9141 L950.5,1021.9141 " fill="#FEFECE" filter="url(#fgyqxivzcufcz)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M950.5,1021.9141 C950.5,1031.9141 968.5,1031.9141 968.5,1031.9141 C968.5,1031.9141 986.5,1031.9141 986.5,1021.9141 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="73" y="174.3965"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="858.6504" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="233" y="128.7754"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="206.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="727.5" y="315.6387"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="121.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="727.5" y="750.252"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="963.5" y="430.1914"/><rect fill="#FFFFFF" filter="url(#fgyqxivzcufcz)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="963.5" y="779.5625"/><path d="M13,135.7754 L226,135.7754 L226,142.7754 L216,152.7754 L13,152.7754 L13,135.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="843.6504" style="stroke: #000000; stroke-width: 2.0;" width="1070" x="13" y="135.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="28" y="149.3438">Request Duplicate Check</text><polygon fill="#A80036" points="94,170.3965,84,174.3965,94,178.3965,90,174.3965" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="88" x2="232" y1="174.3965" y2="174.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="100" y="169.6543">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="113" y="169.6543">Consume message</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="243" x2="285" y1="233.707" y2="233.707"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="285" x2="285" y1="233.707" y2="246.707"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="244" x2="285" y1="246.707" y2="246.707"/><polygon fill="#A80036" points="254,242.707,244,246.707,254,250.707,250,246.707" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="250" y="228.9648">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="263" y="228.9648">Generate hash:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="360" y="228.9648">generatedHash</text><path d="M188,261.707 L414,261.707 L414,268.707 L404,278.707 L188,278.707 L188,261.707 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="268.416" style="stroke: #000000; stroke-width: 2.0;" width="875" x="188" y="261.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="181" x="203" y="275.2754">UUID Check (compareById)</text><polygon fill="#A80036" points="715.5,311.6387,725.5,315.6387,715.5,319.6387,719.5,315.6387" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="243" x2="721.5" y1="315.6387" y2="315.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="250" y="303.2412">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="326" x="263" y="295.5859">Query hash using getDuplicateDataFuncOverride(id)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="263" y="310.8965">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="340" y="310.8965">2003</text><path d="M742,328.6387 L742,399.6387 L979,399.6387 L979,338.6387 L969,328.6387 L742,328.6387 " fill="#D3D3D3" filter="url(#fgyqxivzcufcz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M969,328.6387 L969,338.6387 L979,338.6387 L969,328.6387 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="47" x="748" y="346.207">request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="799" y="346.207">keyword to be replaced by</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="748" y="361.5176">transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="802" y="361.5176">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="810" y="361.5176">transferFulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="932" y="361.5176">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="748" y="376.8281">bulkTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="840" y="376.8281">or other depending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="748" y="392.1387">on the override</text><polygon fill="#A80036" points="951.5,426.1914,961.5,430.1914,951.5,434.1914,955.5,430.1914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737.5" x2="957.5" y1="430.1914" y2="430.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="744.5" y="425.4492">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="757.5" y="425.4492">getDuplicateDataFuncOverride</text><polygon fill="#FFFFE0" filter="url(#fgyqxivzcufcz)" points="893,443.1914,1043,443.1914,1053,454.1914,1043,466.1914,893,466.1914,883,454.1914,893,443.1914" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="47" x="895" y="459.7598">request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="942" y="459.7598">DuplicateCheck</text><polygon fill="#A80036" points="748.5,488.8125,738.5,492.8125,748.5,496.8125,744.5,492.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="742.5" x2="967.5" y1="492.8125" y2="492.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="754.5" y="488.0703">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="767.5" y="488.0703">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="812.5" y="488.0703">duplicateHashRecord</text><polygon fill="#A80036" points="254,518.123,244,522.123,254,526.123,250,522.123" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="248" x2="731.5" y1="522.123" y2="522.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="260" y="517.3809">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="273" y="517.3809">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="318" y="517.3809">hasDuplicateId</text><path d="M178,544.123 L240,544.123 L240,551.123 L230,561.123 L178,561.123 L178,544.123 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="343.0605" style="stroke: #000000; stroke-width: 2.0;" width="895" x="178" y="544.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="193" y="557.6914">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="255" y="556.7578">[hasDuplicateId == TRUE]</text><path d="M188,568.4336 L435,568.4336 L435,575.4336 L425,585.4336 L188,585.4336 L188,568.4336 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="98.9316" style="stroke: #000000; stroke-width: 2.0;" width="384" x="188" y="568.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="202" x="203" y="582.002">Hash Check (compareByHash)</text><path d="M248,590.7441 L248,615.7441 L558,615.7441 L558,600.7441 L548,590.7441 L248,590.7441 " fill="#D3D3D3" filter="url(#fgyqxivzcufcz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M548,590.7441 L548,600.7441 L558,600.7441 L548,590.7441 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="289" x="254" y="608.3125">generatedHash == duplicateHashRecord.hash</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="243" x2="285" y1="646.3652" y2="646.3652"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="285" x2="285" y1="646.3652" y2="659.3652"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="244" x2="285" y1="659.3652" y2="659.3652"/><polygon fill="#A80036" points="254,655.3652,244,659.3652,254,663.3652,250,659.3652" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="250" y="641.623">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="263" y="641.623">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="308" y="641.623">hasDuplicateHash</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="178" x2="1073" y1="675.3652" y2="675.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="183" y="686">[hasDuplicateId == FALSE]</text><path d="M188,696.3203 L368,696.3203 L368,703.3203 L358,713.3203 L188,713.3203 L188,696.3203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="183.8633" style="stroke: #000000; stroke-width: 2.0;" width="875" x="188" y="696.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="203" y="709.8887">Store Message Hash</text><polygon fill="#A80036" points="715.5,746.252,725.5,750.252,715.5,754.252,719.5,750.252" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="243" x2="721.5" y1="750.252" y2="750.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="250" y="737.8545">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="384" x="263" y="730.1992">Persist hash using saveHashFuncOverride(id, generatedHash)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="263" y="745.5098">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="340" y="745.5098">2003</text><polygon fill="#A80036" points="951.5,775.5625,961.5,779.5625,951.5,783.5625,955.5,779.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737.5" x2="957.5" y1="779.5625" y2="779.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="744.5" y="774.8203">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="757.5" y="774.8203">Persist</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="803.5" y="774.8203">generatedHash</text><polygon fill="#FFFFE0" filter="url(#fgyqxivzcufcz)" points="893,822.5625,1043,822.5625,1053,833.5625,1043,845.5625,893,845.5625,883,833.5625,893,822.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="47" x="895" y="839.1309">request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="942" y="839.1309">DuplicateCheck</text><polygon fill="#A80036" points="254,868.1836,244,872.1836,254,876.1836,250,872.1836" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="248" x2="731.5" y1="872.1836" y2="872.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="260" y="867.4414">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="282" y="867.4414">Return success</text><path d="M248,899.1836 L248,970.1836 L456,970.1836 L456,909.1836 L446,899.1836 L248,899.1836 " fill="#FFFF00" filter="url(#fgyqxivzcufcz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M446,899.1836 L446,909.1836 L456,909.1836 L446,899.1836 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="254" y="916.752">return {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="270" y="932.0625">hasDuplicateId: Boolean,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="270" y="947.373">hasDuplicateHash: Boolean</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="254" y="962.6836">}</text><!--
@startuml
title 9.1.1. Request Duplicate Check (incl. Transfers, Quotes, Bulk Transfers, Bulk Quotes)

autonumber


collections "topic-source" as TOPIC_SOURCE
control "Processing\nHandler" as HANDLER
collections "topic-event" as TOPIC_EVENTS
collections "topic-notifcation" as TOPIC_NOTIFICATION
entity "Request DAO" as DAO
database "Central Store" as DB

box "Central Service" #LightYellow
    participant TOPIC_SOURCE
    participant HANDLER
    participant TOPIC_EVENTS
    participant TOPIC_NOTIFICATION
    participant DAO
    participant DB
end box

activate HANDLER

group Request Duplicate Check
    TOPIC_SOURCE <- HANDLER: Consume message
    activate TOPIC_SOURCE
    deactivate TOPIC_SOURCE

    HANDLER -> HANDLER: Generate hash: **generatedHash**
    group UUID Check (compareById)
        HANDLER -> DAO: Query hash using getDuplicateDataFuncOverride(id)\n<color #red><b>Error code:</b> 2003</color>
        activate DAO
        note right of DAO #lightgrey
            //request// keyword to be replaced by
            **transfer**, **transferFulfilment**, 
            **bulkTransfer** or other depending 
            on the override
        end note
        DAO -> DB: getDuplicateDataFuncOverride
        hnote over DB #lightyellow
            //request//DuplicateCheck
        end note
        activate DB
        DB - -> DAO: Return **duplicateHashRecord**
        deactivate DB
        DAO - -> HANDLER: Return **hasDuplicateId**
        deactivate DAO
    end
    
    alt hasDuplicateId == TRUE
        group Hash Check (compareByHash)
            note right of HANDLER #lightgrey
                generatedHash == duplicateHashRecord.hash
            end note
            HANDLER -> HANDLER: Return **hasDuplicateHash**
        end
    else hasDuplicateId == FALSE
        group Store Message Hash
            HANDLER -> DAO: Persist hash using saveHashFuncOverride(id, generatedHash)\n<color #FF0000><b>Error code:</b> 2003</color>
            activate DAO
            DAO -> DB: Persist **generatedHash**
            activate DB
            deactivate DB
            hnote over DB #lightyellow
                //request//DuplicateCheck
            end note
            DAO - -> HANDLER: Return success
            deactivate DAO
        end
    end

    note right of HANDLER #yellow
        return {
            hasDuplicateId: Boolean,
            hasDuplicateHash: Boolean
        }
    end note
end

@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>