<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3957px" preserveAspectRatio="none" style="width:1764px;height:3957px;" version="1.1" viewBox="0 0 1764 3957" width="1764px" zoomAndPan="magnify"><defs><filter height="300%" id="f12ply0i8jmok6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="235" x="765.5" y="22.9951">2.1.1. Bulk Fulfil Handler Consume</text><rect fill="#FFFFE0" height="3912.5938" style="stroke: #A80036; stroke-width: 1.0;" width="1522" x="39" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="751" y="46.3638">Central Service</text><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="88" y="247.5547"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="88" y="2782.6563"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="193.5" y="173.2891"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="3741.2734" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="343.5" y="128.0234"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="795.5" y="3243.2422"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1133.5" y="3817.2969"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="165.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="1017.1406"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="120.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="1494.5313"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="121.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="1960.1328"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="151.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="2188.0625"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="166.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="2445.0625"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="92.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="1061.4063"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="1523.6641"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="1989.2656"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="2217.1953"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="2474.1953"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="3727.2734" style="stroke: #000000; stroke-width: 2.0;" width="1740" x="13" y="135.0234"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="120.6641" style="stroke: #000000; stroke-width: 2.0;" width="362.5" x="294" y="291.6875"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="89.5313" style="stroke: #000000; stroke-width: 2.0;" width="342.5" x="304" y="315.8203"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="769" x="304" y="426.3516"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="102.5313" style="stroke: #000000; stroke-width: 2.0;" width="910" x="304" y="597.0156"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="1920.3125" style="stroke: #000000; stroke-width: 2.0;" width="1424" x="264" y="713.5469"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="1190.0547" style="stroke: #000000; stroke-width: 2.0;" width="1404" x="274" y="906.4766"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="819.0625" style="stroke: #000000; stroke-width: 2.0;" width="1361" x="284" y="1270.4688"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="769" x="304" y="1294.6016"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="272" style="stroke: #000000; stroke-width: 2.0;" width="930" x="294" y="1630.0625"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="77.5313" style="stroke: #000000; stroke-width: 2.0;" width="910" x="304" y="1654.1953"/><rect fill="#FFFFFF" height="88.0703" style="stroke: none; stroke-width: 1.0;" width="930" x="294" y="1738.7266"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="188.5" x="304" y="1760.5313"/><rect fill="#FFFFFF" height="75.2656" style="stroke: none; stroke-width: 1.0;" width="930" x="294" y="1826.7969"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="292.5" x="304" y="1835.7969"/><rect fill="#FFFFFF" height="180.4688" style="stroke: none; stroke-width: 1.0;" width="1361" x="284" y="1909.0625"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="516.3281" style="stroke: #000000; stroke-width: 2.0;" width="1325" x="294" y="2110.5313"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="213.0625" style="stroke: #000000; stroke-width: 2.0;" width="1305" x="304" y="2134.6641"/><rect fill="#FFFFFF" height="272.1328" style="stroke: none; stroke-width: 1.0;" width="1325" x="294" y="2354.7266"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="243.3281" style="stroke: #000000; stroke-width: 2.0;" width="1305" x="304" y="2376.5313"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="1207.4375" style="stroke: #000000; stroke-width: 2.0;" width="1720" x="23" y="2647.8594"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="551.9844" style="stroke: #000000; stroke-width: 2.0;" width="1700" x="33" y="2729.2578"/><rect fill="#FFFFFF" height="567.0547" style="stroke: none; stroke-width: 1.0;" width="1720" x="23" y="3288.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="198" x2="198" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="348" x2="348" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="800" x2="800" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="912" x2="912" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1015" x2="1015" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1138" x2="1138" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1248" x2="1248" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1513" x2="1513" y1="118.0234" y2="3879.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1645" x2="1645" y1="118.0234" y2="3879.2969"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="47" y="62.4297"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="43" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="64.5" y="86.4248">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="50" y="102.7217">object-store</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="47" y="3878.2969"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="43" y="3882.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="64.5" y="3902.292">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="50" y="3918.5889">object-store</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="157" y="62.4297"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="153" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="160" y="86.4248">topic-bulk-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="180.5" y="102.7217">fulfil</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="157" y="3878.2969"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="153" y="3882.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="160" y="3902.292">topic-bulk-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="180.5" y="3918.5889">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="314" y="98.4248">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="320.5" y="114.7217">Handler</text><ellipse cx="348.5" cy="69.4297" fill="#FEFECE" filter="url(#f12ply0i8jmok6)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="344.5,57.4297,350.5,52.4297,348.5,57.4297,350.5,62.4297,344.5,57.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="314" y="3891.292">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="320.5" y="3907.5889">Handler</text><ellipse cx="348.5" cy="3926.8906" fill="#FEFECE" filter="url(#f12ply0i8jmok6)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="344.5,3914.8906,350.5,3909.8906,348.5,3914.8906,350.5,3919.8906,344.5,3914.8906" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="748" y="62.4297"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="744" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="751" y="86.4248">topic-transfer-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="782.5" y="102.7217">fulfil</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="748" y="3878.2969"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="744" y="3882.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="751" y="3902.292">topic-transfer-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="782.5" y="3918.5889">fulfil</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="871" y="62.4297"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="867" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="874" y="86.4248">topic-bulk-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="874" y="102.7217">processing</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="871" y="3878.2969"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="867" y="3882.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="874" y="3902.292">topic-bulk-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="874" y="3918.5889">processing</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="972" y="78.7266"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="968" y="82.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="975" y="102.7217">topic-event</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="972" y="3878.2969"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="968" y="3882.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="975" y="3902.292">topic-event</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1077" y="78.7266"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1073" y="82.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="1080" y="102.7217">topic-notification</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1077" y="3878.2969"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1073" y="3882.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="1080" y="3902.292">topic-notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1214" y="114.7217">Bulk DAO</text><ellipse cx="1248" cy="85.7266" fill="#FEFECE" filter="url(#f12ply0i8jmok6)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1236" x2="1260" y1="99.7266" y2="99.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1214" y="3891.292">Bulk DAO</text><ellipse cx="1248" cy="3910.5938" fill="#FEFECE" filter="url(#f12ply0i8jmok6)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1236" x2="1260" y1="3924.5938" y2="3924.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1469" y="114.7217">Central Store</text><path d="M1495,65.7266 C1495,55.7266 1513,55.7266 1513,55.7266 C1513,55.7266 1531,55.7266 1531,65.7266 L1531,91.7266 C1531,101.7266 1513,101.7266 1513,101.7266 C1513,101.7266 1495,101.7266 1495,91.7266 L1495,65.7266 " fill="#FEFECE" filter="url(#f12ply0i8jmok6)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1495,65.7266 C1495,75.7266 1513,75.7266 1513,75.7266 C1513,75.7266 1531,75.7266 1531,65.7266 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1469" y="3891.292">Central Store</text><path d="M1495,3904.5938 C1495,3894.5938 1513,3894.5938 1513,3894.5938 C1513,3894.5938 1531,3894.5938 1531,3904.5938 L1531,3930.5938 C1531,3940.5938 1513,3940.5938 1513,3940.5938 C1513,3940.5938 1495,3940.5938 1495,3930.5938 L1495,3904.5938 " fill="#FEFECE" filter="url(#f12ply0i8jmok6)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1495,3904.5938 C1495,3914.5938 1513,3914.5938 1513,3914.5938 C1513,3914.5938 1531,3914.5938 1531,3904.5938 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="1567" y="82.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="1574" y="102.7217">BULK_PREP_HANDLER</text><rect fill="#FEFECE" filter="url(#f12ply0i8jmok6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="1567" y="3878.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="1574" y="3898.292">BULK_PREP_HANDLER</text><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="88" y="247.5547"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="88" y="2782.6563"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="193.5" y="173.2891"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="3741.2734" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="343.5" y="128.0234"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="795.5" y="3243.2422"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1133.5" y="3817.2969"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="165.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="1017.1406"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="120.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="1494.5313"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="121.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="1960.1328"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="151.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="2188.0625"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="166.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1243" y="2445.0625"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="92.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="1061.4063"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="1523.6641"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="1989.2656"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="2217.1953"/><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508" y="2474.1953"/><path d="M13,135.0234 L236,135.0234 L236,142.0234 L226,152.0234 L13,152.0234 L13,135.0234 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="3727.2734" style="stroke: #000000; stroke-width: 2.0;" width="1740" x="13" y="135.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="28" y="148.0903">Bulk Fulfil Handler Consume</text><polygon fill="#A80036" points="214.5,169.2891,204.5,173.2891,214.5,177.2891,210.5,173.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="208.5" x2="342.5" y1="173.2891" y2="173.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="220.5" y="168.2231">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="231.5" y="168.2231">Consume message</text><polygon fill="#A80036" points="109,243.5547,99,247.5547,109,251.5547,105,247.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="342.5" y1="247.5547" y2="247.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="115" y="234.9224">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="126" y="227.356">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="126" y="242.4888">using reference</text><polygon fill="#A80036" points="331.5,272.6875,341.5,276.6875,331.5,280.6875,335.5,276.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="93" x2="337.5" y1="276.6875" y2="276.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="100" y="271.6216">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="111" y="271.6216">Return payload</text><path d="M294,291.6875 L377,291.6875 L377,298.6875 L367,308.6875 L294,308.6875 L294,291.6875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="120.6641" style="stroke: #000000; stroke-width: 2.0;" width="362.5" x="294" y="291.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="309" y="304.7544">break</text><path d="M304,315.8203 L442,315.8203 L442,322.8203 L432,332.8203 L304,332.8203 L304,315.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="89.5313" style="stroke: #000000; stroke-width: 2.0;" width="342.5" x="304" y="315.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="319" y="328.8872">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="384.3516" y2="384.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="384.3516" y2="397.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="397.3516" y2="397.3516"/><polygon fill="#A80036" points="364.5,393.3516,354.5,397.3516,364.5,401.3516,360.5,397.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="360.5" y="364.1528">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="371.5" y="349.02">Validate event - Rule:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="263" x="371.5" y="364.1528">type == 'bulk-fulfil' &amp;&amp; action == 'bulk-commit'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="371.5" y="379.2856">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="451.5" y="379.2856">2001</text><path d="M304,426.3516 L514,426.3516 L514,433.3516 L504,443.3516 L304,443.3516 L304,426.3516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="769" x="304" y="426.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="319" y="439.4185">Persist Event Information</text><polygon fill="#A80036" points="1003.5,485.6172,1013.5,489.6172,1003.5,493.6172,1007.5,489.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1009.5" y1="489.6172" y2="489.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="360.5" y="484.5513">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="371.5" y="484.5513">Publish event information</text><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="751" x="311" y="497.6172"/><polygon fill="#EEEEEE" points="311,497.6172,375,497.6172,375,504.6172,365,514.6172,311,514.6172,311,497.6172" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="324" y="511.6841">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="616.5" y="530.6841">Event Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="619.5" y="545.8169"/><path d="M304,597.0156 L518,597.0156 L518,604.0156 L508,614.0156 L304,614.0156 L304,597.0156 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="102.5313" style="stroke: #000000; stroke-width: 2.0;" width="910" x="304" y="597.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="319" y="610.0825">Validate FSPIOP-Signature</text><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="892" x="311" y="639.1484"/><polygon fill="#EEEEEE" points="311,639.1484,375,639.1484,375,646.1484,365,656.1484,311,656.1484,311,639.1484" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="324" y="653.2153">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="602" y="672.2153">Validate message.content.headers.</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="804" y="672.2153">FSPIOP-Signature</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="602" y="687.3481">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="682" y="687.3481">3105/3106</text><path d="M264,713.5469 L485,713.5469 L485,720.5469 L475,730.5469 L264,730.5469 L264,713.5469 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1920.3125" style="stroke: #000000; stroke-width: 2.0;" width="1424" x="264" y="713.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="176" x="279" y="726.6138">Validate Bulk Fulfil Transfer</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="751.8125" y2="751.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="751.8125" y2="764.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="764.8125" y2="764.8125"/><polygon fill="#A80036" points="364.5,760.8125,354.5,764.8125,364.5,768.8125,360.5,764.8125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="360.5" y="746.7466">6</text><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="371.5" y="746.7466">Schema validation of the incoming message</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="809.0781" y2="809.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="809.0781" y2="822.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="822.0781" y2="822.0781"/><polygon fill="#A80036" points="364.5,818.0781,354.5,822.0781,364.5,826.0781,360.5,822.0781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="360.5" y="796.4458">7</text><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="371.5" y="788.8794">Verify the message's signature</text><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="371.5" y="804.0122">(to be confirmed in future requirement)</text><path d="M358,835.0781 L358,890.0781 L699,890.0781 L699,845.0781 L689,835.0781 L358,835.0781 " fill="#D3D3D3" filter="url(#f12ply0i8jmok6)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M689,835.0781 L689,845.0781 L699,845.0781 L689,835.0781 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="364" y="852.145">The above validation steps are already handled by</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="307" x="364" y="867.2778">the ML-Adapter for the open source implementation.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="320" x="364" y="882.4106">It may need to be added in future for custom adapters.</text><path d="M274,906.4766 L580,906.4766 L580,913.4766 L570,923.4766 L274,923.4766 L274,906.4766 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1190.0547" style="stroke: #000000; stroke-width: 2.0;" width="1404" x="274" y="906.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="261" x="289" y="919.5435">Validate Bulk Fulfilment Duplicate Check</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="944.7422" y2="944.7422"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="944.7422" y2="957.7422"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="957.7422" y2="957.7422"/><polygon fill="#A80036" points="364.5,953.7422,354.5,957.7422,364.5,961.7422,360.5,957.7422" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="360.5" y="939.6763">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="371.5" y="939.6763">Generate bulkTransferFulfilmentId UUID</text><polygon fill="#A80036" points="1231,1013.1406,1241,1017.1406,1231,1021.1406,1235,1017.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1237" y1="1017.1406" y2="1017.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="360.5" y="996.9419">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="371.5" y="981.8091">Request to retrieve Bulk transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="371.5" y="996.9419">fulfilment hashes by bulkTransferId</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="371.5" y="1012.0747">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="445.5" y="1012.0747">2003</text><polygon fill="#A80036" points="1496,1057.4063,1506,1061.4063,1496,1065.4063,1500,1061.4063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1253" x2="1502" y1="1061.4063" y2="1061.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1260" y="1048.7739">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="1278" y="1041.2075">Request Bulk transfer fulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="1278" y="1056.3403">duplicate message hashes</text><polygon fill="#FFFFE0" filter="url(#f12ply0i8jmok6)" points="1368,1074.4063,1658,1074.4063,1668,1100.4063,1658,1127.4063,1368,1127.4063,1358,1100.4063,1368,1074.4063" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="1370" y="1090.4731">SELET transferId, hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="1370" y="1105.606">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="248" x="1408" y="1105.606">bulkTransferFulfilmentDuplicateCheck</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="1370" y="1120.7388">WHERE bulkTransferId = request.params.id</text><polygon fill="#A80036" points="1264,1149.9375,1254,1153.9375,1264,1157.9375,1260,1153.9375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1258" x2="1512" y1="1153.9375" y2="1153.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1270" y="1148.8716">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="1288" y="1148.8716">Return existing hashes</text><polygon fill="#A80036" points="364.5,1179.0703,354.5,1183.0703,364.5,1187.0703,360.5,1183.0703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358.5" x2="1247" y1="1183.0703" y2="1183.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370.5" y="1178.0044">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="388.5" y="1178.0044">Return</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="431.5" y="1178.0044">(list of)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="478.5" y="1178.0044">transfer fulfil message hash(es)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="1242.4688" y2="1242.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="1242.4688" y2="1255.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="1255.4688" y2="1255.4688"/><polygon fill="#A80036" points="364.5,1251.4688,354.5,1255.4688,364.5,1259.4688,360.5,1255.4688" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="1222.27">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="378.5" y="1207.1372">Loop the list of returned hashes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="378.5" y="1222.27">and compare each entry with the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="378.5" y="1237.4028">calculated message hash</text><path d="M284,1270.4688 L347,1270.4688 L347,1277.4688 L337,1287.4688 L284,1287.4688 L284,1270.4688 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="819.0625" style="stroke: #000000; stroke-width: 2.0;" width="1361" x="284" y="1270.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="299" y="1283.5356">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84" x="362" y="1282.6792">[Hash matched]</text><path d="M304,1294.6016 L514,1294.6016 L514,1301.6016 L504,1311.6016 L304,1311.6016 L304,1294.6016 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="769" x="304" y="1294.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="319" y="1307.6685">Persist Event Information</text><polygon fill="#A80036" points="1003.5,1353.8672,1013.5,1357.8672,1003.5,1361.8672,1007.5,1357.8672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1009.5" y1="1357.8672" y2="1357.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="1352.8013">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="378.5" y="1352.8013">Publish event information</text><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="751" x="311" y="1365.8672"/><polygon fill="#EEEEEE" points="311,1365.8672,375,1365.8672,375,1372.8672,365,1382.8672,311,1382.8672,311,1365.8672" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="324" y="1379.9341">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="618" y="1398.9341">Event Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="621" y="1414.0669"/><polygon fill="#A80036" points="1231,1490.5313,1241,1494.5313,1231,1498.5313,1235,1494.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1237" y1="1494.5313" y2="1494.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="1481.8989">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="378.5" y="1474.3325">Request to retrieve Bulk transfer state</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="378.5" y="1489.4653">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="452.5" y="1489.4653">2003</text><polygon fill="#A80036" points="1496,1519.6641,1506,1523.6641,1496,1527.6641,1500,1523.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1253" x2="1502" y1="1523.6641" y2="1523.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1260" y="1518.5981">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="1278" y="1518.5981">Request to retrieve Bulk transfer state</text><polygon fill="#FFFFE0" filter="url(#f12ply0i8jmok6)" points="1437,1536.6641,1589,1536.6641,1599,1547.6641,1589,1559.6641,1437,1559.6641,1427,1547.6641,1437,1536.6641" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="1439" y="1552.731">bulkTransferStateChange</text><polygon fill="#A80036" points="1264,1581.9297,1254,1585.9297,1264,1589.9297,1260,1585.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1258" x2="1512" y1="1585.9297" y2="1585.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1270" y="1580.8638">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="1288" y="1580.8638">Return Bulk transfer state</text><polygon fill="#A80036" points="364.5,1611.0625,354.5,1615.0625,364.5,1619.0625,360.5,1615.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358.5" x2="1247" y1="1615.0625" y2="1615.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370.5" y="1609.9966">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="388.5" y="1609.9966">Return Bulk transfer state</text><path d="M294,1630.0625 L357,1630.0625 L357,1637.0625 L347,1647.0625 L294,1647.0625 L294,1630.0625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="272" style="stroke: #000000; stroke-width: 2.0;" width="930" x="294" y="1630.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="309" y="1643.1294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="264" x="372" y="1642.2729">[bulkTransferState IN ['COMPLETED', 'REJECTED']]</text><path d="M304,1654.1953 L387,1654.1953 L387,1661.1953 L377,1671.1953 L304,1671.1953 L304,1654.1953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="77.5313" style="stroke: #000000; stroke-width: 2.0;" width="910" x="304" y="1654.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="319" y="1667.2622">break</text><rect fill="#FFFFFF" filter="url(#f12ply0i8jmok6)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="892" x="311" y="1671.3281"/><polygon fill="#EEEEEE" points="311,1671.3281,375,1671.3281,375,1678.3281,365,1688.3281,311,1688.3281,311,1671.3281" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="324" y="1685.395">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="647" y="1704.395">Send notification to Participant (Payee)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="650" y="1719.5278"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="294" x2="1224" y1="1739.7266" y2="1739.7266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="299" y="1749.937">[transferState NOT 'ACCEPTED']</text><path d="M304,1760.5313 L387,1760.5313 L387,1767.5313 L377,1777.5313 L304,1777.5313 L304,1760.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="188.5" x="304" y="1760.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="319" y="1773.5981">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="1798.7969" y2="1798.7969"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="1798.7969" y2="1811.7969"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="1811.7969" y2="1811.7969"/><polygon fill="#A80036" points="364.5,1807.7969,354.5,1811.7969,364.5,1815.7969,360.5,1811.7969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="1793.731">19</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="378.5" y="1793.731">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="452.5" y="1793.731">2001</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="294" x2="1224" y1="1827.7969" y2="1827.7969"/><path d="M304,1835.7969 L387,1835.7969 L387,1842.7969 L377,1852.7969 L304,1852.7969 L304,1835.7969 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="292.5" x="304" y="1835.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="319" y="1848.8638">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="1874.0625" y2="1874.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="1874.0625" y2="1887.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="1887.0625" y2="1887.0625"/><polygon fill="#A80036" points="364.5,1883.0625,354.5,1887.0625,364.5,1891.0625,360.5,1887.0625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="1868.9966">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="378.5" y="1868.9966">Allow previous request to complete</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="284" x2="1645" y1="1910.0625" y2="1910.0625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="289" y="1920.2729">[Hash not matched]</text><polygon fill="#A80036" points="1231,1956.1328,1241,1960.1328,1231,1964.1328,1235,1960.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1237" y1="1960.1328" y2="1960.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="1947.5005">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="378.5" y="1939.9341">Request to persist transfer hash</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="378.5" y="1955.0669">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="458.5" y="1955.0669">2003</text><polygon fill="#A80036" points="1496,1985.2656,1506,1989.2656,1496,1993.2656,1500,1989.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1253" x2="1502" y1="1989.2656" y2="1989.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1260" y="1984.1997">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="1278" y="1984.1997">Persist hash</text><polygon fill="#FFFFE0" filter="url(#f12ply0i8jmok6)" points="1400,2032.2656,1625,2032.2656,1635,2043.2656,1625,2055.2656,1400,2055.2656,1390,2043.2656,1400,2032.2656" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="1402" y="2048.3325">bulkTransferFulfilmentDuplicateCheck</text><polygon fill="#A80036" points="364.5,2077.5313,354.5,2081.5313,364.5,2085.5313,360.5,2081.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358.5" x2="1247" y1="2081.5313" y2="2081.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370.5" y="2076.4653">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="388.5" y="2076.4653">Return success</text><path d="M294,2110.5313 L357,2110.5313 L357,2117.5313 L347,2127.5313 L294,2127.5313 L294,2110.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="516.3281" style="stroke: #000000; stroke-width: 2.0;" width="1325" x="294" y="2110.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="309" y="2123.5981">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="372" y="2122.7417">[Validate Bulk Transfer Fulfil (success)]</text><path d="M304,2134.6641 L770,2134.6641 L770,2141.6641 L760,2151.6641 L304,2151.6641 L304,2134.6641 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="213.0625" style="stroke: #000000; stroke-width: 2.0;" width="1305" x="304" y="2134.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="421" x="319" y="2147.731">Persist Bulk Transfer State (with bulktransferState='PROCESSING')</text><polygon fill="#A80036" points="1231,2184.0625,1241,2188.0625,1231,2192.0625,1235,2188.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1237" y1="2188.0625" y2="2188.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="2175.4302">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="378.5" y="2167.8638">Request to persist bulk transfer fulfil</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="378.5" y="2182.9966">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="458.5" y="2182.9966">2003</text><polygon fill="#A80036" points="1496,2213.1953,1506,2217.1953,1496,2221.1953,1500,2217.1953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1253" x2="1502" y1="2217.1953" y2="2217.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1260" y="2212.1294">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="1278" y="2212.1294">Persist bulkTransferFulfilment</text><polygon fill="#FFFFE0" filter="url(#f12ply0i8jmok6)" points="1437,2260.1953,1589,2260.1953,1599,2286.1953,1589,2313.1953,1437,2313.1953,1427,2286.1953,1437,2260.1953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="1439" y="2276.2622">bulkTransferFulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="1439" y="2291.395">bulkTransferStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="1439" y="2306.5278">bulkTransferExtension</text><polygon fill="#A80036" points="364.5,2335.7266,354.5,2339.7266,364.5,2343.7266,360.5,2339.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358.5" x2="1247" y1="2339.7266" y2="2339.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370.5" y="2334.6606">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="388.5" y="2334.6606">Return success</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="294" x2="1619" y1="2355.7266" y2="2355.7266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="299" y="2365.937">[Validate Bulk Transfer Fulfil (failure)]</text><path d="M304,2376.5313 L805,2376.5313 L805,2383.5313 L795,2393.5313 L304,2393.5313 L304,2376.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="243.3281" style="stroke: #000000; stroke-width: 2.0;" width="1305" x="304" y="2376.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="456" x="319" y="2389.5981">Persist Bulk Transfer State (with bulkTransferState='INVALID/REJECTED')</text><polygon fill="#A80036" points="1231,2441.0625,1241,2445.0625,1231,2449.0625,1235,2445.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1237" y1="2445.0625" y2="2445.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="2424.8638">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="378.5" y="2409.731">Request to persist bulk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="378.5" y="2424.8638">transfer fulfil failure</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="378.5" y="2439.9966">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="458.5" y="2439.9966">2003</text><polygon fill="#A80036" points="1496,2470.1953,1506,2474.1953,1496,2478.1953,1500,2474.1953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1253" x2="1502" y1="2474.1953" y2="2474.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1260" y="2469.1294">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="1278" y="2469.1294">Persist transfer</text><polygon fill="#FFFFE0" filter="url(#f12ply0i8jmok6)" points="1437,2517.1953,1589,2517.1953,1599,2551.1953,1589,2585.1953,1437,2585.1953,1427,2551.1953,1437,2517.1953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="1439" y="2533.2622">bulkTransferFulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="1439" y="2548.395">bulkTransferStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="1439" y="2563.5278">bulkTransferExtension</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="1439" y="2578.6606">bulkTransferError</text><polygon fill="#A80036" points="364.5,2607.8594,354.5,2611.8594,364.5,2615.8594,360.5,2611.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358.5" x2="1247" y1="2611.8594" y2="2611.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370.5" y="2606.7935">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="388.5" y="2606.7935">Return success</text><path d="M23,2647.8594 L86,2647.8594 L86,2654.8594 L76,2664.8594 L23,2664.8594 L23,2647.8594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1207.4375" style="stroke: #000000; stroke-width: 2.0;" width="1720" x="23" y="2647.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="38" y="2660.9263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="101" y="2660.0698">[Validate Bulk Transfer Fulfil (success)]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="395.5" y1="2701.2578" y2="2701.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="395.5" y1="2701.2578" y2="2714.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="395.5" y1="2714.2578" y2="2714.2578"/><polygon fill="#A80036" points="364.5,2710.2578,354.5,2714.2578,364.5,2718.2578,360.5,2714.2578" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="2688.6255">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="261" x="378.5" y="2681.0591">Break down the bulk into indidivual transfers</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="378.5" y="2696.1919">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="458.5" y="2696.1919">2003</text><path d="M33,2729.2578 L106,2729.2578 L106,2736.2578 L96,2746.2578 L33,2746.2578 L33,2729.2578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="551.9844" style="stroke: #000000; stroke-width: 2.0;" width="1700" x="33" y="2729.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="48" y="2742.3247">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="267" x="121" y="2741.4683">[for every individual transfer in the bulk fulfil list]</text><polygon fill="#A80036" points="109,2778.6563,99,2782.6563,109,2786.6563,105,2782.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="1644" y1="2782.6563" y2="2782.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="115" y="2770.0239">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="133" y="2762.4575">Retrieve each individual transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="133" y="2777.5903">in the bulk using the reference</text><polygon fill="#A80036" points="1633,2807.7891,1643,2811.7891,1633,2815.7891,1637,2811.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="93" x2="1639" y1="2811.7891" y2="2811.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="100" y="2806.7231">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="118" y="2806.7231">Return individual transfers as queried</text><path d="M358,2824.7891 L358,3197.7891 L595,3197.7891 L595,2834.7891 L585,2824.7891 L358,2824.7891 " fill="#FFFF00" filter="url(#f12ply0i8jmok6)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M585,2824.7891 L585,2834.7891 L595,2834.7891 L585,2824.7891 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="364" y="2841.856">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="364" y="2856.9888">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="376" y="2872.1216">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="376" y="2887.2544">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="376" y="2902.3872">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="376" y="2917.52">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="376" y="2932.6528">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="388" y="2947.7856">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="388" y="2962.9185">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="376" y="2978.0513">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="376" y="2993.1841">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="388" y="3008.3169">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="400" y="3023.4497">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="400" y="3038.5825">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="400" y="3053.7153">type: bulk-fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="400" y="3068.8481">action: fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="400" y="3083.981">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="400" y="3099.1138">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="412" y="3114.2466">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="412" y="3129.3794">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="400" y="3144.5122">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="388" y="3159.645">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="376" y="3174.7778">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="364" y="3189.9106">}</text><polygon fill="#A80036" points="783.5,3239.2422,793.5,3243.2422,783.5,3247.2422,787.5,3243.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="789.5" y1="3243.2422" y2="3243.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="3230.6099">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="405" x="378.5" y="3223.0435">Route &amp; Publish Prepare event to the Payer for the Individual Transfer</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="378.5" y="3238.1763">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="458.5" y="3238.1763">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1743" y1="3289.2422" y2="3289.2422"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="28" y="3299.4526">[Validate Bulk Transfer Fulfil (failure)]</text><path d="M358,3308.0469 L358,3771.0469 L885,3771.0469 L885,3318.0469 L875,3308.0469 L358,3308.0469 " fill="#FFFF00" filter="url(#f12ply0i8jmok6)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M875,3308.0469 L875,3318.0469 L885,3318.0469 L875,3308.0469 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="364" y="3325.1138">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="364" y="3340.2466">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="376" y="3355.3794">id: &lt;bulkTransferMessage.bulkTransferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="376" y="3370.5122">from: &lt;ledgerName&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="376" y="3385.645">to: &lt;bulkTransferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="376" y="3400.7778">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="376" y="3415.9106">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="388" y="3431.0435">headers: &lt;bulkTransferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="388" y="3446.1763">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="400" y="3461.3091">"errorInformation": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="458" x="412" y="3476.4419">"errorCode": &lt;possible codes: [2003, 3100, 3105, 3106, 3202, 3203, 3300, 3301]&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="354" x="412" y="3491.5747">"errorDescription": "&lt;refer to section 35.1.3 for description&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="284" x="412" y="3506.7075">"extensionList": &lt;transferMessage.extensionList&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="388" y="3521.8403">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="376" y="3536.9731">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="376" y="3552.106">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="388" y="3567.2388">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="400" y="3582.3716">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="400" y="3597.5044">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="400" y="3612.6372">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="400" y="3627.77">action: bulk-abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="400" y="3642.9028">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="400" y="3658.0356">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="412" y="3673.1685">status: 'error',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="412" y="3688.3013">code: &lt;errorInformation.errorCode&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="287" x="412" y="3703.4341">description: &lt;errorInformation.errorDescription&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="400" y="3718.5669">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="388" y="3733.6997">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="376" y="3748.8325">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="364" y="3763.9653">}</text><polygon fill="#A80036" points="1121.5,3813.2969,1131.5,3817.2969,1121.5,3821.2969,1125.5,3817.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="1127.5" y1="3817.2969" y2="3817.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="360.5" y="3804.6646">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="378.5" y="3797.0981">Publish Notification (failure) event for Payer</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="378.5" y="3812.231">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="458.5" y="3812.231">2003</text><!--
@startuml
title 2.1.1. Bulk Fulfil Handler Consume

autonumber


collections "mongo-\nobject-store" as OBJECT_STORE
collections "topic-bulk-\nfulfil" as TOPIC_BULK_FULFIL
collections "topic-bulk-\nprocessing" as TOPIC_BULK_PROCESSING
control "Bulk Fulfil\nHandler" as BULK_FULF_HANDLER
collections "topic-transfer-\nfulfil" as TOPIC_TRANSFER_FULFIL
collections "topic-event" as TOPIC_EVENTS
collections "topic-notification" as TOPIC_NOTIFICATION
entity "Bulk DAO" as BULK_DAO
database "Central Store" as DB

box "Central Service" #LightYellow
    participant OBJECT_STORE
    participant TOPIC_BULK_FULFIL
    participant BULK_FULF_HANDLER
    participant TOPIC_TRANSFER_FULFIL
    participant TOPIC_BULK_PROCESSING
    participant TOPIC_EVENTS
    participant TOPIC_NOTIFICATION
    participant BULK_DAO
    participant DB
end box

activate BULK_FULF_HANDLER
group Bulk Fulfil Handler Consume
    TOPIC_BULK_FULFIL <- BULK_FULF_HANDLER: Consume message
    activate TOPIC_BULK_FULFIL
    deactivate TOPIC_BULK_FULFIL

    BULK_FULF_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> BULK_FULF_HANDLER: Return payload
    deactivate OBJECT_STORE

    break
        group Validate Event
            BULK_FULF_HANDLER <-> BULK_FULF_HANDLER: Validate event - Rule:\ntype == 'bulk-fulfil' && action == 'bulk-commit'\n<color #FF0000><b>Error codes:</b> 2001</color>
        end
    end

    group Persist Event Information
        |||
        BULK_FULF_HANDLER -> TOPIC_EVENTS: Publish event information
        ref over BULK_FULF_HANDLER, TOPIC_EVENTS:  Event Handler Consume \n
        |||
    end

    group Validate FSPIOP-Signature
        |||
        ref over BULK_FULF_HANDLER, TOPIC_NOTIFICATION: Validate message.content.headers.**FSPIOP-Signature**\n<color #FF0000><b>Error codes:</b> 3105/3106</color>
    end

    group Validate Bulk Fulfil Transfer
        BULK_FULF_HANDLER <-> BULK_FULF_HANDLER: <color #gray>Schema validation of the incoming message</color>
        BULK_FULF_HANDLER <-> BULK_FULF_HANDLER: <color #gray>Verify the message's signature</color>\n<color #gray>(to be confirmed in future requirement)</color>
        note right of BULK_FULF_HANDLER #lightgrey
            The above validation steps are already handled by
            the ML-Adapter for the open source implementation.
            It may need to be added in future for custom adapters.
        end note
        group Validate Bulk Fulfilment Duplicate Check
            BULK_FULF_HANDLER -> BULK_FULF_HANDLER: Generate bulkTransferFulfilmentId UUID
            BULK_FULF_HANDLER -> BULK_DAO: Request to retrieve Bulk transfer\nfulfilment hashes by bulkTransferId\n<color #FF0000><b>Error code:</b> 2003</color>
            activate BULK_DAO
            BULK_DAO -> DB: Request Bulk transfer fulfilment\nduplicate message hashes
            hnote over DB #lightyellow
                SELET transferId, hash
                FROM **bulkTransferFulfilmentDuplicateCheck**
                WHERE bulkTransferId = request.params.id
            end note
            activate DB
            BULK_DAO <- - DB: Return existing hashes
            deactivate DB
            BULK_DAO - -> BULK_FULF_HANDLER: Return <color #red>**(list of)**</color> transfer fulfil message hash(es)
            deactivate BULK_DAO
            BULK_FULF_HANDLER -> BULK_FULF_HANDLER: Loop the list of returned hashes\nand compare each entry with the\ncalculated message hash

            alt Hash matched
                group Persist Event Information
                    |||
                    BULK_FULF_HANDLER -> TOPIC_EVENTS: Publish event information
                    ref over BULK_FULF_HANDLER, TOPIC_EVENTS:  Event Handler Consume\n
                    |||
                end
                BULK_FULF_HANDLER -> BULK_DAO: Request to retrieve Bulk transfer state\n<color #FF0000><b>Error code:</b> 2003</color>
                activate BULK_DAO
                BULK_DAO -> DB: Request to retrieve Bulk transfer state
                hnote over DB #lightyellow
                    bulkTransferStateChange
                end note
                activate DB
                BULK_DAO <- - DB: Return Bulk transfer state
                deactivate DB
                BULK_DAO - -> BULK_FULF_HANDLER: Return Bulk transfer state
                deactivate BULK_DAO
                alt bulkTransferState IN ['COMPLETED', 'REJECTED']
                    break
                        ref over BULK_FULF_HANDLER, TOPIC_NOTIFICATION: Send notification to Participant (Payee)\n
                    end
                else transferState NOT 'ACCEPTED'
                    break
                        BULK_FULF_HANDLER <-> BULK_FULF_HANDLER: <color #FF0000><b>Error code:</b> 2001</color>
                    end
                else
                    break
                        BULK_FULF_HANDLER <-> BULK_FULF_HANDLER: Allow previous request to complete
                    end
                end
            else Hash not matched
                BULK_FULF_HANDLER -> BULK_DAO: Request to persist transfer hash\n<color #FF0000><b>Error codes:</b> 2003</color>
                activate BULK_DAO
                BULK_DAO -> DB: Persist hash
                hnote over DB #lightyellow
                    bulkTransferFulfilmentDuplicateCheck
                end note
                activate DB
                deactivate DB
                BULK_DAO - -> BULK_FULF_HANDLER: Return success
                deactivate BULK_DAO
            end
            
        end
        
        alt Validate Bulk Transfer Fulfil (success)
            group Persist Bulk Transfer State (with bulktransferState='PROCESSING')
                BULK_FULF_HANDLER -> BULK_DAO: Request to persist bulk transfer fulfil\n<color #FF0000><b>Error codes:</b> 2003</color>
                activate BULK_DAO
                BULK_DAO -> DB: Persist bulkTransferFulfilment
                hnote over DB #lightyellow
                    bulkTransferFulfilment
                    bulkTransferStateChange
                    bulkTransferExtension
                end note
                activate DB
                deactivate DB
                BULK_DAO - -> BULK_FULF_HANDLER: Return success
                deactivate BULK_DAO
            end
        else Validate Bulk Transfer Fulfil (failure)
            group Persist Bulk Transfer State (with bulkTransferState='INVALID/REJECTED')
                BULK_FULF_HANDLER -> BULK_DAO: Request to persist bulk\ntransfer fulfil failure\n<color #FF0000><b>Error codes:</b> 2003</color>
                activate BULK_DAO
                BULK_DAO -> DB: Persist transfer
                hnote over DB #lightyellow
                    bulkTransferFulfilment
                    bulkTransferStateChange
                    bulkTransferExtension
                    bulkTransferError
                end note
                activate DB
                deactivate DB
                BULK_DAO - -> BULK_FULF_HANDLER: Return success
                deactivate BULK_DAO
            end
        end

    end
    alt Validate Bulk Transfer Fulfil (success)
        BULK_FULF_HANDLER -> BULK_FULF_HANDLER: Break down the bulk into indidivual transfers\n<color #FF0000><b>Error codes:</b> 2003</color>
        loop for every individual transfer in the bulk fulfil list
            BULK_PREP_HANDLER -> OBJECT_STORE: Retrieve each individual transfer\nin the bulk using the reference
            activate OBJECT_STORE
            OBJECT_STORE - -> BULK_PREP_HANDLER: Return individual transfers as queried
            deactivate OBJECT_STORE

            note right of BULK_FULF_HANDLER #yellow
                Message:
                {
                    id: <transferMessage.transferId>
                    from: <transferMessage.payerFsp>,
                    to: <transferMessage.payeeFsp>,
                    type: application/json
                    content: {
                        headers: <transferHeaders>,
                        payload: <transferMessage>
                    },
                    metadata: {
                        event: {
                            id: <uuid>,
                            responseTo: <previous.uuid>,
                            type: bulk-fulfil,
                            action: fulfil,
                            createdAt: <timestamp>,
                            state: {
                                status: "success",
                                code: 0
                            }
                        }
                    }
                }
            end note
            BULK_FULF_HANDLER -> TOPIC_TRANSFER_FULFIL: Route & Publish Prepare event to the Payer for the Individual Transfer\n<color #FF0000><b>Error codes:</b> 2003</color>
            activate TOPIC_TRANSFER_FULFIL
            deactivate TOPIC_TRANSFER_FULFIL
        end
    else Validate Bulk Transfer Fulfil (failure)
        note right of BULK_FULF_HANDLER #yellow
            Message:
            {
                id: <bulkTransferMessage.bulkTransferId>
                from: <ledgerName>,
                to: <bulkTransferMessage.payerFsp>,
                type: application/json
                content: {
                    headers: <bulkTransferHeaders>,
                    payload: {
                        "errorInformation": {
                            "errorCode": <possible codes: [2003, 3100, 3105, 3106, 3202, 3203, 3300, 3301]>
                            "errorDescription": "<refer to section 35.1.3 for description>",
                            "extensionList": <transferMessage.extensionList>
                    }
                },
                metadata: {
                    event: {
                        id: <uuid>,
                        responseTo: <previous.uuid>,
                        type: bulk-processing,
                        action: bulk-abort,
                        createdAt: <timestamp>,
                        state: {
                            status: 'error',
                            code: <errorInformation.errorCode>
                            description: <errorInformation.errorDescription>
                        }
                    }
                }
            }
        end note
        BULK_FULF_HANDLER -> TOPIC_NOTIFICATION: Publish Notification (failure) event for Payer\n<color #FF0000><b>Error codes:</b> 2003</color>
        activate TOPIC_NOTIFICATION
        deactivate TOPIC_NOTIFICATION
    end
end
deactivate BULK_FULF_HANDLER
@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="254px" preserveAspectRatio="none" style="width:512px;height:254px;background:#000000;" version="1.1" viewBox="0 0 512 254" width="512px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="211.1348" style="stroke: #FFFFFF; stroke-width: 1.0;" width="511" x="0" y="0"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="5" y="16.1387">Welcome to PlantUML!</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="8" y="30.1074"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="251" x="5" y="44.0762">If you use this software, you accept its license.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="5" y="59.9023">(details by typing</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="39" x="99" y="59.4805">license</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="141" y="59.9023">keyword)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="8" y="73.8711"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="250" x="5" y="87.8398">You can start with a simple UML Diagram like:</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="8" y="101.8086"/><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="5" y="117.2129">Bob-&gt;Alice:Hello</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="8" y="131.6035"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="13" x="5" y="145.5723">Or</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="8" y="159.541"/><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="5" y="174.9453">classExample</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="8" y="189.3359"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="309" x="5" y="203.3047">You will find more information about PlantUML syntax on</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="109" x="317" y="203.3047">http://plantuml.com</text><line style="stroke: #000000; stroke-width: 1.0;" x1="317" x2="426" y1="205.3047" y2="205.3047"/><image height="71" width="80" x="425" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABHCAMAAACnHDC8AAADAFBMVEX///+BpbvD3u/f7vfPz8+nz+g3ksuZEDkWADr/ujlvsdpTodLCwsOLwOEbg8T//v6pqamZETnLysvT09To5+jqLS4VATj9/f27u7vDw8MTfsK+v7/j4+SOweJprdjL4/KxsbEri8jk8PgXa57c29uUETez1utQoNJ1tNtEmc9cptWBut6ayOW/3O6YEDjY6vUfhcXBwcHs7Ozw9/v83t79uTn7+/vX19ehoaHx8fG2tLXHx8fuVlfrNTYaBjn/vUH5+fmko6WXl5f/+fn95ub+9PT+8PD3qKidmaMxIUrnqDWcFj7n5eX09PTu7u2SkpKfnZ6rq6z0lJTm4tzJrHUfDT339/eFGDn6tjcrEzOvrbBuZ3l4eomSMS7Hz9Smpqasu8SFiYuQETfa2du1m6OOM051J0NWTWL5xse4uLj6zc33r6/4vb7ydHXqLi/72dntTE3tR0ijbn5jW3C+u8NANVQrG0XFubqRVGZza4GQGT2VaS7a0NPJtI6IJj/zszrfqkXXzr/Hw8cgC0LUqltOQ2JsSC5bTGjOpFafSi2+iDGtyt14m7TJhTCPJUSwoIG/qa+ikHiIgpCRHjI9j8KXbnaQH0FLf6FGPlp0cnYyKE2rg49Wj7dFXHmcwtrp6uu+xMjvYWLvW1z97e3sPD3sP0DuUlP709PYzdDPmzqZWWySRVygfHHd1smWkZ+PgnibETqsl260q5fLuppJLC/dpj2HPFLTtHv/ujrTwJy5s6iWjIi0iD3joTTCmU3trjuvZS2zlFvjq0HSyLbYp0qRts10XGxEKC9yPVBQZIOPdlNvMk2NeYNqRlujtcCVrr3j5eY1gK9Qn9GLp7lbeJXRxrCkiZDaozyukoJ+H0B3rc+OYy+iprJkYXdhmr6ee0afs79xq9BikrGKjI3FomEiLFO0ay6nfIm4pZXRjTFuhZSZWm0zcZyJN0KNTk4eebNfdIGGlZ93h5kcED5nOVYyRWbziIk9dJ4kerE5ZYxRUnLG1d7p8PTvY2PtTk/1nZ1ycV/bAAAFfElEQVR42mNgoB7IABFMVDTwlTOVDVyiDiSYqWjgwc93GagJshdRNwzzL8WCKEZqmeemfZp9L5BmoZb7mIwPH2Fg4DelkgtzLpocPsPgxsPwmToudGcyvnzGjSfk0AzqeNn9XPzfCcv/nZi/mzr+dRctcGNYbmsDyijUcCF/nPqvXfy/GTj2UCuCRW0YGExEbfkZqJSwr2kYgqgbqtQycLcBsEAQ7GfIBTuRGoWDwOK3p+59fb4r8jSVDLx7dOnR+2+03v55RLWCwSQbmFlEF1LLywwMz/53rud1enyaioWhM0OGO1VLVwZ+F2qapmIEZ1KjcPBj5gOG4ksIh/JIMWPlPv7ypqQZ11PqGGiox/TtDcefF/fFf6s9p4KBHzku/foNNPAX81t+ga98Xyk2sHNRoNdqsIGMnG87HrC/o9RAxmntyl+5P4AN/HPV+M99SispRt4frP8f/DT9wsYo+F3+/+k/FLuQHWjEZDU2zVvy6s+uPmH6RxUXMv/4G/f+yFtQsv5Daaph5GPj5uJlZWKWhOYTJgYqg1EDB5GBn+nlwpoJ6CrWHkYXKSnBYyBq1hPJYF6Q5nAISSRY236fqOZ1JBHhrNNPbZ5/Q856TH/+M7L+ArsPJeuFuX6uBFL9gWmboSKWLq6guqz87+EDMCtT74AkHVMTP6JkPUbOL+Cc8gdhIH8o4yIoM067AFy41wq6QkXqf9aDrbR5MgkqUvu3DquBcC+XZyzfB2NfvHVz/TuGq8wzemH1RuhjUaVb/I7eRSdhag79jPr2HLeXVzBVIxomLo9vMvT/9y/ZCDPuFNhGQfYC1PB3/L8Dhwt9fN6WfkQovGeodG/nzhfGMBdDqrPfZ0UlbqAY+OBB44UfWFzo6weOCxDgAkWe+k2II+VSTHygroM5yWbHKYbqViQRX4/aN2iRIu4LjwuomVyyQBNXhgPZPbozNqL6slErBL0txy6PamD68ZvIpkERPCUZ1KDq13G7tx5VhO/+8kLkMPxw8dlFuORvGGJYuQYscPV2EaPYU+RO9nHJ2O8JyJnnZ9dCWd9NiDBU/n6PKWMpqqVAbyMc2RPsfwXN37aOaP6eFCEI97Lyd7GP1/4KoxiHqlpdv0cBVcS/uQ7d300710O9LPSH+2eVeE3hdGR/o4C3e5a9eIUiwurEsQNVDTvLw6cQL4MN/HxnnYyZ9GUczd280HeTZqJ0TI6t/PPwJ7JI/OddkIBm+gdrH/Z92ZZpg8W48qjETQwMekgim/9HHWc45bkfIZL79OZ5LA3OkE3XqjagGRcQulwDRBvDRRawJTwB0XZwA/MuHTmOpAWpBRv4Kb8sArmrEW28KAS1GHZ0rb4DYV2FZRXbrieoBWzbIWAYCv1n+sXK9PNGp7spIlEWipbCUqDqB1Cs+DdO3fAOVsyCjeHz2b3uE0oF8I/5yO6gFTADOd5+c639CCkB1t+5uwSuTqxgFQPDjtfVHxDdCFCsAOPiO1qNAioc5r/lmPqP+QsX8yf+m4rsn/a+iX3EUP7s5WZkhS2tW//MWYUs4rk/9+mdU+hxCC2x41o+RMANFPi8alaB3RtoHXDbEmxwv3LDOWiT/5gT2ODiqx+hcWH0SOcAwkBweXjxaEzkArCXBVl+cvzac74DmlkMpd7/ZgEF0vue5xARBQnOC06g4uTvQWhkCCjaifI8QPYypPLZz+cFc6HgC1hkCGg8NH59EiUhffx18wNKIzDgABMj4xu4C2EJ4o1u7TVi6vEXDAwc/BhdATlsFf0ie+eZ6Cp5biielUcR0T7/XxS1lXqYQcP8HFILFFnuwr+9i1C8TDJArpchNTLTfgoNRGvbLPrWeIbazSeZBX+kydbMgnX8UFjvMLkG+q4HABVtKp9tQ9JtAAAAAElFTkSuQmCC" y="6"/><rect fill="#000000" height="42.5938" style="stroke: #000000; stroke-width: 1.0;" width="511" x="0" y="211.1348"/><text fill="#33FF02" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="5" y="229.1299">@startuml</text><text fill="#33FF02" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="9" y="245.4268"/><text fill="#FF0000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="9" y="245.4268">Empty description</text><!--
@startuml


@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>