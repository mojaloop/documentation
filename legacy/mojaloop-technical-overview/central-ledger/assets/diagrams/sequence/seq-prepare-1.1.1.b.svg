<svg xmlns="http://www.w3.org/2000/svg" height="2303" preserveAspectRatio="none" style="width:1991px;height:2303px" width="1991">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="466" x="760.5" y="28.708">
    1.1.1.b. Prepare Handler Consume (batch messages)
  </text>
  <path fill="#FFFFE0" stroke="#a80036" d="M57 40.953h1863v2256.289H57z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="933" y="53.02">
    Central Service
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M142.5 216.781h10v30h-10zM526.5 132.383h10v2089.563h-10zM1058.5 2169.945h10v30h-10zM1468.5 1000.836h10v120.531h-10zM1468.5 1625.227h10v121.398h-10zM1583 470.711h10v120.531h-10zM1583 735.773h10v120.531h-10zM1863 499.844h10v62.266h-10zM1863 764.906h10v62.266h-10zM1863 1029.969h10v62.266h-10zM1863 1654.359h10v30h-10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M10 139.383h1967v2075.563H10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M441.5 261.781h833v156.664h-833zM441.5 432.445H1926v251.063H441.5zM441.5 697.508H1926v251.063H441.5zM441.5 962.57H1926v208.93H441.5zM421.5 1185.5H1967v1022.445H421.5z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M431.5 1209.633h642v363.328h-642z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M441.5 1233.766h619v59.266h-619zM441.5 1307.031h622v59.266h-622zM441.5 1380.297h562v59.266h-562zM441.5 1586.961H1957v167.664H441.5z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M147 122.383v2109.562M531.5 122.383v2109.562M1063.5 122.383v2109.562M1212.5 122.383v2109.562M1344.5 122.383v2109.562M1473.5 122.383v2109.562M1587.5 122.383v2109.562M1868 122.383v2109.562"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M65 83.086h165v30.297H65z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M61 87.086h165v30.297H61z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="68" y="107.081">
    topic-transfer-prepare
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M65 2230.945h165v30.297H65z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M61 2234.945h165v30.297H61z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="68" y="2254.94">
    topic-transfer-prepare
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="451.5" y="119.081">
    Prepare Event Handler
  </text>
  <circle cx="531.5" cy="90.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M527.5 78.086l6-5-2 5 2 5-6-5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="451.5" y="2243.94">
    Prepare Event Handler
  </text>
  <circle cx="531.5" cy="2263.242" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M527.5 2251.242l6-5-2 5 2 5-6-5z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M980.5 83.086h166v30.297h-166z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M976.5 87.086h166v30.297h-166z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="983.5" y="107.081">
    topic-transfer-position
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M980.5 2230.945h166v30.297h-166z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M976.5 2234.945h166v30.297h-166z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="983.5" y="2254.94">
    topic-transfer-position
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1164.5 83.086h96v30.297h-96z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1160.5 87.086h96v30.297h-96z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1167.5" y="107.081">
    Event-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1164.5 2230.945h96v30.297h-96z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1160.5 2234.945h96v30.297h-96z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1167.5" y="2254.94">
    Event-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1278.5 83.086h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1274.5 87.086h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1281.5" y="107.081">
    Notification-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1278.5 2230.945h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1274.5 2234.945h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1281.5" y="2254.94">
    Notification-Topic
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1425.5" y="119.081">
    Position DAO
  </text>
  <circle cx="1473.5" cy="90.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M1461.5 104.086h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1425.5" y="2243.94">
    Position DAO
  </text>
  <circle cx="1473.5" cy="2263.242" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M1461.5 2277.242h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="1531.5" y="119.081">
    Participant DAO
  </text>
  <circle cx="1588" cy="90.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M1576 104.086h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="1531.5" y="2243.94">
    Participant DAO
  </text>
  <circle cx="1588" cy="2263.242" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M1576 2277.242h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1820" y="119.081">
    Central Store
  </text>
  <path d="M1850 70.086c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10v-26" fill="#FEFECE" filter="url(#a)" stroke="#000" stroke-width="1.5"/>
  <path d="M1850 70.086c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#000" stroke-width="1.5"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1820" y="2243.94">
    Central Store
  </text>
  <path d="M1850 2257.242c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10v-26" fill="#FEFECE" filter="url(#a)" stroke="#000" stroke-width="1.5"/>
  <path d="M1850 2257.242c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#000" stroke-width="1.5"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M142.5 216.781h10v30h-10zM526.5 132.383h10v2089.563h-10zM1058.5 2169.945h10v30h-10zM1468.5 1000.836h10v120.531h-10zM1468.5 1625.227h10v121.398h-10zM1583 470.711h10v120.531h-10zM1583 735.773h10v120.531h-10zM1863 499.844h10v62.266h-10zM1863 764.906h10v62.266h-10zM1863 1029.969h10v62.266h-10zM1863 1654.359h10v30h-10z"/>
  <path d="M10 139.383h240v7l-10 10H10v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M10 139.383h1967v2075.563H10z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="195" x="25" y="152.45">
    Prepare Handler Consume
  </text>
  <path d="M20 161.516v25h251v-15l-10-10H20" fill="#FFA07A" filter="url(#a)" stroke="#a80036"/>
  <path d="M261 161.516v10h10l-10-10" fill="#FFA07A" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="26" y="178.583">
    This flow has not been implemented
  </text>
  <path fill="#A80036" stroke="#a80036" d="M163.5 212.781l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M157.5 216.781h368"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="169.5" y="211.715">
    1
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="342" x="182.5" y="211.715">
    Consume Prepare event batch of messages for Payer
  </text>
  <path d="M441.5 261.781h232v7l-10 10h-222v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 261.781h833v156.664h-833z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="456.5" y="274.848">
    Persist Event Information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1200.5 321.047l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M536.5 325.047h670"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="543.5" y="319.981">
    2
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="556.5" y="319.981">
    Publish event information
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M448.5 333.047h815v55.398h-815z"/>
  <path fill="#EEE" stroke="#000" stroke-width="2" d="M448.5 333.047h66v7l-10 10h-56v-17z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="461.5" y="347.114">
    ref
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="780.5" y="366.114">
    Event Handler Consume
  </text>
  <path d="M441.5 432.445h270v7l-10 10h-260v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 432.445H1926v251.063H441.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="225" x="456.5" y="445.512">
    Fetch batch Payer information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1571 466.71l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M536.5 470.711H1577"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="543.5" y="465.645">
    3
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="410" x="556.5" y="465.645">
    Request to retrieve batch of Payer Participant details (if it exists)
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1851 495.844l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1593 499.844h264"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1600" y="494.778">
    4
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="1613" y="494.778">
    Request Participant details
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1832 512.844h72l10 11-10 12h-72l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="1834" y="528.911">
    participant
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1604 558.11l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M1598 562.109h269"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1610" y="557.043">
    5
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="1623" y="557.043">
    Return Participant details if it exists
  </text>
  <path fill="#A80036" stroke="#a80036" d="M547.5 587.242l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M541.5 591.242H1587"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="553.5" y="586.176">
    6
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="566.5" y="586.176">
    Return Participant details if it exists
  </text>
  <path stroke="#a80036" d="M536.5 620.375h42M578.5 620.375v13M537.5 633.375h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 629.375l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="543.5" y="615.309">
    7
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="556.5" y="615.309">
    Validate Payer
  </text>
  <path stroke="#a80036" d="M536.5 662.508h42M578.5 662.508v13M537.5 675.508h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 671.508l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="543.5" y="657.442">
    8
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="382" x="556.5" y="657.442">
    store result set in var: $LIST_PARTICIPANTS_DETAILS_PAYER
  </text>
  <path d="M441.5 697.508h273v7l-10 10h-263v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 697.508H1926v251.063H441.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="228" x="456.5" y="710.575">
    Fetch batch Payee information
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1571 731.773l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M536.5 735.773H1577"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="543.5" y="730.707">
    9
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="413" x="556.5" y="730.707">
    Request to retrieve batch of Payee Participant details (if it exists)
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1851 760.906l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1593 764.906h264"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1600" y="759.84">
    10
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="1622" y="759.84">
    Request Participant details
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1832 777.906h72l10 11-10 12h-72l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="1834" y="793.973">
    participant
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1604 823.172l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M1598 827.172h269"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1610" y="822.106">
    11
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="1632" y="822.106">
    Return Participant details if it exists
  </text>
  <path fill="#A80036" stroke="#a80036" d="M547.5 852.305l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M541.5 856.305H1587"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="553.5" y="851.239">
    12
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="575.5" y="851.239">
    Return Participant details if it exists
  </text>
  <path stroke="#a80036" d="M536.5 885.438h42M578.5 885.438v13M537.5 898.438h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 894.438l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="880.372">
    13
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="565.5" y="880.372">
    Validate Payee
  </text>
  <path stroke="#a80036" d="M536.5 927.57h42M578.5 927.57v13M537.5 940.57h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 936.57l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="922.504">
    14
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="382" x="565.5" y="922.504">
    store result set in var: $LIST_PARTICIPANTS_DETAILS_PAYEE
  </text>
  <path d="M441.5 962.57h225v7l-10 10h-215v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 962.57H1926v208.93H441.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="456.5" y="975.637">
    Fetch batch of transfers
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1456.5 996.836l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M536.5 1000.836h926"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="995.77">
    15
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="315" x="565.5" y="995.77">
    Request to retrieve batch of Transfers (if it exists)
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1851 1025.969l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1478.5 1029.969H1857"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1485.5" y="1024.903">
    16
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="1507.5" y="1024.903">
    Request batch of Transfers
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1841 1042.969h54l10 11-10 12h-54l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="1843" y="1059.036">
    transfer
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1489.5 1088.234l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M1483.5 1092.234H1867"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1495.5" y="1087.168">
    17
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="1517.5" y="1087.168">
    Return batch of Transfers (if it exists)
  </text>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1117.367l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M541.5 1121.367h931"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="553.5" y="1116.301">
    18
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="575.5" y="1116.301">
    Return batch of Transfer (if it exists)
  </text>
  <path stroke="#a80036" d="M536.5 1150.5h42M578.5 1150.5v13M537.5 1163.5h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1159.5l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1145.434">
    19
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="565.5" y="1145.434">
    store result set in var: $LIST_TRANSFERS
  </text>
  <path d="M421.5 1185.5h77v7l-10 10h-67v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M421.5 1185.5H1967v1022.445H421.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="436.5" y="1198.567">
    loop
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="513.5" y="1197.71">
    [for each message in batch]
  </text>
  <path d="M431.5 1209.633h236v7l-10 10h-226v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M431.5 1209.633h642v363.328h-642z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="191" x="446.5" y="1222.7">
    Validate Prepare Transfer
  </text>
  <path d="M441.5 1233.766h153v7l-10 10h-143v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 1233.766h619v59.266h-619z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="456.5" y="1246.832">
    Validate Payer
  </text>
  <path stroke="#a80036" d="M536.5 1272.031h42M578.5 1272.031v13M537.5 1285.031h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1281.031l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1266.965">
    20
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="483" x="565.5" y="1266.965">
    Validate Payer against in-memory var $LIST_PARTICIPANTS_DETAILS_PAYER
  </text>
  <path d="M441.5 1307.031h156v7l-10 10h-146v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 1307.031h622v59.266h-622z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="456.5" y="1320.098">
    Validate Payee
  </text>
  <path stroke="#a80036" d="M536.5 1345.297h42M578.5 1345.297v13M537.5 1358.297h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1354.297l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1340.231">
    21
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="486" x="565.5" y="1340.231">
    Validate Payee against in-memory var $LIST_PARTICIPANTS_DETAILS_PAYEE
  </text>
  <path d="M441.5 1380.297h163v7l-10 10h-153v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 1380.297h562v59.266h-562z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="456.5" y="1393.364">
    Duplicate check
  </text>
  <path stroke="#a80036" d="M536.5 1418.563h42M578.5 1418.563v13M537.5 1431.563h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1427.563l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1413.497">
    22
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="426" x="565.5" y="1413.497">
    Validate duplicate Check against in-memory var $LIST_TRANSFERS
  </text>
  <path stroke="#a80036" d="M536.5 1467.695h42M578.5 1467.695v13M537.5 1480.695h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1476.695l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1462.629">
    23
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="565.5" y="1462.629">
    Validate amount
  </text>
  <path stroke="#a80036" d="M536.5 1509.828h42M578.5 1509.828v13M537.5 1522.828h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1518.828l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1504.762">
    24
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="565.5" y="1504.762">
    Validate crypto-condition
  </text>
  <path stroke="#a80036" d="M536.5 1551.961h42M578.5 1551.961v13M537.5 1564.961h41"/>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1560.96l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1546.895">
    25
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="434" x="565.5" y="1546.895">
    Validate message signature (to be confirmed in future requirement)
  </text>
  <path d="M441.5 1586.96h588v7l-10 10h-578v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M441.5 1586.961H1957v167.664H441.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="543" x="456.5" y="1600.028">
    Persist Transfer State (with transferState=&apos;RECEIVED&apos; on validation pass)
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1456.5 1621.227l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M536.5 1625.227h926"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="1620.161">
    26
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="565.5" y="1620.161">
    Request to persist transfer
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1851 1650.36l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M1478.5 1654.359H1857"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1485.5" y="1649.293">
    27
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="1507.5" y="1649.293">
    Persist transfer
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1799 1697.36h138l10 11-10 12h-138l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1801" y="1713.426">
    transferStateChange
  </text>
  <path fill="#A80036" stroke="#a80036" d="M547.5 1742.625l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M541.5 1746.625h931"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="553.5" y="1741.559">
    28
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="575.5" y="1741.559">
    Return success
  </text>
  <path d="M541 1766.625v373h270v-363l-10-10H541" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M801 1766.625v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="547" y="1783.692">
    Message:
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="547" y="1798.825">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="563" y="1813.957">
    id: &lt;transferMessage.transferId&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="563" y="1829.09">
    from: &lt;transferMessage.payerFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="563" y="1844.223">
    to: &lt;transferMessage.payeeFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="563" y="1859.356">
    type: application/json
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="563" y="1874.489">
    content: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="579" y="1889.622">
    headers: &lt;transferHeaders&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="579" y="1904.754">
    payload: &lt;transferMessage&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="563" y="1919.887">
    },
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="563" y="1935.02">
    metadata: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="579" y="1950.153">
    event: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="595" y="1965.286">
    id: &lt;uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="595" y="1980.418">
    responseTo: &lt;previous.uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="595" y="1995.551">
    type: position,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="595" y="2010.684">
    action: prepare,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="595" y="2025.817">
    createdAt: &lt;timestamp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="595" y="2040.95">
    state: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="611" y="2056.082">
    status: &quot;success&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="611" y="2071.215">
    code: 0
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="595" y="2086.348">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="579" y="2101.481">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="563" y="2116.614">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="547" y="2131.747">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1046.5 2165.945l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M536.5 2169.945h516"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="543.5" y="2164.879">
    29
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="565.5" y="2164.879">
    Route &amp; Publish Position event for Payer
  </text>
</svg>
