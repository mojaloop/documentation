<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1255px" preserveAspectRatio="none" style="width:1656px;height:1255px" version="1.1" viewBox="0 0 1656 1255" width="1656px" zoomAndPan="magnify">
  <defs/>
  <g>
    <text fill="#000000" font-family="Verdana" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="570" x="543.25" y="28.708">Transfer: 3.4.1 Bad Signed Challenge - Self Hosted Auth-Service</text>
    <rect fill="#DDDDDD" height="1201.9453" style="stroke:#383838;stroke-width:1.0" width="155" x="1" y="40.9531"/>
    <text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="62" y="53.02">PISP</text>
    <rect fill="#DDDDDD" height="1201.9453" style="stroke:#383838;stroke-width:1.0" width="97" x="654" y="40.9531"/>
    <text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="669" y="53.02">Mojaloop</text>
    <rect fill="#DDDDDD" height="1201.9453" style="stroke:#383838;stroke-width:1.0" width="106" x="1049.5" y="40.9531"/>
    <text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="1075.5" y="53.02">DFSP A</text>
    <line style="stroke:#000000;stroke-width:1.0" x1="78" x2="78" y1="121.6484" y2="131.6484"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0" x1="78" x2="78" y1="131.6484" y2="172.4531"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="78" x2="78" y1="172.4531" y2="172.4531"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0" x1="78" x2="78" y1="172.4531" y2="213.2578"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="78" x2="78" y1="213.2578" y2="1248.8984"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="702" x2="702" y1="121.6484" y2="131.6484"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0" x1="702" x2="702" y1="131.6484" y2="172.4531"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="702" x2="702" y1="172.4531" y2="172.4531"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0" x1="702" x2="702" y1="172.4531" y2="213.2578"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="702" x2="702" y1="213.2578" y2="1248.8984"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1102.5" x2="1102.5" y1="121.6484" y2="131.6484"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0" x1="1102.5" x2="1102.5" y1="131.6484" y2="172.4531"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1102.5" x2="1102.5" y1="172.4531" y2="172.4531"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0" x1="1102.5" x2="1102.5" y1="172.4531" y2="213.2578"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1102.5" x2="1102.5" y1="213.2578" y2="1248.8984"/>
    <rect fill="#F4F4F4" height="37.2813" style="stroke:#383838;stroke-width:1.5" width="147" x="5" y="83.3672"/>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="12" y="108.9316">PISP Server</text>
    <rect fill="#F4F4F4" height="37.2813" style="stroke:#383838;stroke-width:1.5" width="89" x="658" y="83.3672"/>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="665" y="108.9316">Switch</text>
    <rect fill="#F4F4F4" height="60.5625" style="stroke:#383838;stroke-width:1.5" width="98" x="1053.5" y="60.0859"/>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="1061.5" y="85.6504">DFSP A</text>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84" x="1060.5" y="108.9316">(Payer)</text>
    <text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="306.5" y="155.8589">PISP has initiated Thirdparty Transaction Request with</text>
    <text fill="#000000" font-family="monospace" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="259" x="619.5" y="155.8589">POST /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="299" x="443" y="196.6636">DFSP A has received quote, and asked PISP to verify</text>
    <path d="M83,218.2578 L83,288.2578 L406,288.2578 L406,228.2578 L396,218.2578 L83,218.2578 " fill="#ECECEC" style="stroke:#383838;stroke-width:1.0"/>
    <path d="M396,218.2578 L396,228.2578 L406,228.2578 L396,218.2578 " fill="#ECECEC" style="stroke:#383838;stroke-width:1.0"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="89" y="235.3247">PISP looks up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="203" y="235.3247">transactionRequestId</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="367" y="235.3247">and</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="89" y="250.4575">checks the quote with the user,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="89" y="265.5903">and uses the FIDO API to sign the</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="89" y="280.7231">the</text>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="114" y="280.7231">challenge</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="190" y="280.7231">string</text>
    <rect fill="#FFFFFF" height="310" style="stroke:#383838;stroke-width:1.0" width="608" x="83" y="298.7891"/>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="600" x="87" y="314.856">PUT /thirdpartyRequests/authorizations/33333333-0000-0000-0000-000000000000</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="87" y="329.9888">FSPIOP-Source: pispa</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="87" y="345.1216">FSPIOP-Destination: dfspa</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="87" y="360.2544">{</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="95" y="375.3872">&quot;responseType&quot;: &quot;ACCEPTED&quot;</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="95" y="390.52">&quot;signedPayload&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="103" y="405.6528">&quot;signedPayloadType&quot;: &quot;FIDO&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="103" y="420.7856">&quot;fidoSignedPayload&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="111" y="435.9185">&quot;id&quot;: &quot;string&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="111" y="451.0513">&quot;rawId&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="111" y="466.1841">&quot;response&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="338" x="119" y="481.3169">&quot;authenticatorData&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="318" x="119" y="496.4497">&quot;clientDataJSON&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="119" y="511.5825">&quot;signature&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="119" y="526.7153">&quot;userHandle&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="111" y="541.8481">},</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="111" y="556.981">&quot;type&quot;: &quot;public-key&quot;</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="103" y="572.1138">}</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="95" y="587.2466">}</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="87" y="602.3794">}</text>
    <polygon fill="#000000" points="690.5,631.5781,700.5,635.5781,690.5,639.5781,694.5,635.5781" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="78.5" x2="696.5" y1="635.5781" y2="635.5781"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="600" x="90.5" y="630.5122">PUT /thirdpartyRequests/authorizations/33333333-0000-0000-0000-000000000000</text>
    <polygon fill="#000000" points="89.5,660.7109,79.5,664.7109,89.5,668.7109,85.5,664.7109" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0" x1="83.5" x2="701.5" y1="664.7109" y2="664.7109"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="366.5" y="659.645">200 OK</text>
    <polygon fill="#000000" points="1090.5,704.9766,1100.5,708.9766,1090.5,712.9766,1094.5,708.9766" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="702.5" x2="1096.5" y1="708.9766" y2="708.9766"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="750.5" y="688.7778">PUT /thirdpartyRequests/authorizations</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="296" x="754.5" y="703.9106">/33333333-0000-0000-0000-000000000000</text>
    <polygon fill="#000000" points="713.5,734.1094,703.5,738.1094,713.5,742.1094,709.5,738.1094" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0" x1="707.5" x2="1101.5" y1="738.1094" y2="738.1094"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="878.5" y="733.0435">200 OK</text>
    <line style="stroke:#000000;stroke-width:1.0" x1="1102.5" x2="1144.5" y1="767.2422" y2="767.2422"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1144.5" x2="1144.5" y1="767.2422" y2="780.2422"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1103.5" x2="1144.5" y1="780.2422" y2="780.2422"/>
    <polygon fill="#000000" points="1113.5,776.2422,1103.5,780.2422,1113.5,784.2422,1109.5,780.2422" style="stroke:#000000;stroke-width:1.0"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1109.5" y="762.1763">Look up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="1188.5" y="762.1763">transactionRequestId</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="1352.5" y="762.1763">for this</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1400.5" y="762.1763">authorizationId</text>
    <line style="stroke:#000000;stroke-width:1.0" x1="1102.5" x2="1144.5" y1="809.375" y2="809.375"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1144.5" x2="1144.5" y1="809.375" y2="822.375"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1103.5" x2="1144.5" y1="822.375" y2="822.375"/>
    <polygon fill="#000000" points="1113.5,818.375,1103.5,822.375,1113.5,826.375,1109.5,822.375" style="stroke:#000000;stroke-width:1.0"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1109.5" y="804.3091">Look up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1188.5" y="804.3091">consentId</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="1264.5" y="804.3091">for this</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="1312.5" y="804.3091">transactionRequestId</text>
    <line style="stroke:#000000;stroke-width:1.0" x1="1102.5" x2="1144.5" y1="851.5078" y2="851.5078"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1144.5" x2="1144.5" y1="851.5078" y2="864.5078"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="1103.5" x2="1144.5" y1="864.5078" y2="864.5078"/>
    <polygon fill="#000000" points="1113.5,860.5078,1103.5,864.5078,1113.5,868.5078,1109.5,864.5078" style="stroke:#000000;stroke-width:1.0"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1109.5" y="846.4419">Look up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1188.5" y="846.4419">publicKey</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="385" x="1264.5" y="846.4419">for this ConsentId. Check the signing of the signed challenge</text>
    <path d="M918,877.5078 L918,902.5078 L1286,902.5078 L1286,887.5078 L1276,877.5078 L918,877.5078 " fill="#ECECEC" style="stroke:#383838;stroke-width:1.0"/>
    <path d="M1276,877.5078 L1276,887.5078 L1286,887.5078 L1276,877.5078 " fill="#ECECEC" style="stroke:#383838;stroke-width:1.0"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="347" x="924" y="894.5747">Signed challenge is invalid. Transaction Request failed.</text>
    <rect fill="#FFFFFF" height="174" style="stroke:#383838;stroke-width:1.0" width="384" x="713" y="912.6406"/>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="288" x="717" y="928.7075">PUT /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="344" x="749" y="943.8403">/00000000-0000-0000-0000-000000000000/error</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="717" y="958.9731">FSPIOP-Source: dfspa</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="717" y="974.106">FSPIOP-Destination: pispa</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="717" y="989.2388">{</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="725" y="1004.3716">&quot;errorInformation&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="733" y="1019.5044">&quot;errorCode&quot;: &quot;6201&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="315" x="733" y="1034.6372">&quot;errorDescription&quot;: &quot;Invalid transaction signature&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="733" y="1049.77">&quot;extensionList&quot;: []</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="725" y="1064.9028">}</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="717" y="1080.0356">}</text>
    <polygon fill="#000000" points="713.5,1124.3672,703.5,1128.3672,713.5,1132.3672,709.5,1128.3672" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="707.5" x2="1101.5" y1="1128.3672" y2="1128.3672"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="758.5" y="1108.1685">PUT /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="344" x="746.5" y="1123.3013">/00000000-0000-0000-0000-000000000000/error</text>
    <polygon fill="#000000" points="1090.5,1153.5,1100.5,1157.5,1090.5,1161.5,1094.5,1157.5" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0" x1="702.5" x2="1096.5" y1="1157.5" y2="1157.5"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="878.5" y="1152.4341">200 OK</text>
    <polygon fill="#000000" points="89.5,1197.7656,79.5,1201.7656,89.5,1205.7656,85.5,1201.7656" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0" x1="83.5" x2="701.5" y1="1201.7656" y2="1201.7656"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="246.5" y="1181.5669">PUT /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="344" x="234.5" y="1196.6997">/00000000-0000-0000-0000-000000000000/error</text>
    <polygon fill="#000000" points="690.5,1226.8984,700.5,1230.8984,690.5,1234.8984,694.5,1230.8984" style="stroke:#000000;stroke-width:1.0"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0" x1="78.5" x2="696.5" y1="1230.8984" y2="1230.8984"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="366.5" y="1225.8325">200 OK</text>
  </g>
</svg>
