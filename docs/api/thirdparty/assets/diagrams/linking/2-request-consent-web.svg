<svg xmlns="http://www.w3.org/2000/svg" height="1401" preserveAspectRatio="none" style="width:1999px;height:1401px" width="1999">
  <text font-family="Verdana" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="327" x="838.75" y="28.708">
    PISP Linking: Request consent (Web)
  </text>
  <path fill="#DDD" stroke="#383838" d="M770 40.953h97v1347.313h-97z"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="785" y="53.02">
    Mojaloop
  </text>
  <path fill="#F4F4F4" stroke="#f4f4f4" d="M32.5 108.367h10V171.5h-10z"/>
  <path stroke="#000" d="M32.5 108.367V171.5M42.5 108.367V171.5M32.5 108.367h10"/>
  <path fill="#F4F4F4" stroke="#f4f4f4" d="M32.5 199.5h10v262.125h-10z"/>
  <path stroke="#000" d="M32.5 199.5v262.125M42.5 199.5v262.125M32.5 461.625h10"/>
  <path fill="#F4F4F4" stroke="#000" d="M32.5 1312h10v73.266h-10zM813.5 432.492h10v391.656h-10zM813.5 1057.008h10v284.125h-10zM1594.5 702.617h10v383.523h-10z"/>
  <path stroke="#000" d="M37 98.367v10"/>
  <path stroke="#000" stroke-dasharray="1,4" d="M37 108.367v28"/>
  <path stroke="#000" d="M37 136.367V171.5"/>
  <path stroke="#000" stroke-dasharray="1,4" d="M37 171.5v28"/>
  <path stroke="#000" d="M37 199.5v1194.766M818 98.367v10"/>
  <path stroke="#000" stroke-dasharray="1,4" d="M818 108.367v28"/>
  <path stroke="#000" d="M818 136.367V171.5"/>
  <path stroke="#000" stroke-dasharray="1,4" d="M818 171.5v28"/>
  <path stroke="#000" d="M818 199.5v1194.766M1599.5 98.367v10"/>
  <path stroke="#000" stroke-dasharray="1,4" d="M1599.5 108.367v28"/>
  <path stroke="#000" d="M1599.5 136.367V171.5"/>
  <path stroke="#000" stroke-dasharray="1,4" d="M1599.5 171.5v28"/>
  <path stroke="#000" d="M1599.5 199.5v1194.766"/>
  <path fill="#F4F4F4" stroke="#383838" stroke-width="1.5" d="M5 60.086h65v37.281H5z"/>
  <text font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="12" y="85.65">
    PISP
  </text>
  <path fill="#F4F4F4" stroke="#383838" stroke-width="1.5" d="M774 60.086h89v37.281h-89z"/>
  <text font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="781" y="85.65">
    Switch
  </text>
  <path fill="#F4F4F4" stroke="#383838" stroke-width="1.5" d="M1562.5 60.086h74v37.281h-74z"/>
  <text font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="1569.5" y="85.65">
    DFSP
  </text>
  <path fill="#F4F4F4" stroke="#f4f4f4" d="M32.5 108.367h10V171.5h-10z"/>
  <path stroke="#000" d="M32.5 108.367V171.5M42.5 108.367V171.5M32.5 108.367h10"/>
  <path fill="#F4F4F4" stroke="#f4f4f4" d="M32.5 199.5h10v262.125h-10z"/>
  <path stroke="#000" d="M32.5 199.5v262.125M42.5 199.5v262.125M32.5 461.625h10"/>
  <path fill="#F4F4F4" stroke="#000" d="M32.5 1312h10v73.266h-10zM813.5 432.492h10v391.656h-10zM813.5 1057.008h10v284.125h-10zM1594.5 702.617h10v383.523h-10z"/>
  <path d="M5 141.367v25h1626v-15l-10-10H5" fill="#ECECEC" stroke="#383838"/>
  <path d="M1621 141.367v10h10l-10-10" fill="#ECECEC" stroke="#383838"/>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="783" x="422.25" y="158.434">
    The user initiated some sort of account linking by choosing the appropriate DFSP from a screen inside the PISP application.
  </text>
  <path stroke="#000" d="M801.5 428.492l10 4-10 4 4-4zM42.5 432.492h765"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="49.5" y="321.497">
    REQ-1
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="97.5" y="215.567">
    POST /consentRequests
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="121.5" y="230.7">
    FSIOP-Source: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="121.5" y="245.833">
    FSIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="113.5" y="260.965">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="456" x="121.5" y="276.098">
    consentRequestId: &quot;11111111-0000-0000-0000-000000000000&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="121.5" y="291.231">
    userId: &quot;username1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="121.5" y="306.364">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="137.5" y="321.497">
    { accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="153.5" y="336.629">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="137.5" y="351.762">
    { accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="153.5" y="366.895">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="121.5" y="382.028">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="121.5" y="397.161">
    authChannels: [ &quot;Web&quot;, &quot;OTP&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="121.5" y="412.293">
    callbackUri: &quot;pisp-app://callback...
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="409.5" y="412.293">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="105.5" y="427.426">
    }
  </text>
  <path stroke="#000" d="M48.5 457.625l-10 4 10 4-4-4z"/>
  <path stroke="#000" stroke-dasharray="2,2" d="M42.5 461.625h770"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="54.5" y="456.559">
    REQ-2
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="102.5" y="456.559">
    202 Accepted
  </text>
  <path stroke="#000" d="M1582.5 698.617l10 4-10 4 4-4zM823.5 702.617h765"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="830.5" y="591.622">
    REQ-3
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="878.5" y="485.692">
    POST /consentRequests
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="902.5" y="500.825">
    FSIOP-Source: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="902.5" y="515.957">
    FSIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="894.5" y="531.09">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="456" x="902.5" y="546.223">
    consentRequestId: &quot;11111111-0000-0000-0000-000000000000&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="902.5" y="561.356">
    userId: &quot;username1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="902.5" y="576.489">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="918.5" y="591.622">
    { accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="934.5" y="606.754">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="918.5" y="621.887">
    { accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="934.5" y="637.02">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="902.5" y="652.153">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="902.5" y="667.286">
    authChannels: [ &quot;Web&quot;, &quot;OTP&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="902.5" y="682.418">
    callbackUri: &quot;pisp-app://callback...
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1190.5" y="682.418">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="886.5" y="697.551">
    }
  </text>
  <path stroke="#000" d="M834.5 727.75l-10 4 10 4-4-4z"/>
  <path stroke="#000" stroke-dasharray="2,2" d="M828.5 731.75h765"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="840.5" y="726.684">
    REQ-4
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="888.5" y="726.684">
    202 Accepted
  </text>
  <path stroke="#000" d="M1604.5 760.883h42M1646.5 760.883v13M1605.5 773.883h41M1615.5 769.883l-10 4 10 4-4-4z"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1611.5" y="755.817">
    REQ-5
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="1659.5" y="755.817">
    Verify the consentRequest validity
  </text>
  <path stroke="#000" d="M1604.5 823.148h42M1646.5 823.148v13M1599.5 836.148h47M1609.5 832.148l-10 4 10 4-4-4z"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1611.5" y="810.516">
    REQ-6
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="329" x="1659.5" y="802.95">
    In this case, DFSP chooses to use the Web channel,
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="296" x="1663.5" y="818.082">
    and adds the PISP&apos;s callback uri to an allow-list
  </text>
  <path stroke="#000" d="M834.5 1053.008l-10 4 10 4-4-4zM828.5 1057.008h765"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="840.5" y="953.579">
    REQ-7
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="456" x="888.5" y="855.215">
    PUT /consentRequests/11111111-0000-0000-0000-000000000000
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="912.5" y="870.348">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="912.5" y="885.481">
    FSIOP-Destination: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="904.5" y="900.614">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="912.5" y="915.747">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="928.5" y="930.879">
    { accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="944.5" y="946.012">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="928.5" y="961.145">
    { accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="944.5" y="976.278">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="912.5" y="991.411">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="912.5" y="1006.543">
    authChannels: [ &quot;Web&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="912.5" y="1021.676">
    callbackUri: &quot;pisp-app://callback...
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1200.5" y="1021.676">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="672" x="912.5" y="1036.809">
    authUri: &quot;dfspa.com/authorize?consentRequestId=11111111-0000-0000-0000-000000000000&quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="896.5" y="1051.942">
    }
  </text>
  <path stroke="#000" d="M1587.5 1082.14l10 4-10 4 4-4z"/>
  <path stroke="#000" stroke-dasharray="2,2" d="M823.5 1086.141h770"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="830.5" y="1081.075">
    REQ-8
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="878.5" y="1081.075">
    200 OK
  </text>
  <path stroke="#000" d="M53.5 1308l-10 4 10 4-4-4zM47.5 1312h765"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="59.5" y="1208.571">
    REQ-9
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="456" x="107.5" y="1110.207">
    PUT /consentRequests/11111111-0000-0000-0000-000000000000
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="131.5" y="1125.34">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="131.5" y="1140.473">
    FSIOP-Destination: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="123.5" y="1155.606">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="131.5" y="1170.739">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="147.5" y="1185.872">
    { accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="163.5" y="1201.004">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="147.5" y="1216.137">
    { accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="163.5" y="1231.27">
    actions: [ &quot;ACCOUNTS_TRANSFER&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="131.5" y="1246.403">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="131.5" y="1261.536">
    authChannels: [ &quot;Web&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="131.5" y="1276.668">
    callbackUri: &quot;pisp-app://callback...
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="419.5" y="1276.668">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="672" x="131.5" y="1291.801">
    authUri: &quot;dfspa.com/authorize?consentRequestId=11111111-0000-0000-0000-000000000000&quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="115.5" y="1306.934">
    }
  </text>
  <path stroke="#000" d="M806.5 1337.133l10 4-10 4 4-4z"/>
  <path stroke="#000" stroke-dasharray="2,2" d="M42.5 1341.133h770"/>
  <text font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="49.5" y="1336.067">
    REQ-10
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="106.5" y="1336.067">
    200 OK
  </text>
  <path d="M5 1354.133v25h1626v-15l-10-10H5" fill="#ECECEC" stroke="#383838"/>
  <path d="M1621 1354.133v10h10l-10-10" fill="#ECECEC" stroke="#383838"/>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="779" x="392.25" y="1371.2">
    At this point, the PISP knows that the Web authChannel is in use and the PISP App should redirect the user to the provided
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="1175.25" y="1371.2">
    authUri
  </text>
  <text font-family="Verdana" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1231.25" y="1371.2">
    .
  </text>
</svg>
