<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1258px" preserveAspectRatio="none" style="width:1647px;height:1258px;background:#FFFFFF;" version="1.1" viewBox="0 0 1647 1258" width="1647px" zoomAndPan="magnify">
  <title>Transfer: 3.4.1 Bad Signed Challenge - Self Hosted Auth-Service</title>
  <defs/>
  <g>
    <text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="507.5615" x="569.3582" y="27.9951">Transfer: 3.4.1 Bad Signed Challenge - Self Hosted Auth-Service</text>
    <rect fill="#DDDDDD" height="1201.9453" style="stroke:#181818;stroke-width:0.5;" width="154.4219" x="1" y="43.2969"/>
    <text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33.2554" x="61.5833" y="55.3638">PISP</text>
    <rect fill="#DDDDDD" height="1201.9453" style="stroke:#181818;stroke-width:0.5;" width="97.3906" x="640.5151" y="43.2969"/>
    <text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.7202" x="655.8503" y="55.3638">Mojaloop</text>
    <rect fill="#DDDDDD" height="1201.9453" style="stroke:#181818;stroke-width:0.5;" width="104.9004" x="1028.6133" y="43.2969"/>
    <text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="53.1489" x="1054.489" y="55.3638">DFSP A</text>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="78" x2="78" y1="123.9922" y2="133.9922"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="78" x2="78" y1="133.9922" y2="174.7969"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="78" x2="78" y1="174.7969" y2="174.7969"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="78" x2="78" y1="174.7969" y2="215.6016"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="78" x2="78" y1="215.6016" y2="1251.2422"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="688.5151" x2="688.5151" y1="123.9922" y2="133.9922"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="688.5151" x2="688.5151" y1="133.9922" y2="174.7969"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="688.5151" x2="688.5151" y1="174.7969" y2="174.7969"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="688.5151" x2="688.5151" y1="174.7969" y2="215.6016"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="688.5151" x2="688.5151" y1="215.6016" y2="1251.2422"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1080.6133" x2="1080.6133" y1="123.9922" y2="133.9922"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1080.6133" x2="1080.6133" y1="133.9922" y2="174.7969"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1080.6133" x2="1080.6133" y1="174.7969" y2="174.7969"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1080.6133" x2="1080.6133" y1="174.7969" y2="215.6016"/>
    <line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1080.6133" x2="1080.6133" y1="215.6016" y2="1251.2422"/>
    <rect fill="#F5F5F5" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146.4219" x="5" y="85.7109"/>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacing" textLength="132.4219" x="12" y="111.2754">PISP Server</text>
    <rect fill="#F5F5F5" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.3906" x="644.5151" y="85.7109"/>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacing" textLength="75.3906" x="651.5151" y="111.2754">Switch</text>
    <rect fill="#F5F5F5" height="60.5625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.9004" x="1032.6133" y="62.4297"/>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacing" textLength="81.7676" x="1040.1797" y="87.9941">DFSP A</text>
    <text fill="#000000" font-family="Verdana" font-size="20" font-weight="bold" lengthAdjust="spacing" textLength="82.9004" x="1039.6133" y="111.2754">(Payer)</text>
    <text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="299.5513" x="307.3442" y="158.2026">PISP has initiated Thirdparty Transaction Request with</text>
    <text fill="#000000" font-family="monospace" font-size="11" lengthAdjust="spacing" textLength="245.0347" x="610.3921" y="158.2026">POST /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="288.5942" x="437.0884" y="199.0073">DFSP A has received quote, and asked PISP to verify</text>
    <path d="M83,220.6016 L83,290.6016 L405,290.6016 L405,230.6016 L395,220.6016 L83,220.6016 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M395,220.6016 L395,230.6016 L405,230.6016 L395,220.6016 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.8076" x="89" y="237.6685">PISP looks up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="156.5332" x="204.9399" y="237.6685">transactionRequestId</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="24.4575" x="365.6055" y="237.6685">and</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.772" x="89" y="252.8013">checks the quote with the user,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217.8833" x="89" y="267.9341">and uses the FIDO API to sign the</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="21.3345" x="89" y="283.0669">the</text>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="70.4399" x="114.4668" y="283.0669">challenge</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="37.3179" x="189.0391" y="283.0669">string</text>
    <rect fill="#D3D3D3" height="310" style="stroke:#181818;stroke-width:0.5;" width="594" x="83" y="301.1328"/>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="586.9995" x="87" y="317.1997">PUT /thirdpartyRequests/authorizations/33333333-0000-0000-0000-000000000000</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="156.5332" x="87" y="332.3325">FSPIOP-Source: pispa</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="195.6665" x="87" y="347.4653">FSPIOP-Destination: dfspa</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="87" y="362.5981">{</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="192.9116" x="95.2646" y="377.731">&quot;responseType&quot;: &quot;ACCEPTED&quot;</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="123.1509" x="95.2646" y="392.8638">&quot;signedPayload&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="194.4097" x="103.5293" y="407.9966">&quot;signedPayloadType&quot;: &quot;FIDO&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="149.0239" x="103.5293" y="423.1294">&quot;fidoSignedPayload&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.7441" x="111.7939" y="438.2622">&quot;id&quot;: &quot;string&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="265.3765" x="111.7939" y="453.395">&quot;rawId&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="88.0737" x="111.7939" y="468.5278">&quot;response&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="348.3848" x="120.0586" y="483.6606">&quot;authenticatorData&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="328.1357" x="120.0586" y="498.7935">&quot;clientDataJSON&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="290.8687" x="120.0586" y="513.9263">&quot;signature&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="303.5449" x="120.0586" y="529.0591">&quot;userHandle&quot;: &quot;string - base64 encoded utf-8&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="111.7939" y="544.1919">},</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.4956" x="111.7939" y="559.3247">&quot;type&quot;: &quot;public-key&quot;</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="103.5293" y="574.4575">}</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="95.2646" y="589.5903">}</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="87" y="604.7231">}</text>
    <polygon fill="#000000" points="677.2104,633.9219,687.2104,637.9219,677.2104,641.9219,681.2104,637.9219" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="78.2109" x2="683.2104" y1="637.9219" y2="637.9219"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="586.9995" x="90.2109" y="632.856">PUT /thirdpartyRequests/authorizations/33333333-0000-0000-0000-000000000000</text>
    <polygon fill="#000000" points="89.2109,663.0547,79.2109,667.0547,89.2109,671.0547,85.2109,667.0547" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.2109" x2="688.2104" y1="667.0547" y2="667.0547"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="46.96" x="360.2307" y="661.9888">200 OK</text>
    <polygon fill="#000000" points="1069.0635,707.3203,1079.0635,711.3203,1069.0635,715.3203,1073.0635,711.3203" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="689.2104" x2="1075.0635" y1="711.3203" y2="711.3203"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="297.4131" x="736.4304" y="691.1216">PUT /thirdpartyRequests/authorizations</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="289.5864" x="740.3438" y="706.2544">/33333333-0000-0000-0000-000000000000</text>
    <polygon fill="#000000" points="700.2104,736.4531,690.2104,740.4531,700.2104,744.4531,696.2104,740.4531" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="694.2104" x2="1080.0635" y1="740.4531" y2="740.4531"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="46.96" x="861.657" y="735.3872">200 OK</text>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1081.0635" x2="1123.0635" y1="769.5859" y2="769.5859"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1123.0635" x2="1123.0635" y1="769.5859" y2="782.5859"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1082.0635" x2="1123.0635" y1="782.5859" y2="782.5859"/>
    <polygon fill="#000000" points="1092.0635,778.5859,1082.0635,782.5859,1092.0635,786.5859,1088.0635,782.5859" style="stroke:#000000;stroke-width:1.0;"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="76.7686" x="1088.0635" y="764.52">Look up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="156.5332" x="1168.9644" y="764.52">transactionRequestId</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="45.7285" x="1329.6299" y="764.52">for this</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="117.3999" x="1379.4907" y="764.52">authorizationId</text>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1081.0635" x2="1123.0635" y1="811.7188" y2="811.7188"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1123.0635" x2="1123.0635" y1="811.7188" y2="824.7188"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1082.0635" x2="1123.0635" y1="824.7188" y2="824.7188"/>
    <polygon fill="#000000" points="1092.0635,820.7188,1082.0635,824.7188,1092.0635,828.7188,1088.0635,824.7188" style="stroke:#000000;stroke-width:1.0;"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="76.7686" x="1088.0635" y="806.6528">Look up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="70.4399" x="1168.9644" y="806.6528">consentId</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="45.7285" x="1243.5366" y="806.6528">for this</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="156.5332" x="1293.3975" y="806.6528">transactionRequestId</text>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1081.0635" x2="1123.0635" y1="853.8516" y2="853.8516"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1123.0635" x2="1123.0635" y1="853.8516" y2="866.8516"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="1082.0635" x2="1123.0635" y1="866.8516" y2="866.8516"/>
    <polygon fill="#000000" points="1092.0635,862.8516,1082.0635,866.8516,1092.0635,870.8516,1088.0635,866.8516" style="stroke:#000000;stroke-width:1.0;"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="76.7686" x="1088.0635" y="848.7856">Look up the</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="70.4399" x="1168.9644" y="848.7856">publicKey</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="396.7412" x="1243.5366" y="848.7856">for this ConsentId. Check the signing of the signed challenge</text>
    <path d="M890,879.8516 L890,904.8516 L1270,904.8516 L1270,889.8516 L1260,879.8516 L890,879.8516 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M1260,879.8516 L1260,889.8516 L1270,889.8516 L1260,879.8516 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="359.7852" x="896" y="896.9185">Signed challenge is invalid. Transaction Request failed.</text>
    <rect fill="#D3D3D3" height="174" style="stroke:#181818;stroke-width:0.5;" width="375" x="700" y="914.9844"/>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="281.7598" x="704" y="931.0513">PUT /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="336.5464" x="735.3066" y="946.1841">/00000000-0000-0000-0000-000000000000/error</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="156.5332" x="704" y="961.3169">FSPIOP-Source: dfspa</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="195.6665" x="704" y="976.4497">FSPIOP-Destination: pispa</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="704" y="991.5825">{</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="136.208" x="712.2646" y="1006.7153">&quot;errorInformation&quot;: {</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="134.9131" x="720.5293" y="1021.8481">&quot;errorCode&quot;: &quot;6201&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="329.0181" x="720.5293" y="1036.981">&quot;errorDescription&quot;: &quot;Invalid transaction signature&quot;,</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.9429" x="720.5293" y="1052.1138">&quot;extensionList&quot;: []</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="712.2646" y="1067.2466">}</text>
    <text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="704" y="1082.3794">}</text>
    <polygon fill="#000000" points="700.2104,1126.7109,690.2104,1130.7109,700.2104,1134.7109,696.2104,1130.7109" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="694.2104" x2="1080.0635" y1="1130.7109" y2="1130.7109"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="281.7598" x="744.2571" y="1110.5122">PUT /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="336.5464" x="732.5171" y="1125.645">/00000000-0000-0000-0000-000000000000/error</text>
    <polygon fill="#000000" points="1069.0635,1155.8438,1079.0635,1159.8438,1069.0635,1163.8438,1073.0635,1159.8438" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689.2104" x2="1075.0635" y1="1159.8438" y2="1159.8438"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="46.96" x="861.657" y="1154.7778">200 OK</text>
    <polygon fill="#000000" points="89.2109,1200.1094,79.2109,1204.1094,89.2109,1208.1094,85.2109,1204.1094" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;" x1="83.2109" x2="688.2104" y1="1204.1094" y2="1204.1094"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="281.7598" x="242.8308" y="1183.9106">PUT /thirdpartyRequests/transactions</text>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="336.5464" x="231.0908" y="1199.0435">/00000000-0000-0000-0000-000000000000/error</text>
    <polygon fill="#000000" points="677.2104,1229.2422,687.2104,1233.2422,677.2104,1237.2422,681.2104,1233.2422" style="stroke:#000000;stroke-width:1.0;"/>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.2109" x2="683.2104" y1="1233.2422" y2="1233.2422"/>
    <text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="46.96" x="360.2307" y="1228.1763">200 OK</text>
  </g>
</svg>
