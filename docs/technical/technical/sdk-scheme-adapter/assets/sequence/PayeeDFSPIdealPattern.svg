<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2058px" preserveAspectRatio="none" style="width:2184px;height:2058px;background:#FFFFFF;" version="1.1" viewBox="0 0 2184 2058" width="2184px" zoomAndPan="magnify"><defs/><g><rect fill="#D3D3D3" height="2046.5938" style="stroke:#181818;stroke-width:0.5;" width="754.5" x="837.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="182" x="1123.75" y="28.8379">Payment Manager</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="127" x="1123.75" y="56.5098">Payee DFSP</text><rect fill="#FFFFFF" height="125.0156" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="318.375"/><rect fill="#FFFFFF" height="208.3594" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="793.4375"/><rect fill="#FFFFFF" height="125.0156" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="1366.8438"/><rect fill="#FFFFFF" height="179.6875" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="1781.5625"/><rect height="155.3594" style="stroke:#000000;stroke-width:1.5;fill:none;" width="873.5" x="205" y="458.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="267" x2="267" y1="135.6875" y2="1979.25"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="954.5" x2="954.5" y1="135.6875" y2="1979.25"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1531" x2="1531" y1="135.6875" y2="1979.25"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1890.5" x2="1890.5" y1="135.6875" y2="1979.25"/><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="215" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="222" y="95.1816">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="235.5" y="122.8535">Switch</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="215" y="1978.25"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="222" y="2008.0879">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="235.5" y="2035.7598">Switch</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="841.5" y="93.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="213" x="848.5" y="122.8535">SDK Scheme Adapter</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="841.5" y="1978.25"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="213" x="848.5" y="2008.0879">SDK Scheme Adapter</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="1474" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="1507" y="95.1816">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="1481" y="122.8535">Connector</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="1474" y="1978.25"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="1507" y="2008.0879">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="1481" y="2035.7598">Connector</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221" x="1780.5" y="93.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="207" x="1787.5" y="122.8535">Core banking solution</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221" x="1780.5" y="1978.25"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="207" x="1787.5" y="2008.0879">Core banking solution</text><rect fill="#FFFFFF" height="125.0156" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="318.375"/><rect fill="#FFFFFF" height="208.3594" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="793.4375"/><rect fill="#FFFFFF" height="125.0156" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="1366.8438"/><rect fill="#FFFFFF" height="179.6875" style="stroke:#181818;stroke-width:1.0;" width="10" x="950" y="1781.5625"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2177" x="0" y="172.5234"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2177" y1="172.5234" y2="172.5234"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2177" y1="175.5234" y2="175.5234"/><rect fill="#EEEEEE" height="35.6719" style="stroke:#000000;stroke-width:2.0;" width="382" x="897.5" y="155.6875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="362" x="903.5" y="182.5254">Payee DFSP integration - Discovery</text><polygon fill="#181818" points="943,231.0313,953,235.0313,943,239.0313,947,235.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="949" y1="235.0313" y2="235.0313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="274" y="228.1973">[1]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="304" y="228.1973">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="178" x="357" y="228.1973">/parties/{Type}/{Id}</text><polygon fill="#181818" points="278,272.7031,268,276.7031,278,280.7031,274,276.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="272" x2="954" y1="276.7031" y2="276.7031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="284" y="269.8691">[2]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="314" y="269.8691">HTTP 202 Response</text><polygon fill="#181818" points="1519,314.375,1529,318.375,1519,322.375,1523,318.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="960" x2="1525" y1="318.375" y2="318.375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="967" y="311.541">[3]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="997" y="311.541">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="178" x="1050" y="311.541">/parties/{Type}/{Id}</text><polygon fill="#181818" points="1879,356.0469,1889,360.0469,1879,364.0469,1883,360.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1531" x2="1885" y1="360.0469" y2="360.0469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1538" y="353.2129">[4]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="1568" y="353.2129">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="156" x="1621" y="353.2129">[account lookup]</text><polygon fill="#181818" points="1542,397.7188,1532,401.7188,1542,405.7188,1538,401.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1536" x2="1890" y1="401.7188" y2="401.7188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1548" y="394.8848">[5]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="98" x="1578" y="394.8848">Response</text><polygon fill="#181818" points="966,439.3906,956,443.3906,966,447.3906,962,443.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="960" x2="1530" y1="443.3906" y2="443.3906"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="972" y="436.5566">[6]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="98" x="1002" y="436.5566">Response</text><path d="M205,458.3906 L274,458.3906 L274,478.0625 L264,488.0625 L205,488.0625 L205,458.3906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.3594" style="stroke:#000000;stroke-width:1.5;" width="873.5" x="205" y="458.3906"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="220" y="482.2285">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="221" x="289" y="483.2285">[If Success response]</text><polygon fill="#181818" points="278,530.4063,268,534.4063,278,538.4063,274,534.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="272" x2="954" y1="534.4063" y2="534.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="284" y="527.5723">[7]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="314" y="527.5723">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="478" x="366" y="527.5723">/parties/{Type}/{Id} (or /parties/{Type}/{Id}/{SubId})</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="205" x2="1078.5" y1="543.4063" y2="543.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="185" x="210" y="566.2441">[if Error response]</text><polygon fill="#181818" points="278,601.75,268,605.75,278,609.75,274,605.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="272" x2="954" y1="605.75" y2="605.75"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="284" y="598.916">[8]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="314" y="598.916">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="582" x="366" y="598.916">/parties/{Type}/{Id}/error (or /parties/{Type}/{Id}/{SubId}/error)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2177" x="0" y="647.5859"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2177" y1="647.5859" y2="647.5859"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2177" y1="650.5859" y2="650.5859"/><rect fill="#EEEEEE" height="35.6719" style="stroke:#000000;stroke-width:2.0;" width="880" x="648.5" y="630.75"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="860" x="654.5" y="657.5879">Payee DFSP integration - Quote and Transfer - 2 phase commit with prior AML check</text><polygon fill="#181818" points="943,706.0938,953,710.0938,943,714.0938,947,710.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="949" y1="710.0938" y2="710.0938"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="274" y="703.2598">[9]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="304" y="703.2598">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="71" x="372" y="703.2598">/quotes</text><polygon fill="#181818" points="278,747.7656,268,751.7656,278,755.7656,274,751.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="272" x2="954" y1="751.7656" y2="751.7656"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="284" y="744.9316">[10]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="326" y="744.9316">HTTP 202 Response</text><polygon fill="#181818" points="1519,789.4375,1529,793.4375,1519,797.4375,1523,793.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="960" x2="1525" y1="793.4375" y2="793.4375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="967" y="786.6035">[11]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1009" y="786.6035">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="131" x="1077" y="786.6035">/quoterequest</text><polygon fill="#181818" points="1879,831.1094,1889,835.1094,1879,839.1094,1883,835.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1531" x2="1885" y1="835.1094" y2="835.1094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1538" y="828.2754">[12]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="45" x="1580" y="828.2754">AML</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="212" x="1631" y="828.2754">checks (velocity,etc...)</text><polygon fill="#181818" points="1542,872.7813,1532,876.7813,1542,880.7813,1538,876.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1536" x2="1890" y1="876.7813" y2="876.7813"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1548" y="869.9473">[13]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="98" x="1590" y="869.9473">Response</text><polygon fill="#181818" points="1879,914.4531,1889,918.4531,1879,922.4531,1883,918.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1531" x2="1885" y1="918.4531" y2="918.4531"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1538" y="911.6191">[14]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="149" x="1580" y="911.6191">Calculate Fees</text><polygon fill="#181818" points="1542,956.125,1532,960.125,1542,964.125,1538,960.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1536" x2="1890" y1="960.125" y2="960.125"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1548" y="953.291">[15]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="98" x="1590" y="953.291">Response</text><polygon fill="#181818" points="966,997.7969,956,1001.7969,966,1005.7969,962,1001.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="960" x2="1530" y1="1001.7969" y2="1001.7969"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="972" y="994.9629">[16]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="98" x="1014" y="994.9629">Response</text><polygon fill="#181818" points="278,1039.4688,268,1043.4688,278,1047.4688,274,1043.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="272" x2="954" y1="1043.4688" y2="1043.4688"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="284" y="1036.6348">[17]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="326" y="1036.6348">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="109" x="378" y="1036.6348">/quotes/{Id}</text><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="309" y1="1109.3125" y2="1109.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="309" y1="1109.3125" y2="1122.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="268" x2="309" y1="1122.3125" y2="1122.3125"/><polygon fill="#181818" points="278,1118.3125,268,1122.3125,278,1126.3125,274,1122.3125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="274" y="1102.4785">[18]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="202" x="316" y="1102.4785">Pass Quote to Payer</text><path d="M5,1056.4688 L5,1149.4688 L262,1149.4688 L262,1066.4688 L252,1056.4688 L5,1056.4688 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M252,1056.4688 L252,1066.4688 L262,1066.4688 L252,1056.4688 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="169" x="11" y="1084.3066">Obtain consent to</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="236" x="11" y="1111.9785">proceed with the transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="32" x="11" y="1139.6504">Via</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="49" y="1139.6504">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="117" y="1139.6504">/transfers</text><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="309" y1="1188.1563" y2="1188.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="309" y1="1188.1563" y2="1201.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="268" x2="309" y1="1201.1563" y2="1201.1563"/><polygon fill="#181818" points="278,1197.1563,268,1201.1563,278,1205.1563,274,1201.1563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="274" y="1181.3223">[19]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="273" x="316" y="1181.3223">Perform liquidity(NDC)check</text><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="309" y1="1242.8281" y2="1242.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="309" y1="1242.8281" y2="1255.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="268" x2="309" y1="1255.8281" y2="1255.8281"/><polygon fill="#181818" points="278,1251.8281,268,1255.8281,278,1259.8281,274,1255.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="274" y="1235.9941">[20]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="145" x="316" y="1235.9941">Reserve Funds</text><polygon fill="#181818" points="943,1293.5,953,1297.5,943,1301.5,947,1297.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="949" y1="1297.5" y2="1297.5"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="274" y="1290.666">[21]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="316" y="1290.666">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="384" y="1290.666">/transfers</text><polygon fill="#181818" points="1519,1362.8438,1529,1366.8438,1519,1370.8438,1523,1366.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="960" x2="1525" y1="1366.8438" y2="1366.8438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="967" y="1346.1738">[22]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="260" x="1009" y="1332.3379">Create &amp; Reserve Transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="6" x="1009" y="1360.0098"> </text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1015" y="1360.0098">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1083" y="1360.0098">/transfers</text><polygon fill="#181818" points="1879,1404.5156,1889,1408.5156,1879,1412.5156,1883,1408.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1531" x2="1885" y1="1408.5156" y2="1408.5156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1538" y="1401.6816">[23]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="139" x="1580" y="1401.6816">Reserve funds</text><polygon fill="#181818" points="1542,1446.1875,1532,1450.1875,1542,1454.1875,1538,1450.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1536" x2="1890" y1="1450.1875" y2="1450.1875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1548" y="1443.3535">[24]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="294" x="1590" y="1443.3535">response (homeTransactionId)</text><polygon fill="#181818" points="966,1487.8594,956,1491.8594,966,1495.8594,962,1491.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="960" x2="1530" y1="1491.8594" y2="1491.8594"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="972" y="1485.0254">[25]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="294" x="1014" y="1485.0254">response (homeTransactionId)</text><line style="stroke:#181818;stroke-width:1.0;" x1="955" x2="997" y1="1533.5313" y2="1533.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="997" x2="997" y1="1533.5313" y2="1546.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="956" x2="997" y1="1546.5313" y2="1546.5313"/><polygon fill="#181818" points="966,1542.5313,956,1546.5313,966,1550.5313,962,1546.5313" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="962" y="1526.6973">[26]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="186" x="1004" y="1526.6973">Generate Fulfilment</text><polygon fill="#181818" points="278,1584.2031,268,1588.2031,278,1592.2031,274,1588.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="272" x2="954" y1="1588.2031" y2="1588.2031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="284" y="1581.3691">[27]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="326" y="1581.3691">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="540" x="378" y="1581.3691">/transfers/{id} (TransferStatus='RESERVED', fulfullment)</text><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="309" y1="1629.875" y2="1629.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="309" y1="1629.875" y2="1642.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="268" x2="309" y1="1642.875" y2="1642.875"/><polygon fill="#181818" points="278,1638.875,268,1642.875,278,1646.875,274,1642.875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="274" y="1623.041">[28]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="297" x="316" y="1623.041">Commit funds in DFSP ledgers</text><polygon fill="#181818" points="943,1680.5469,953,1684.5469,943,1688.5469,947,1684.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="267" x2="949" y1="1684.5469" y2="1684.5469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="274" y="1677.7129">[29]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="77" x="316" y="1677.7129">PATCH</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="446" x="399" y="1677.7129">/transfers/{id} (TransferStatus='COMMITTED')</text><polygon fill="#181818" points="1519,1777.5625,1529,1781.5625,1519,1785.5625,1523,1781.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="960" x2="1525" y1="1781.5625" y2="1781.5625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="967" y="1747.0566">[30]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="163" x="1009" y="1719.3848">Commit Transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="6" x="1009" y="1747.0566"> </text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="77" x="1015" y="1747.0566">PATCH</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="127" x="1098" y="1747.0566">/transfers/{id}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="510" x="1009" y="1774.7285">(TransferStatus='COMMITTED', homeTransactionId)</text><polygon fill="#181818" points="1879,1819.2344,1889,1823.2344,1879,1827.2344,1883,1823.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1531" x2="1885" y1="1823.2344" y2="1823.2344"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1538" y="1816.4004">[31]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="134" x="1580" y="1816.4004">Commit funds</text><line style="stroke:#181818;stroke-width:1.0;" x1="1891" x2="1933" y1="1864.9063" y2="1864.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1933" x2="1933" y1="1864.9063" y2="1877.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1892" x2="1933" y1="1877.9063" y2="1877.9063"/><polygon fill="#181818" points="1902,1873.9063,1892,1877.9063,1902,1881.9063,1898,1877.9063" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1898" y="1858.0723">[32]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="230" x="1940" y="1858.0723">Release funds to Payee</text><polygon fill="#181818" points="1542,1915.5781,1532,1919.5781,1542,1923.5781,1538,1919.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1536" x2="1890" y1="1919.5781" y2="1919.5781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1548" y="1912.7441">[33]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="1590" y="1912.7441">response</text><polygon fill="#181818" points="966,1957.25,956,1961.25,966,1965.25,962,1961.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="960" x2="1530" y1="1961.25" y2="1961.25"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="972" y="1954.416">[34]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="1014" y="1954.416">response</text><!--MD5=[6565fe121b93ed79d7f7920f1eeb4dc2]
@startuml PayeeDFSPIdealPattern
/'*****
- - - - - - - - - - - - - -
******'/

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
' declare title
' title PayeeDFSPIdealPattern
' declare actors
participant "Mojaloop\nSwitch" as Switch
box "Payment Manager\nPayee DFSP" #LightGrey
participant "SDK Scheme Adapter" as MC 
participant "Core\nConnector" as CC 
end box
participant "Core banking solution" as CBS
autonumber 1 1 "<b>[0]"

== Payee DFSP integration - Discovery ==

Switch->MC: **GET** /parties/{Type}/{Id}
MC- ->Switch: HTTP 202 Response
MC->CC: **GET** /parties/{Type}/{Id}
activate MC
CC->CBS: **GET** [account lookup]
CBS- ->CC: Response
CC- ->MC: Response
deactivate MC
alt If Success response
MC- ->Switch: **PUT** /parties/{Type}/{Id} (or /parties/{Type}/{Id}/{SubId})
else if Error response
MC- ->Switch: **PUT** /parties/{Type}/{Id}/error (or /parties/{Type}/{Id}/{SubId}/error)
end

== Payee DFSP integration - Quote and Transfer - 2 phase commit with prior AML check ==

Switch->MC: **POST** /quotes
MC- ->Switch: HTTP 202 Response
MC->CC: **POST** /quoterequest
activate MC
CC->CBS: **AML** checks (velocity,etc...)
CBS- ->CC: Response
CC->CBS: **Calculate Fees**
CBS- ->CC: Response
CC- ->MC: Response
deactivate MC
MC- ->Switch: **PUT** /quotes/{Id} 
Switch->Switch: Pass Quote to Payer
note left
Obtain consent to 
proceed with the transfer
Via **POST** /transfers
end note
    Switch-> Switch: Perform liquidity(NDC)check
    Switch->Switch: Reserve Funds
    Switch->MC: **POST** /transfers
    MC->CC: Create & Reserve Transfer\n **POST** /transfers 
    activate MC
    CC->CBS: Reserve funds 
    CBS- ->CC: response (homeTransactionId)
    CC- ->MC: response (homeTransactionId)
    deactivate MC
    MC->MC: Generate Fulfilment
    MC->Switch: **PUT** /transfers/{id} (TransferStatus='RESERVED', fulfullment)
    Switch->Switch: Commit funds in DFSP ledgers
    Switch->MC: **PATCH** /transfers/{id} (TransferStatus='COMMITTED')
    MC->CC: Commit Transfer\n **PATCH** /transfers/{id} \n(TransferStatus='COMMITTED', homeTransactionId) 
    activate MC
    CC->CBS: Commit funds 
    CBS->CBS: Release funds to Payee 
    CBS- ->CC: response
    CC- ->MC: response
    deactivate MC


@enduml

@startuml PayeeDFSPIdealPattern

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
participant "Mojaloop\nSwitch" as Switch
box "Payment Manager\nPayee DFSP" #LightGrey
participant "SDK Scheme Adapter" as MC 
participant "Core\nConnector" as CC 
end box
participant "Core banking solution" as CBS
autonumber 1 1 "<b>[0]"

== Payee DFSP integration - Discovery ==

Switch->MC: **GET** /parties/{Type}/{Id}
MC- ->Switch: HTTP 202 Response
MC->CC: **GET** /parties/{Type}/{Id}
activate MC
CC->CBS: **GET** [account lookup]
CBS- ->CC: Response
CC- ->MC: Response
deactivate MC
alt If Success response
MC- ->Switch: **PUT** /parties/{Type}/{Id} (or /parties/{Type}/{Id}/{SubId})
else if Error response
MC- ->Switch: **PUT** /parties/{Type}/{Id}/error (or /parties/{Type}/{Id}/{SubId}/error)
end

== Payee DFSP integration - Quote and Transfer - 2 phase commit with prior AML check ==

Switch->MC: **POST** /quotes
MC- ->Switch: HTTP 202 Response
MC->CC: **POST** /quoterequest
activate MC
CC->CBS: **AML** checks (velocity,etc...)
CBS- ->CC: Response
CC->CBS: **Calculate Fees**
CBS- ->CC: Response
CC- ->MC: Response
deactivate MC
MC- ->Switch: **PUT** /quotes/{Id} 
Switch->Switch: Pass Quote to Payer
note left
Obtain consent to 
proceed with the transfer
Via **POST** /transfers
end note
    Switch-> Switch: Perform liquidity(NDC)check
    Switch->Switch: Reserve Funds
    Switch->MC: **POST** /transfers
    MC->CC: Create & Reserve Transfer\n **POST** /transfers 
    activate MC
    CC->CBS: Reserve funds 
    CBS- ->CC: response (homeTransactionId)
    CC- ->MC: response (homeTransactionId)
    deactivate MC
    MC->MC: Generate Fulfilment
    MC->Switch: **PUT** /transfers/{id} (TransferStatus='RESERVED', fulfullment)
    Switch->Switch: Commit funds in DFSP ledgers
    Switch->MC: **PATCH** /transfers/{id} (TransferStatus='COMMITTED')
    MC->CC: Commit Transfer\n **PATCH** /transfers/{id} \n(TransferStatus='COMMITTED', homeTransactionId) 
    activate MC
    CC->CBS: Commit funds 
    CBS->CBS: Release funds to Payee 
    CBS- ->CC: response
    CC- ->MC: response
    deactivate MC


@enduml

PlantUML version 1.2022.6(Tue Jun 21 18:34:49 BST 2022)
(GPLV2 source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: GB
--></g></svg>