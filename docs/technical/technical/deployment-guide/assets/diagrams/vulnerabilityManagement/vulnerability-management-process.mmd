flowchart TD
    Start([Start]) --> Identify[Identify Vulnerability]
    
    subgraph DetectionTools["Vulnerability Detection Tools"]
        Identify --> Dependabot[GitHub Dependabot Alerts]
        Identify --> AuditCI[npm run audit:check]
        Identify --> Grype[Grype Image Scan]
        
        AuditCI --> AuditCIConfig[audit-ci.jsonc<br>with allowlist]
        Grype --> GrypeConfig[.grype.yaml<br>with ignore section]
    end
    
    DetectionTools --> Triage[Triage Vulnerability]
    
    subgraph TriageProcess["Triage Process"]
        Triage --> AssessSeverity[Assess Severity Level]
        AssessSeverity --> |"Critical"| Critical[Critical: 1-3 days]
        AssessSeverity --> |"High"| High[High: 30 days]
        AssessSeverity --> |"Medium"| Medium[Medium: 60 days]
        AssessSeverity --> |"Low"| Low[Low: 90 days]
        Critical --> CreateIssue
        High --> CreateIssue
        Medium --> CreateIssue
        Low --> CreateIssue
        CreateIssue[Create Issue in Project Repo]
    end
    
    TriageProcess --> SelectModule[Select Single Module to Update]
    
    subgraph UpdateProcess["Update Process"]
        SelectModule --> UpdatePackage[Update package.json and package-lock.json]
        UpdatePackage --> RunTests[Run Tests]
        RunTests --> TestDecision{Tests Pass?}
        TestDecision --> |"Yes"| CreatePR[Create Pull Request]
        TestDecision --> |"No"| RemediationOptions{Cannot Fix?}
        RemediationOptions --> |"No"| AdjustUpdate[Adjust Update]
        AdjustUpdate --> RunTests
        RemediationOptions --> |"Yes"| ConfigureAllowlist[Configure Allowlist/Ignore]
        ConfigureAllowlist --> |"For npm"| UpdateAuditCI[Update audit-ci.jsonc]
        ConfigureAllowlist --> |"For container"| UpdateGrype[Update .grype.yaml]
        UpdateAuditCI --> CreatePR
        UpdateGrype --> CreatePR
        CreatePR --> ReviewPR[Code Review Process]
        ReviewPR --> |"Approved"| MergePR[Merge PR]
        ReviewPR --> |"Changes Requested"| UpdatePR[Update PR]
        UpdatePR --> ReviewPR
    end
    
    MergePR --> MoreVulnerabilities{More Vulnerabilities?}
    MoreVulnerabilities --> |"Yes"| SelectModule
    MoreVulnerabilities --> |"No"| End([End])
    
    subgraph SpecialCases["Special Cases"]
        AdjustUpdate --> AssessAlternatives[Consider Alternative Solutions]
        AssessAlternatives --> ContactMaintainer[Contact Package Maintainer]
    end
    
    subgraph CI_CDIntegration["CI/CD Integration"]
        MergePR --> CI_CD[CI/CD Pipeline]
        CI_CD --> SecurityChecks[Security Checks]
        SecurityChecks --> AuditCICheck[audit-ci Check]
        SecurityChecks --> GrypeCheck[Grype Scan]
        AuditCICheck --> PipelineResult
        GrypeCheck --> PipelineResult
        PipelineResult{Pass?}
        PipelineResult --> |"Yes"| Deploy[Deploy]
        PipelineResult --> |"No"| FixSecurityIssues[Fix Security Issues]
        FixSecurityIssues --> SelectModule
    end
    
    style Start fill:#66ccff,stroke:#333,stroke-width:2px
    style End fill:#66ccff,stroke:#333,stroke-width:2px
    style Critical fill:#ff6666,stroke:#333,stroke-width:1px
    style High fill:#ffcc66,stroke:#333,stroke-width:1px
    style Medium fill:#ffff66,stroke:#333,stroke-width:1px
    style Low fill:#99ff99,stroke:#333,stroke-width:1px
    style TriageProcess fill:#f0f0f0,stroke:#333,stroke-width:1px
    style UpdateProcess fill:#f0f0f0,stroke:#333,stroke-width:1px
    style SpecialCases fill:#f9e0ff,stroke:#333,stroke-width:1px
    style DetectionTools fill:#e6f3ff,stroke:#333,stroke-width:1px
    style CI_CDIntegration fill:#fff0e6,stroke:#333,stroke-width:1px
    style ConfigureAllowlist fill:#f9e0ff,stroke:#333,stroke-width:1px
    style UpdateAuditCI fill:#f9e0ff,stroke:#333,stroke-width:1px
    style UpdateGrype fill:#f9e0ff,stroke:#333,stroke-width:1px 