<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3268px" preserveAspectRatio="none" style="width:1702px;height:3268px;background:#FFFFFF;" version="1.1" viewBox="0 0 1702 3268" width="1702px" zoomAndPan="magnify">
  <title>2.2.1. Fulfil Handler Consume (Success) individual transfers from Bulk</title>
  <defs/>
  <g>
    <text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="556.2471" x="574.6377" y="27.9951">2.2.1. Fulfil Handler Consume (Success) individual transfers from Bulk</text>
    <rect fill="#FFFFE0" height="3211.8672" style="stroke:#181818;stroke-width:0.5;" width="1615.0596" x="16" y="43.2969"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112.0361" x="767.5117" y="55.3638">Central Service</text>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="62.083" y="179.9922"/>
    <rect fill="#FFFFFF" height="3045.1406" style="stroke:#181818;stroke-width:1.0;" width="10" x="367.0293" y="134.7266"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="908.8237" y="2529.0781"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1117.877" y="3134.8672"/>
    <rect fill="#FFFFFF" height="120.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1191.5078"/>
    <rect fill="#FFFFFF" height="150.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1519.1016"/>
    <rect fill="#FFFFFF" height="136.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1752.2969"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1988.3594"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="1220.6406"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="1548.2344"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="1781.4297"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="2017.4922"/>
    <rect fill="none" height="2542.5547" style="stroke:#000000;stroke-width:1.5;" width="1686.5225" x="10" y="141.7266"/>
    <rect fill="none" height="105.5313" style="stroke:#000000;stroke-width:1.5;" width="553.1763" x="302.48" y="224.9922"/>
    <rect fill="none" height="74.3984" style="stroke:#000000;stroke-width:1.5;" width="533.1763" x="312.48" y="249.125"/>
    <rect fill="none" height="104.3359" style="stroke:#000000;stroke-width:1.5;" width="746.1147" x="312.48" y="344.5234"/>
    <rect fill="none" height="139.1719" style="stroke:#000000;stroke-width:1.5;" width="991.4087" x="312.48" y="462.8594"/>
    <rect fill="none" height="158.4688" style="stroke:#000000;stroke-width:1.5;" width="1324.5796" x="312.48" y="616.0313"/>
    <rect fill="none" height="335.6094" style="stroke:#000000;stroke-width:1.5;" width="1031.4087" x="292.48" y="788.5"/>
    <rect fill="none" height="239.7344" style="stroke:#000000;stroke-width:1.5;" width="1011.4087" x="302.48" y="812.6328"/>
    <rect fill="none" height="166.4688" style="stroke:#000000;stroke-width:1.5;" width="991.4087" x="312.48" y="878.8984"/>
    <rect fill="none" height="1539.1719" style="stroke:#000000;stroke-width:1.5;" width="1394.0425" x="292.48" y="1138.1094"/>
    <rect fill="none" height="243.3281" style="stroke:#000000;stroke-width:1.5;" width="1367.6362" x="302.48" y="1441.5703"/>
    <rect fill="none" height="212.1953" style="stroke:#000000;stroke-width:1.5;" width="1347.6362" x="312.48" y="1465.7031"/>
    <rect fill="none" height="197.9297" style="stroke:#000000;stroke-width:1.5;" width="1344.9868" x="312.48" y="1698.8984"/>
    <rect fill="none" height="759.4531" style="stroke:#000000;stroke-width:1.5;" width="1374.0425" x="302.48" y="1910.8281"/>
    <rect fill="none" height="182.7969" style="stroke:#000000;stroke-width:1.5;" width="1354.0425" x="312.48" y="1934.9609"/>
    <rect fill="none" height="74.3984" style="stroke:#000000;stroke-width:1.5;" width="404.4458" x="312.48" y="2588.8828"/>
    <rect fill="none" height="474.5859" style="stroke:#000000;stroke-width:1.5;" width="884.6792" x="312.48" y="2698.2813"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="67" x2="67" y1="124.7266" y2="3189.8672"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="371.48" x2="371.48" y1="124.7266" y2="3189.8672"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="912.9268" x2="912.9268" y1="124.7266" y2="3189.8672"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1018.7207" x2="1018.7207" y1="124.7266" y2="3189.8672"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1122.5947" x2="1122.5947" y1="124.7266" y2="3189.8672"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1245.1592" x2="1245.1592" y1="124.7266" y2="3189.8672"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1351.8887" x2="1351.8887" y1="124.7266" y2="3189.8672"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1577.3232" x2="1577.3232" y1="124.7266" y2="3189.8672"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="90.166" x="24" y="89.4297"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="90.166" x="20" y="93.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.166" x="27" y="113.4248">Fulfil-Topic</text>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="90.166" x="24" y="3188.8672"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="90.166" x="20" y="3192.8672"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.166" x="27" y="3212.8623">Fulfil-Topic</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.0986" x="322.48" y="121.4248">Fulfil Handler</text>
    <ellipse cx="372.0293" cy="92.4297" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="368.0293,80.4297,374.0293,75.4297,372.0293,80.4297,374.0293,85.4297,368.0293,80.4297" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.0986" x="322.48" y="3201.8623">Fulfil Handler</text>
    <ellipse cx="372.0293" cy="3221.1641" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="368.0293,3209.1641,374.0293,3204.1641,372.0293,3209.1641,374.0293,3214.1641,368.0293,3209.1641" style="stroke:#181818;stroke-width:1.0;"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="129.7939" x="850.9268" y="73.1328"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="129.7939" x="846.9268" y="77.1328"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="892.0337" y="97.1279">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7939" x="853.9268" y="113.4248">transfer-position</text>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="129.7939" x="850.9268" y="3188.8672"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="129.7939" x="846.9268" y="3192.8672"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="892.0337" y="3212.8623">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7939" x="853.9268" y="3229.1592">transfer-position</text>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="53.874" x="994.7207" y="73.1328"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="53.874" x="990.7207" y="77.1328"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="997.8677" y="97.1279">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.874" x="997.7207" y="113.4248">event</text>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="53.874" x="994.7207" y="3188.8672"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="53.874" x="990.7207" y="3192.8672"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="997.8677" y="3212.8623">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.874" x="997.7207" y="3229.1592">event</text>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="124.5645" x="1062.5947" y="73.1328"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="124.5645" x="1058.5947" y="77.1328"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="1101.0869" y="97.1279">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.5645" x="1065.5947" y="113.4248">bulk-processing</text>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="124.5645" x="1062.5947" y="3188.8672"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="124.5645" x="1058.5947" y="3192.8672"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="1101.0869" y="3212.8623">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.5645" x="1065.5947" y="3229.1592">bulk-processing</text>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="92.7295" x="1201.1592" y="73.1328"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="92.7295" x="1197.1592" y="77.1328"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="1223.7339" y="97.1279">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.7295" x="1204.1592" y="113.4248">notification</text>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="92.7295" x="1201.1592" y="3188.8672"/>
    <rect fill="#E2E2F0" height="46.5938" style="stroke:#181818;stroke-width:0.5;" width="92.7295" x="1197.1592" y="3192.8672"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5801" x="1223.7339" y="3212.8623">topic-</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.7295" x="1204.1592" y="3229.1592">notification</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.8359" x="1303.8887" y="121.4248">Position DAO</text>
    <ellipse cx="1352.3066" cy="92.4297" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <line style="stroke:#181818;stroke-width:0.5;" x1="1340.3066" x2="1364.3066" y1="106.4297" y2="106.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.8359" x="1303.8887" y="3201.8623">Position DAO</text>
    <ellipse cx="1352.3066" cy="3221.1641" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <line style="stroke:#181818;stroke-width:0.5;" x1="1340.3066" x2="1364.3066" y1="3235.1641" y2="3235.1641"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.7363" x="1528.3232" y="121.4248">Central Store</text>
    <path d="M1559.6914,72.4297 C1559.6914,62.4297 1577.6914,62.4297 1577.6914,62.4297 C1577.6914,62.4297 1595.6914,62.4297 1595.6914,72.4297 L1595.6914,98.4297 C1595.6914,108.4297 1577.6914,108.4297 1577.6914,108.4297 C1577.6914,108.4297 1559.6914,108.4297 1559.6914,98.4297 L1559.6914,72.4297 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/>
    <path d="M1559.6914,72.4297 C1559.6914,82.4297 1577.6914,82.4297 1577.6914,82.4297 C1577.6914,82.4297 1595.6914,82.4297 1595.6914,72.4297 " fill="none" style="stroke:#181818;stroke-width:1.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.7363" x="1528.3232" y="3201.8623">Central Store</text>
    <path d="M1559.6914,3215.1641 C1559.6914,3205.1641 1577.6914,3205.1641 1577.6914,3205.1641 C1577.6914,3205.1641 1595.6914,3205.1641 1595.6914,3215.1641 L1595.6914,3241.1641 C1595.6914,3251.1641 1577.6914,3251.1641 1577.6914,3251.1641 C1577.6914,3251.1641 1559.6914,3251.1641 1559.6914,3241.1641 L1559.6914,3215.1641 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/>
    <path d="M1559.6914,3215.1641 C1559.6914,3225.1641 1577.6914,3225.1641 1577.6914,3225.1641 C1577.6914,3225.1641 1595.6914,3225.1641 1595.6914,3215.1641 " fill="none" style="stroke:#181818;stroke-width:1.5;"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="62.083" y="179.9922"/>
    <rect fill="#FFFFFF" height="3045.1406" style="stroke:#181818;stroke-width:1.0;" width="10" x="367.0293" y="134.7266"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="908.8237" y="2529.0781"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1117.877" y="3134.8672"/>
    <rect fill="#FFFFFF" height="120.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1191.5078"/>
    <rect fill="#FFFFFF" height="150.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1519.1016"/>
    <rect fill="#FFFFFF" height="136.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1752.2969"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1347.3066" y="1988.3594"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="1220.6406"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="1548.2344"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="1781.4297"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1572.6914" y="2017.4922"/>
    <path d="M10,141.7266 L300.9209,141.7266 L300.9209,148.8594 L290.9209,158.8594 L10,158.8594 L10,141.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="2542.5547" style="stroke:#000000;stroke-width:1.5;" width="1686.5225" x="10" y="141.7266"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="245.9209" x="25" y="154.7935">Fulfil Handler Consume (Success)</text>
    <polygon fill="#181818" points="83.083,175.9922,73.083,179.9922,83.083,183.9922,79.083,179.9922" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="77.083" x2="366.0293" y1="179.9922" y2="179.9922"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="89.083" y="174.9263">1</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262.9009" x="102.1284" y="174.9263">Consume Fulfil event message for Payer</text>
    <path d="M302.48,224.9922 L389.4316,224.9922 L389.4316,232.125 L379.4316,242.125 L302.48,242.125 L302.48,224.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="105.5313" style="stroke:#000000;stroke-width:1.5;" width="553.1763" x="302.48" y="224.9922"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.9517" x="317.48" y="238.0591">break</text>
    <path d="M312.48,249.125 L464.5015,249.125 L464.5015,256.2578 L454.5015,266.2578 L312.48,266.2578 L312.48,249.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="74.3984" style="stroke:#000000;stroke-width:1.5;" width="533.1763" x="312.48" y="249.125"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107.0215" x="327.48" y="262.1919">Validate Event</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="419.0293" y1="302.5234" y2="302.5234"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="419.0293" x2="419.0293" y1="302.5234" y2="315.5234"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="378.0293" x2="419.0293" y1="315.5234" y2="315.5234"/>
    <polygon fill="#181818" points="387.0293,298.5234,377.0293,302.5234,387.0293,306.5234,383.0293,302.5234" style="stroke:#181818;stroke-width:1.0;"/>
    <polygon fill="#181818" points="388.0293,311.5234,378.0293,315.5234,388.0293,319.5234,384.0293,315.5234" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="384.0293" y="289.8911">2</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.5815" x="397.0747" y="282.3247">Validate event - Rule: type == &apos;fulfil&apos; &amp;&amp; action == &apos;bulk-commit&apos;</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.2671" x="397.0747" y="297.4575">Error codes:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="490.4741" y="297.4575">2001</text>
    <path d="M312.48,344.5234 L545.3389,344.5234 L545.3389,351.6563 L535.3389,361.6563 L312.48,361.6563 L312.48,344.5234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="104.3359" style="stroke:#000000;stroke-width:1.5;" width="746.1147" x="312.48" y="344.5234"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="187.8589" x="327.48" y="357.5903">Persist Event Information</text>
    <polygon fill="#181818" points="1007.6577,378.7891,1017.6577,382.7891,1007.6577,386.7891,1011.6577,382.7891" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1013.6577" y1="382.7891" y2="382.7891"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="384.0293" y="377.7231">3</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.1147" x="397.0747" y="377.7231">Publish event information</text>
    <rect fill="none" height="53.0703" style="stroke:#000000;stroke-width:1.5;" width="732.1147" x="319.48" y="390.7891"/>
    <path d="M319.48,390.7891 L384.48,390.7891 L384.48,397.7891 L374.48,407.7891 L319.48,407.7891 L319.48,390.7891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.8838" x="332.48" y="404.856">ref</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="145.5117" x="612.7815" y="422.9277">Event Handler Consume</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="683.6301" y="436.8965"> </text>
    <path d="M312.48,462.8594 L553.2925,462.8594 L553.2925,469.9922 L543.2925,479.9922 L312.48,479.9922 L312.48,462.8594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="139.1719" style="stroke:#000000;stroke-width:1.5;" width="991.4087" x="312.48" y="462.8594"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="195.8125" x="327.48" y="475.9263">Validate FSPIOP-Signature</text>
    <rect fill="none" height="67.0391" style="stroke:#000000;stroke-width:1.5;" width="977.4087" x="319.48" y="504.9922"/>
    <path d="M319.48,504.9922 L384.48,504.9922 L384.48,511.9922 L374.48,521.9922 L319.48,521.9922 L319.48,504.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.8838" x="332.48" y="519.0591">ref</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="212.9473" x="641.5115" y="537.1309">Validate message.content.headers.</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="120.3984" x="854.4587" y="537.1309">FSPIOP-Signature</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="82.4004" x="732.5164" y="551.0996">Error codes:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="65.1211" x="818.7312" y="551.0996">3105/3106</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="806.2771" y="565.0684"> </text>
    <path d="M312.48,616.0313 L541.124,616.0313 L541.124,623.1641 L531.124,633.1641 L312.48,633.1641 L312.48,616.0313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="158.4688" style="stroke:#000000;stroke-width:1.5;" width="1324.5796" x="312.48" y="616.0313"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183.644" x="327.48" y="629.0981">Validate Duplicate Check</text>
    <polygon fill="#181818" points="1565.6914,675.2969,1575.6914,679.2969,1565.6914,683.2969,1569.6914,679.2969" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1571.6914" y1="679.2969" y2="679.2969"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="384.0293" y="674.231">4</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.5791" x="397.0747" y="674.231">Request Duplicate Check</text>
    <rect fill="none" height="53.0703" style="stroke:#000000;stroke-width:1.5;" width="1310.5796" x="319.48" y="687.2969"/>
    <path d="M319.48,687.2969 L384.48,687.2969 L384.48,694.2969 L374.48,704.2969 L319.48,704.2969 L319.48,687.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.8838" x="332.48" y="701.3638">ref</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="150.9961" x="899.2717" y="719.4355">Request Duplicate Check</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="972.8625" y="733.4043"> </text>
    <polygon fill="#181818" points="388.0293,762.5,378.0293,766.5,388.0293,770.5,384.0293,766.5" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="382.0293" x2="1576.6914" y1="766.5" y2="766.5"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="394.0293" y="761.4341">5</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418.1265" x="407.0747" y="761.4341">Return { hasDuplicateId: Boolean, hasDuplicateHash: Boolean }</text>
    <path d="M292.48,788.5 L356.9229,788.5 L356.9229,795.6328 L346.9229,805.6328 L292.48,805.6328 L292.48,788.5 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="335.6094" style="stroke:#000000;stroke-width:1.5;" width="1031.4087" x="292.48" y="788.5"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="307.48" y="801.5669">alt</text>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="358.5796" x="371.9229" y="800.7104">[hasDuplicateId == TRUE &amp;&amp; hasDuplicateHash == TRUE]</text>
    <path d="M302.48,812.6328 L389.4316,812.6328 L389.4316,819.7656 L379.4316,829.7656 L302.48,829.7656 L302.48,812.6328 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="239.7344" style="stroke:#000000;stroke-width:1.5;" width="1011.4087" x="302.48" y="812.6328"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.9517" x="317.48" y="825.6997">break</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="419.0293" y1="850.8984" y2="850.8984"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="419.0293" x2="419.0293" y1="850.8984" y2="863.8984"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="378.0293" x2="419.0293" y1="863.8984" y2="863.8984"/>
    <polygon fill="#181818" points="388.0293,859.8984,378.0293,863.8984,388.0293,867.8984,384.0293,863.8984" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="384.0293" y="845.8325">6</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.7344" x="397.0747" y="845.8325">stateRecord = await getTransferState(transferId)</text>
    <path d="M312.48,878.8984 L376.9229,878.8984 L376.9229,886.0313 L366.9229,896.0313 L312.48,896.0313 L312.48,878.8984 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="166.4688" style="stroke:#000000;stroke-width:1.5;" width="991.4087" x="312.48" y="878.8984"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="327.48" y="891.9653">alt</text>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="329.8442" x="391.9229" y="891.1089">[endStateList.includes(stateRecord.transferStateId)]</text>
    <rect fill="none" height="53.0703" style="stroke:#000000;stroke-width:1.5;" width="977.4087" x="319.48" y="921.0313"/>
    <path d="M319.48,921.0313 L384.48,921.0313 L384.48,928.0313 L374.48,938.0313 L319.48,938.0313 L319.48,921.0313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.8838" x="332.48" y="935.0981">ref</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="122.6719" x="746.8484" y="953.1699">getTransfer callback</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="806.2771" y="967.1387"> </text>
    <polygon fill="#181818" points="1233.5239,996.2344,1243.5239,1000.2344,1233.5239,1004.2344,1237.5239,1000.2344" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1239.5239" y1="1000.2344" y2="1000.2344"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="384.0293" y="995.1685">7</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.3306" x="397.0747" y="995.1685">Produce message</text>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.48" x2="1303.8887" y1="1009.2344" y2="1009.2344"/>
    <path d="M382,1015.2344 L382,1040.2344 L578,1040.2344 L578,1025.2344 L568,1015.2344 L382,1015.2344 " fill="#D3D3D3" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M568,1015.2344 L568,1025.2344 L578,1025.2344 L568,1015.2344 " fill="#D3D3D3" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.9888" x="388" y="1032.3013">Ignore - resend in progress</text>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="292.48" x2="1323.8887" y1="1060.3672" y2="1060.3672"/>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="364.6328" x="297.48" y="1070.5776">[hasDuplicateId == TRUE &amp;&amp; hasDuplicateHash == FALSE]</text>
    <path d="M382,1079.1719 L382,1104.1719 L751,1104.1719 L751,1089.1719 L741,1079.1719 L382,1079.1719 " fill="#D3D3D3" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M741,1079.1719 L741,1089.1719 L751,1089.1719 L741,1079.1719 " fill="#D3D3D3" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.1626" x="388" y="1096.2388">Validate Prepare Transfer (failure) - Modified Request</text>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="292.48" x2="1323.8887" y1="1110.3047" y2="1110.3047"/>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="167.4277" x="297.48" y="1120.5151">[hasDuplicateId == FALSE]</text>
    <path d="M292.48,1138.1094 L631.3701,1138.1094 L631.3701,1145.2422 L621.3701,1155.2422 L292.48,1155.2422 L292.48,1138.1094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="1539.1719" style="stroke:#000000;stroke-width:1.5;" width="1394.0425" x="292.48" y="1138.1094"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="293.8901" x="307.48" y="1151.1763">Validate and persist Transfer Fulfilment</text>
    <polygon fill="#181818" points="1335.3066,1187.5078,1345.3066,1191.5078,1335.3066,1195.5078,1339.3066,1191.5078" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1341.3066" y1="1191.5078" y2="1191.5078"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="384.0293" y="1178.8755">8</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.5493" x="397.0747" y="1171.3091">Request information for the validate checks</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.5293" x="397.0747" y="1186.4419">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="482.7363" y="1186.4419">2003</text>
    <polygon fill="#181818" points="1560.6914,1216.6406,1570.6914,1220.6406,1560.6914,1224.6406,1564.6914,1220.6406" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1357.3066" x2="1566.6914" y1="1220.6406" y2="1220.6406"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="1364.3066" y="1215.5747">9</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.0337" x="1377.3521" y="1215.5747">Fetch from database</text>
    <polygon fill="#FFFFE0" points="1550,1233.6406,1605,1233.6406,1615,1244.6406,1605,1256.6406,1550,1256.6406,1540,1244.6406,1550,1233.6406" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.3398" x="1552" y="1249.7075">transfer</text>
    <polygon fill="#181818" points="1368.3066,1278.9063,1358.3066,1282.9063,1368.3066,1286.9063,1364.3066,1282.9063" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1362.3066" x2="1576.6914" y1="1282.9063" y2="1282.9063"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1374.3066" y="1277.8403">10</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="1396.3975" y="1277.8403"> </text>
    <polygon fill="#181818" points="388.0293,1308.0391,378.0293,1312.0391,388.0293,1316.0391,384.0293,1312.0391" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="382.0293" x2="1351.3066" y1="1312.0391" y2="1312.0391"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="394.0293" y="1306.9731">11</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.4233" x="416.1201" y="1306.9731">Return transfer</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="419.0293" y1="1356.3047" y2="1356.3047"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="419.0293" x2="419.0293" y1="1356.3047" y2="1369.3047"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="378.0293" x2="419.0293" y1="1369.3047" y2="1369.3047"/>
    <polygon fill="#181818" points="388.0293,1365.3047,378.0293,1369.3047,388.0293,1373.3047,384.0293,1369.3047" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="1343.6724">12</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="485.7036" x="406.1201" y="1336.106">Validate that Transfer.ilpCondition = SHA-256 (content.payload.fulfilment)</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.5293" x="406.1201" y="1351.2388">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="491.7817" y="1351.2388">2001</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="419.0293" y1="1413.5703" y2="1413.5703"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="419.0293" x2="419.0293" y1="1413.5703" y2="1426.5703"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="378.0293" x2="419.0293" y1="1426.5703" y2="1426.5703"/>
    <polygon fill="#181818" points="388.0293,1422.5703,378.0293,1426.5703,388.0293,1430.5703,384.0293,1426.5703" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="1400.938">13</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.3687" x="406.1201" y="1393.3716">Validate expirationDate</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.5293" x="406.1201" y="1408.5044">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="491.7817" y="1408.5044">3303</text>
    <path d="M302.48,1441.5703 L371.9312,1441.5703 L371.9312,1448.7031 L361.9312,1458.7031 L302.48,1458.7031 L302.48,1441.5703 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="243.3281" style="stroke:#000000;stroke-width:1.5;" width="1367.6362" x="302.48" y="1441.5703"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4512" x="317.48" y="1454.6372">opt</text>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="263.7422" x="386.9312" y="1453.7808">[Transfer.ilpCondition validate successful]</text>
    <path d="M312.48,1465.7031 L625.2939,1465.7031 L625.2939,1472.8359 L615.2939,1482.8359 L312.48,1482.8359 L312.48,1465.7031 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="212.1953" style="stroke:#000000;stroke-width:1.5;" width="1347.6362" x="312.48" y="1465.7031"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="267.814" x="327.48" y="1478.77">Request current Settlement Window</text>
    <polygon fill="#181818" points="1335.3066,1515.1016,1345.3066,1519.1016,1335.3066,1523.1016,1339.3066,1519.1016" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1341.3066" y1="1519.1016" y2="1519.1016"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="1506.4692">14</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="401.8892" x="406.1201" y="1498.9028">Request to retrieve current/latest transfer settlement window</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.5293" x="406.1201" y="1514.0356">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="491.7817" y="1514.0356">2003</text>
    <polygon fill="#181818" points="1560.6914,1544.2344,1570.6914,1548.2344,1560.6914,1552.2344,1564.6914,1548.2344" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1357.3066" x2="1566.6914" y1="1548.2344" y2="1548.2344"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1364.3066" y="1543.1685">15</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.2939" x="1386.3975" y="1543.1685">Fetch settlementWindowId</text>
    <polygon fill="#FFFFE0" points="1514,1561.2344,1640,1561.2344,1650,1572.2344,1640,1584.2344,1514,1584.2344,1504,1572.2344,1514,1561.2344" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1162" x="1516" y="1577.3013">settlementWindow</text>
    <polygon fill="#181818" points="1368.3066,1606.5,1358.3066,1610.5,1368.3066,1614.5,1364.3066,1610.5" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1362.3066" x2="1576.6914" y1="1610.5" y2="1610.5"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1374.3066" y="1605.4341">16</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="1396.3975" y="1605.4341"> </text>
    <polygon fill="#181818" points="388.0293,1665.8984,378.0293,1669.8984,388.0293,1673.8984,384.0293,1669.8984" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="382.0293" x2="1351.3066" y1="1669.8984" y2="1669.8984"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="394.0293" y="1649.6997">17</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="497.0596" x="416.1201" y="1634.5669">Return settlementWindowId to be appended during transferFulfilment insert</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.7612" x="416.1201" y="1649.6997">TODO</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="449.4268" x="457.8813" y="1649.6997">: During settlement design make sure transfers in &apos;RECEIVED-FULFIL&apos;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.5313" x="416.1201" y="1664.8325">state are updated to the next settlement window</text>
    <path d="M312.48,1698.8984 L484.6743,1698.8984 L484.6743,1706.0313 L474.6743,1716.0313 L312.48,1716.0313 L312.48,1698.8984 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="197.9297" style="stroke:#000000;stroke-width:1.5;" width="1344.9868" x="312.48" y="1698.8984"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="127.1943" x="327.48" y="1711.9653">Persist fulfilment</text>
    <polygon fill="#181818" points="1335.3066,1748.2969,1345.3066,1752.2969,1335.3066,1756.2969,1339.3066,1752.2969" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1341.3066" y1="1752.2969" y2="1752.2969"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="1739.6646">18</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="514.084" x="406.1201" y="1732.0981">Persist fulfilment with the result of the above check (transferFulfilment.isValid)</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.5293" x="406.1201" y="1747.231">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="491.7817" y="1747.231">2003</text>
    <polygon fill="#181818" points="1560.6914,1777.4297,1570.6914,1781.4297,1560.6914,1785.4297,1564.6914,1781.4297" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1357.3066" x2="1566.6914" y1="1781.4297" y2="1781.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1364.3066" y="1776.3638">19</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.0234" x="1386.3975" y="1776.3638">Persist to database</text>
    <polygon fill="#FFFFE0" points="1517,1824.4297,1637,1824.4297,1647,1843.4297,1637,1862.4297,1517,1862.4297,1507,1843.4297,1517,1824.4297" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.4668" x="1519" y="1840.4966">transferFulfilment</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.1592" x="1519" y="1855.6294">transferExtension</text>
    <polygon fill="#181818" points="388.0293,1884.8281,378.0293,1888.8281,388.0293,1892.8281,384.0293,1888.8281" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="382.0293" x2="1351.3066" y1="1888.8281" y2="1888.8281"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="394.0293" y="1883.7622">20</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9346" x="416.1201" y="1883.7622">Return success</text>
    <path d="M302.48,1910.8281 L366.9229,1910.8281 L366.9229,1917.9609 L356.9229,1927.9609 L302.48,1927.9609 L302.48,1910.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="759.4531" style="stroke:#000000;stroke-width:1.5;" width="1374.0425" x="302.48" y="1910.8281"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="317.48" y="1923.895">alt</text>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="263.7422" x="381.9229" y="1923.0386">[Transfer.ilpCondition validate successful]</text>
    <path d="M312.48,1934.9609 L816.1172,1934.9609 L816.1172,1942.0938 L806.1172,1952.0938 L312.48,1952.0938 L312.48,1934.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="182.7969" style="stroke:#000000;stroke-width:1.5;" width="1354.0425" x="312.48" y="1934.9609"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="458.6372" x="327.48" y="1948.0278">Persist Transfer State (with transferState=&apos;RECEIVED-FULFIL&apos;)</text>
    <polygon fill="#181818" points="1335.3066,1984.3594,1345.3066,1988.3594,1335.3066,1992.3594,1339.3066,1988.3594" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1341.3066" y1="1988.3594" y2="1988.3594"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="1975.7271">21</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.0913" x="406.1201" y="1968.1606">Request to persist transfer state</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.5293" x="406.1201" y="1983.2935">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="491.7817" y="1983.2935">2003</text>
    <polygon fill="#181818" points="1560.6914,2013.4922,1570.6914,2017.4922,1560.6914,2021.4922,1564.6914,2017.4922" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1357.3066" x2="1566.6914" y1="2017.4922" y2="2017.4922"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1364.3066" y="2012.4263">22</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9731" x="1386.3975" y="2012.4263">Persist transfer state</text>
    <polygon fill="#FFFFE0" points="1507,2060.4922,1646,2060.4922,1656,2071.4922,1646,2083.4922,1507,2083.4922,1497,2071.4922,1507,2060.4922" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.5225" x="1509" y="2076.5591">transferStateChange</text>
    <polygon fill="#181818" points="388.0293,2105.7578,378.0293,2109.7578,388.0293,2113.7578,384.0293,2109.7578" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="382.0293" x2="1351.3066" y1="2109.7578" y2="2109.7578"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="394.0293" y="2104.6919">23</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9346" x="416.1201" y="2104.6919">Return success</text>
    <path d="M382,2129.7578 L382,2502.7578 L650,2502.7578 L650,2139.7578 L640,2129.7578 L382,2129.7578 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M640,2129.7578 L640,2139.7578 L650,2139.7578 L640,2129.7578 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.3564" x="388" y="2146.8247">Message:</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="388" y="2161.9575">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.8032" x="404.5293" y="2177.0903">id: &lt;messageId&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.731" x="404.5293" y="2192.2231">from: &lt;payeeFspName&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.5898" x="404.5293" y="2207.356">to: &lt;payerFspName&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.311" x="404.5293" y="2222.4888">type: &quot;application/json&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.5552" x="404.5293" y="2237.6216">content: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.4482" x="421.0586" y="2252.7544">headers: &lt;transferHeaders&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.3091" x="421.0586" y="2267.8872">payload: &lt;transferMessage&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="404.5293" y="2283.02">},</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.79" x="404.5293" y="2298.1528">metadata: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8091" x="421.0586" y="2313.2856">event: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6357" x="437.5879" y="2328.4185">id: &lt;uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.9961" x="437.5879" y="2343.5513">responseTo: &lt;previous.uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.1362" x="437.5879" y="2358.6841">type: &quot;position&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0786" x="437.5879" y="2373.8169">action: &quot;bulk-commit&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.3462" x="437.5879" y="2388.9497">createdAt: &lt;timestamp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.7148" x="437.5879" y="2404.0825">state: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.4004" x="454.1172" y="2419.2153">status: &quot;success&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1343" x="454.1172" y="2434.3481">code: 0</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="437.5879" y="2449.481">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="421.0586" y="2464.6138">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="404.5293" y="2479.7466">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="388" y="2494.8794">}</text>
    <polygon fill="#181818" points="896.8237,2525.0781,906.8237,2529.0781,896.8237,2533.0781,900.8237,2529.0781" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="902.8237" y1="2529.0781" y2="2529.0781"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="2524.0122">24</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265.2939" x="406.1201" y="2524.0122">Route &amp; Publish Position event for Payee</text>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="302.48" x2="1676.5225" y1="2568.0781" y2="2568.0781"/>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="245.7168" x="307.48" y="2578.2886">[Validate Fulfil Transfer not successful]</text>
    <path d="M312.48,2588.8828 L399.4316,2588.8828 L399.4316,2596.0156 L389.4316,2606.0156 L312.48,2606.0156 L312.48,2588.8828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="74.3984" style="stroke:#000000;stroke-width:1.5;" width="404.4458" x="312.48" y="2588.8828"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.9517" x="327.48" y="2601.9497">break</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="419.0293" y1="2642.2813" y2="2642.2813"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="419.0293" x2="419.0293" y1="2642.2813" y2="2655.2813"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="378.0293" x2="419.0293" y1="2655.2813" y2="2655.2813"/>
    <polygon fill="#181818" points="388.0293,2651.2813,378.0293,2655.2813,388.0293,2659.2813,384.0293,2655.2813" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="2629.6489">25</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.8057" x="406.1201" y="2622.0825">Route &amp; Publish Notification event for Payee</text>
    <text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="230.9341" x="406.1201" y="2637.2153">Reference: Failure in validation</text>
    <path d="M312.48,2698.2813 L588.4141,2698.2813 L588.4141,2705.4141 L578.4141,2715.4141 L312.48,2715.4141 L312.48,2698.2813 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="474.5859" style="stroke:#000000;stroke-width:1.5;" width="884.6792" x="312.48" y="2698.2813"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="230.9341" x="327.48" y="2711.3481">Reference: Failure in validation</text>
    <path d="M382,2720.4141 L382,3093.4141 L650,3093.4141 L650,2730.4141 L640,2720.4141 L382,2720.4141 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M640,2720.4141 L640,2730.4141 L650,2730.4141 L640,2720.4141 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.3564" x="388" y="2737.481">Message:</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="388" y="2752.6138">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.8032" x="404.5293" y="2767.7466">id: &lt;messageId&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.7773" x="404.5293" y="2782.8794">from: &lt;ledgerName&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.2432" x="404.5293" y="2798.0122">to: &lt;payeeFspName&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.311" x="404.5293" y="2813.145">type: &quot;application/json&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.5552" x="404.5293" y="2828.2778">content: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.4482" x="421.0586" y="2843.4106">headers: &lt;transferHeaders&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.3091" x="421.0586" y="2858.5435">payload: &lt;transferMessage&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="404.5293" y="2873.6763">},</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.79" x="404.5293" y="2888.8091">metadata: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8091" x="421.0586" y="2903.9419">event: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6357" x="437.5879" y="2919.0747">id: &lt;uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.9961" x="437.5879" y="2934.2075">responseTo: &lt;previous.uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.311" x="437.5879" y="2949.3403">type: &quot;bulk-processing&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0786" x="437.5879" y="2964.4731">action: &quot;bulk-commit&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.3462" x="437.5879" y="2979.606">createdAt: &lt;timestamp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.7148" x="437.5879" y="2994.7388">state: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5352" x="454.1172" y="3009.8716">status: &quot;error&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1343" x="454.1172" y="3025.0044">code: 1</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="437.5879" y="3040.1372">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="421.0586" y="3055.27">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="404.5293" y="3070.4028">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="388" y="3085.5356">}</text>
    <polygon fill="#181818" points="1105.877,3130.8672,1115.877,3134.8672,1105.877,3138.8672,1109.877,3134.8672" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="377.0293" x2="1111.877" y1="3134.8672" y2="3134.8672"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="384.0293" y="3122.2349">26</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="394.7988" x="406.1201" y="3114.6685">Publish Notification event for Payee to Bulk Processing Topic</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.2671" x="406.1201" y="3129.8013">Error codes:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.084" x="499.5195" y="3129.8013">2003</text>
  </g>
</svg>
