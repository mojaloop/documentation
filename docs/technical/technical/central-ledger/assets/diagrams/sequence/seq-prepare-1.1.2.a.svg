<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3016px" preserveAspectRatio="none" style="width:1907px;height:3016px;background:#FFFFFF;" version="1.1" viewBox="0 0 1907 3016" width="1907px" zoomAndPan="magnify">
  <title>1.1.2.a. Position Handler Consume (single message)</title>
  <defs/>
  <g>
    <text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="412.918" x="748.8022" y="27.9951">1.1.2.a. Position Handler Consume (single message)</text>
    <rect fill="#FFFFE0" height="2959.8125" style="stroke:#181818;stroke-width:0.5;" width="1829.7598" x="16" y="43.2969"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112.0361" x="874.8618" y="55.3638">Central Service</text>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="101.687" y="179.9922"/>
    <rect fill="#FFFFFF" height="2771.0859" style="stroke:#181818;stroke-width:1.0;" width="10" x="426.584" y="134.7266"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1204.4766" y="1681.2344"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1204.4766" y="2875.8125"/>
    <rect fill="#FFFFFF" height="120.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="560.125"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="958.8516"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="1140.5156"/>
    <rect fill="#FFFFFF" height="120.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="1779.3047"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="2244.2969"/>
    <rect fill="#FFFFFF" height="135.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1450.4976" y="709.7891"/>
    <rect fill="#FFFFFF" height="135.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1450.4976" y="1928.9688"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="589.2578"/>
    <rect fill="#FFFFFF" height="77.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="738.9219"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="987.9844"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="1169.6484"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="1808.4375"/>
    <rect fill="#FFFFFF" height="77.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="1958.1016"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="2273.4297"/>
    <rect fill="none" height="2779.0859" style="stroke:#000000;stroke-width:1.5;" width="1891.5225" x="10" y="141.7266"/>
    <rect fill="none" height="90.3984" style="stroke:#000000;stroke-width:1.5;" width="579.1577" x="329.0137" y="224.9922"/>
    <rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="559.1577" x="339.0137" y="249.125"/>
    <rect fill="none" height="154.3359" style="stroke:#000000;stroke-width:1.5;" width="799.9771" x="339.0137" y="329.3906"/>
    <rect fill="none" height="2416.0859" style="stroke:#000000;stroke-width:1.5;" width="1562.5088" x="329.0137" y="497.7266"/>
    <rect fill="none" height="566.3906" style="stroke:#000000;stroke-width:1.5;" width="1526.4058" x="339.0137" y="521.8594"/>
    <rect fill="none" height="167.6641" style="stroke:#000000;stroke-width:1.5;" width="1542.5088" x="339.0137" y="1102.25"/>
    <rect fill="none" height="450.9922" style="stroke:#000000;stroke-width:1.5;" width="1526.4058" x="339.0137" y="1741.0391"/>
    <rect fill="none" height="167.6641" style="stroke:#000000;stroke-width:1.5;" width="1542.5088" x="339.0137" y="2206.0313"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="106" x2="106" y1="124.7266" y2="2937.8125"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="431.0137" x2="431.0137" y1="124.7266" y2="2937.8125"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1078.2417" x2="1078.2417" y1="124.7266" y2="2937.8125"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1208.9907" x2="1208.9907" y1="124.7266" y2="2937.8125"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1337.9624" x2="1337.9624" y1="124.7266" y2="2937.8125"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1454.7983" x2="1454.7983" y1="124.7266" y2="2937.8125"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1792.0234" x2="1792.0234" y1="124.7266" y2="2937.8125"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="169.374" x="24" y="89.4297"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="169.374" x="20" y="93.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.374" x="27" y="113.4248">topic-transfer-position</text>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="169.374" x="24" y="2936.8125"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="169.374" x="20" y="2940.8125"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.374" x="27" y="2960.8076">topic-transfer-position</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159.1406" x="349.0137" y="121.4248">Position Event Handler</text>
    <ellipse cx="431.584" cy="92.4297" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="427.584,80.4297,433.584,75.4297,431.584,80.4297,433.584,85.4297,427.584,80.4297" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159.1406" x="349.0137" y="2949.8076">Position Event Handler</text>
    <ellipse cx="431.584" cy="2969.1094" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="427.584,2957.1094,433.584,2952.1094,431.584,2957.1094,433.584,2962.1094,427.584,2957.1094" style="stroke:#181818;stroke-width:1.0;"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="96.749" x="1032.2417" y="89.4297"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="96.749" x="1028.2417" y="93.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.749" x="1035.2417" y="113.4248">Event-Topic</text>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="96.749" x="1032.2417" y="2936.8125"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="96.749" x="1028.2417" y="2940.8125"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.749" x="1035.2417" y="2960.8076">Event-Topic</text>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="136.9717" x="1142.9907" y="89.4297"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="136.9717" x="1138.9907" y="93.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.9717" x="1145.9907" y="113.4248">Notification-Topic</text>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="136.9717" x="1142.9907" y="2936.8125"/>
    <rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="136.9717" x="1138.9907" y="2940.8125"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.9717" x="1145.9907" y="2960.8076">Notification-Topic</text>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.8359" x="1289.9624" y="121.4248">Position DAO</text>
    <ellipse cx="1338.3804" cy="92.4297" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <line style="stroke:#181818;stroke-width:0.5;" x1="1326.3804" x2="1350.3804" y1="106.4297" y2="106.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.8359" x="1289.9624" y="2949.8076">Position DAO</text>
    <ellipse cx="1338.3804" cy="2969.1094" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <line style="stroke:#181818;stroke-width:0.5;" x1="1326.3804" x2="1350.3804" y1="2983.1094" y2="2983.1094"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.3984" x="1396.7983" y="121.4248">Participant DAO</text>
    <ellipse cx="1455.4976" cy="92.4297" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <line style="stroke:#181818;stroke-width:0.5;" x1="1443.4976" x2="1467.4976" y1="106.4297" y2="106.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.3984" x="1396.7983" y="2949.8076">Participant DAO</text>
    <ellipse cx="1455.4976" cy="2969.1094" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <line style="stroke:#181818;stroke-width:0.5;" x1="1443.4976" x2="1467.4976" y1="2983.1094" y2="2983.1094"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.7363" x="1743.0234" y="121.4248">Central Store</text>
    <path d="M1774.3916,72.4297 C1774.3916,62.4297 1792.3916,62.4297 1792.3916,62.4297 C1792.3916,62.4297 1810.3916,62.4297 1810.3916,72.4297 L1810.3916,98.4297 C1810.3916,108.4297 1792.3916,108.4297 1792.3916,108.4297 C1792.3916,108.4297 1774.3916,108.4297 1774.3916,98.4297 L1774.3916,72.4297 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/>
    <path d="M1774.3916,72.4297 C1774.3916,82.4297 1792.3916,82.4297 1792.3916,82.4297 C1792.3916,82.4297 1810.3916,82.4297 1810.3916,72.4297 " fill="none" style="stroke:#181818;stroke-width:1.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.7363" x="1743.0234" y="2949.8076">Central Store</text>
    <path d="M1774.3916,2963.1094 C1774.3916,2953.1094 1792.3916,2953.1094 1792.3916,2953.1094 C1792.3916,2953.1094 1810.3916,2953.1094 1810.3916,2963.1094 L1810.3916,2989.1094 C1810.3916,2999.1094 1792.3916,2999.1094 1792.3916,2999.1094 C1792.3916,2999.1094 1774.3916,2999.1094 1774.3916,2989.1094 L1774.3916,2963.1094 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/>
    <path d="M1774.3916,2963.1094 C1774.3916,2973.1094 1792.3916,2973.1094 1792.3916,2973.1094 C1792.3916,2973.1094 1810.3916,2973.1094 1810.3916,2963.1094 " fill="none" style="stroke:#181818;stroke-width:1.5;"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="101.687" y="179.9922"/>
    <rect fill="#FFFFFF" height="2771.0859" style="stroke:#181818;stroke-width:1.0;" width="10" x="426.584" y="134.7266"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1204.4766" y="1681.2344"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1204.4766" y="2875.8125"/>
    <rect fill="#FFFFFF" height="120.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="560.125"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="958.8516"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="1140.5156"/>
    <rect fill="#FFFFFF" height="120.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="1779.3047"/>
    <rect fill="#FFFFFF" height="121.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1333.3804" y="2244.2969"/>
    <rect fill="#FFFFFF" height="135.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1450.4976" y="709.7891"/>
    <rect fill="#FFFFFF" height="135.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1450.4976" y="1928.9688"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="589.2578"/>
    <rect fill="#FFFFFF" height="77.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="738.9219"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="987.9844"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="1169.6484"/>
    <rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="1808.4375"/>
    <rect fill="#FFFFFF" height="77.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="1958.1016"/>
    <rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1787.3916" y="2273.4297"/>
    <path d="M10,141.7266 L248.54,141.7266 L248.54,148.8594 L238.54,158.8594 L10,158.8594 L10,141.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="2779.0859" style="stroke:#000000;stroke-width:1.5;" width="1891.5225" x="10" y="141.7266"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="193.54" x="25" y="154.7935">Position Handler Consume</text>
    <polygon fill="#181818" points="122.687,175.9922,112.687,179.9922,122.687,183.9922,118.687,179.9922" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="116.687" x2="425.584" y1="179.9922" y2="179.9922"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="128.687" y="174.9263">1</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.8516" x="141.7324" y="174.9263">Consume Position event message for Payer</text>
    <path d="M329.0137,224.9922 L415.9653,224.9922 L415.9653,232.125 L405.9653,242.125 L329.0137,242.125 L329.0137,224.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="90.3984" style="stroke:#000000;stroke-width:1.5;" width="579.1577" x="329.0137" y="224.9922"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.9517" x="344.0137" y="238.0591">break</text>
    <path d="M339.0137,249.125 L491.0352,249.125 L491.0352,256.2578 L481.0352,266.2578 L339.0137,266.2578 L339.0137,249.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="559.1577" x="339.0137" y="249.125"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107.0215" x="354.0137" y="262.1919">Validate Event</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="478.584" y1="287.3906" y2="287.3906"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="478.584" x2="478.584" y1="287.3906" y2="300.3906"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="437.584" x2="478.584" y1="300.3906" y2="300.3906"/>
    <polygon fill="#181818" points="446.584,283.3906,436.584,287.3906,446.584,291.3906,442.584,287.3906" style="stroke:#181818;stroke-width:1.0;"/>
    <polygon fill="#181818" points="447.584,296.3906,437.584,300.3906,447.584,304.3906,443.584,300.3906" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="443.584" y="282.3247">2</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.542" x="456.6294" y="282.3247">Validate event - Rule: type == &apos;position&apos; &amp;&amp; action == &apos;prepare&apos;</text>
    <path d="M339.0137,329.3906 L571.8726,329.3906 L571.8726,336.5234 L561.8726,346.5234 L339.0137,346.5234 L339.0137,329.3906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="154.3359" style="stroke:#000000;stroke-width:1.5;" width="799.9771" x="339.0137" y="329.3906"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="187.8589" x="354.0137" y="342.4575">Persist Event Information</text>
    <polygon fill="#181818" points="1066.6162,388.6563,1076.6162,392.6563,1066.6162,396.6563,1070.6162,392.6563" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1072.6162" y1="392.6563" y2="392.6563"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="443.584" y="387.5903">3</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.1147" x="456.6294" y="387.5903">Publish event information</text>
    <rect fill="none" height="53.0703" style="stroke:#000000;stroke-width:1.5;" width="785.9771" x="346.0137" y="400.6563"/>
    <path d="M346.0137,400.6563 L411.0137,400.6563 L411.0137,407.6563 L401.0137,417.6563 L346.0137,417.6563 L346.0137,400.6563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.8838" x="359.0137" y="414.7231">ref</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="145.5117" x="666.2463" y="432.7949">Event Handler Consume</text>
    <text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="737.095" y="446.7637"> </text>
    <path d="M329.0137,497.7266 L393.4565,497.7266 L393.4565,504.8594 L383.4565,514.8594 L329.0137,514.8594 L329.0137,497.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="2416.0859" style="stroke:#000000;stroke-width:1.5;" width="1562.5088" x="329.0137" y="497.7266"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="344.0137" y="510.7935">alt</text>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="288.6372" x="408.4565" y="509.937">[Calulate &amp; Validate Latest Position (success)]</text>
    <path d="M339.0137,521.8594 L660.5176,521.8594 L660.5176,528.9922 L650.5176,538.9922 L339.0137,538.9922 L339.0137,521.8594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="566.3906" style="stroke:#000000;stroke-width:1.5;" width="1526.4058" x="339.0137" y="521.8594"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="276.5039" x="354.0137" y="534.9263">Calculate position and persist change</text>
    <polygon fill="#181818" points="1321.3804,556.125,1331.3804,560.125,1321.3804,564.125,1325.3804,560.125" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1327.3804" y1="560.125" y2="560.125"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="443.584" y="555.0591">4</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.4038" x="456.6294" y="555.0591">Request latest position from DB for Payer</text>
    <polygon fill="#181818" points="1775.3916,585.2578,1785.3916,589.2578,1775.3916,593.2578,1779.3916,589.2578" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1343.3804" x2="1781.3916" y1="589.2578" y2="589.2578"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="1350.3804" y="584.1919">5</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.7876" x="1363.4258" y="584.1919">Retrieve latest position from DB for Payer</text>
    <polygon fill="#FFFFE0" points="1739,602.2578,1845,602.2578,1855,613.2578,1845,625.2578,1739,625.2578,1729,613.2578,1739,602.2578" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4194" x="1741" y="618.3247">transferPosition</text>
    <polygon fill="#181818" points="1354.3804,647.5234,1344.3804,651.5234,1354.3804,655.5234,1350.3804,651.5234" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1348.3804" x2="1791.3916" y1="651.5234" y2="651.5234"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="1360.3804" y="646.4575">6</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.7876" x="1373.4258" y="646.4575">Retrieve latest position from DB for Payer</text>
    <polygon fill="#181818" points="447.584,676.6563,437.584,680.6563,447.584,684.6563,443.584,680.6563" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.584" x2="1337.3804" y1="680.6563" y2="680.6563"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="453.584" y="675.5903">7</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.2515" x="466.6294" y="675.5903">Return latest position</text>
    <polygon fill="#181818" points="1438.4976,705.7891,1448.4976,709.7891,1438.4976,713.7891,1442.4976,709.7891" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1444.4976" y1="709.7891" y2="709.7891"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="443.584" y="704.7231">8</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.8032" x="456.6294" y="704.7231">Request position limits for Payer Participant</text>
    <polygon fill="#181818" points="1775.3916,734.9219,1785.3916,738.9219,1775.3916,742.9219,1779.3916,738.9219" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1460.4976" x2="1781.3916" y1="738.9219" y2="738.9219"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="1467.4976" y="733.856">9</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.8032" x="1480.543" y="733.856">Request position limits for Payer Participant</text>
    <polygon fill="#FFFFE0" points="1738,751.9219,1844,751.9219,1854,770.9219,1844,789.9219,1738,789.9219,1728,770.9219,1738,751.9219" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.5859" x="1740" y="767.9888">participant</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.813" x="1740" y="783.1216">participantLimit</text>
    <polygon fill="#181818" points="1471.4976,812.3203,1461.4976,816.3203,1471.4976,820.3203,1467.4976,816.3203" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1465.4976" x2="1791.3916" y1="816.3203" y2="816.3203"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1477.4976" y="811.2544">10</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.0771" x="1499.5884" y="811.2544">Return position limits</text>
    <polygon fill="#181818" points="447.584,841.4531,437.584,845.4531,447.584,849.4531,443.584,845.4531" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.584" x2="1454.4976" y1="845.4531" y2="845.4531"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="453.584" y="840.3872">11</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.0771" x="475.6748" y="840.3872">Return position limits</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="478.584" y1="874.5859" y2="874.5859"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="478.584" x2="478.584" y1="874.5859" y2="887.5859"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="437.584" x2="478.584" y1="887.5859" y2="887.5859"/>
    <polygon fill="#181818" points="446.584,870.5859,436.584,874.5859,446.584,878.5859,442.584,874.5859" style="stroke:#181818;stroke-width:1.0;"/>
    <polygon fill="#181818" points="447.584,883.5859,437.584,887.5859,447.584,891.5859,443.584,887.5859" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="869.52">12</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.1772" x="465.6748" y="869.52">Calculate latest position (lpos) for prepare</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="478.584" y1="916.7188" y2="916.7188"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="478.584" x2="478.584" y1="916.7188" y2="929.7188"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="437.584" x2="478.584" y1="929.7188" y2="929.7188"/>
    <polygon fill="#181818" points="446.584,912.7188,436.584,916.7188,446.584,920.7188,442.584,916.7188" style="stroke:#181818;stroke-width:1.0;"/>
    <polygon fill="#181818" points="447.584,925.7188,437.584,929.7188,447.584,933.7188,443.584,929.7188" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="911.6528">13</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="590.9414" x="465.6748" y="911.6528">Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos &lt; netcap</text>
    <polygon fill="#181818" points="1321.3804,954.8516,1331.3804,958.8516,1321.3804,962.8516,1325.3804,958.8516" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1327.3804" y1="958.8516" y2="958.8516"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="953.7856">14</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277.8369" x="465.6748" y="953.7856">Request to persist latest position for Payer</text>
    <polygon fill="#181818" points="1775.3916,983.9844,1785.3916,987.9844,1775.3916,991.9844,1779.3916,987.9844" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1343.3804" x2="1781.3916" y1="987.9844" y2="987.9844"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1350.3804" y="982.9185">15</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.9629" x="1372.4712" y="982.9185">Persist latest position to DB for Payer</text>
    <polygon fill="#FFFFE0" points="1739,1030.9844,1845,1030.9844,1855,1041.9844,1845,1053.9844,1739,1053.9844,1729,1041.9844,1739,1030.9844" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4194" x="1741" y="1047.0513">transferPosition</text>
    <polygon fill="#181818" points="447.584,1076.25,437.584,1080.25,447.584,1084.25,443.584,1080.25" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.584" x2="1337.3804" y1="1080.25" y2="1080.25"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="453.584" y="1075.1841">16</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9346" x="475.6748" y="1075.1841">Return success</text>
    <path d="M339.0137,1102.25 L963.7896,1102.25 L963.7896,1109.3828 L953.7896,1119.3828 L339.0137,1119.3828 L339.0137,1102.25 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="167.6641" style="stroke:#000000;stroke-width:1.5;" width="1542.5088" x="339.0137" y="1102.25"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="579.7759" x="354.0137" y="1115.3169">Persist Transfer State (with transferState=&apos;RESERVED&apos; on position check pass)</text>
    <polygon fill="#181818" points="1321.3804,1136.5156,1331.3804,1140.5156,1321.3804,1144.5156,1325.3804,1140.5156" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1327.3804" y1="1140.5156" y2="1140.5156"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="1135.4497">17</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.0273" x="465.6748" y="1135.4497">Request to persist transfer</text>
    <polygon fill="#181818" points="1775.3916,1165.6484,1785.3916,1169.6484,1775.3916,1173.6484,1779.3916,1169.6484" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1343.3804" x2="1781.3916" y1="1169.6484" y2="1169.6484"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1350.3804" y="1164.5825">18</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9731" x="1372.4712" y="1164.5825">Persist transfer state</text>
    <polygon fill="#FFFFE0" points="1722,1212.6484,1861,1212.6484,1871,1223.6484,1861,1235.6484,1722,1235.6484,1712,1223.6484,1722,1212.6484" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.5225" x="1724" y="1228.7153">transferStateChange</text>
    <polygon fill="#181818" points="447.584,1257.9141,437.584,1261.9141,447.584,1265.9141,443.584,1261.9141" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.584" x2="1337.3804" y1="1261.9141" y2="1261.9141"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="453.584" y="1256.8481">19</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9346" x="475.6748" y="1256.8481">Return success</text>
    <path d="M441,1281.9141 L441,1654.9141 L715,1654.9141 L715,1291.9141 L705,1281.9141 L441,1281.9141 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M705,1281.9141 L705,1291.9141 L715,1291.9141 L705,1281.9141 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.3564" x="447" y="1298.981">Message:</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="447" y="1314.1138">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.0356" x="463.5293" y="1329.2466">id: &lt;transferMessage.transferId&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237.1738" x="463.5293" y="1344.3794">from: &lt;transferMessage.payerFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.3394" x="463.5293" y="1359.5122">to: &lt;transferMessage.payeeFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.2197" x="463.5293" y="1374.645">type: application/json</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.5552" x="463.5293" y="1389.7778">content: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.4482" x="480.0586" y="1404.9106">headers: &lt;transferHeaders&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.3091" x="480.0586" y="1420.0435">payload: &lt;transferMessage&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="463.5293" y="1435.1763">},</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.79" x="463.5293" y="1450.3091">metadata: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8091" x="480.0586" y="1465.4419">event: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6357" x="496.5879" y="1480.5747">id: &lt;uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.9961" x="496.5879" y="1495.7075">responseTo: &lt;previous.uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.0249" x="496.5879" y="1510.8403">type: transfer,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.8159" x="496.5879" y="1525.9731">action: prepare,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.3462" x="496.5879" y="1541.106">createdAt: &lt;timestamp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.7148" x="496.5879" y="1556.2388">state: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.4004" x="513.1172" y="1571.3716">status: &quot;success&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1343" x="513.1172" y="1586.5044">code: 0</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="496.5879" y="1601.6372">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="480.0586" y="1616.77">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="463.5293" y="1631.9028">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="447" y="1647.0356">}</text>
    <polygon fill="#181818" points="1192.4766,1677.2344,1202.4766,1681.2344,1192.4766,1685.2344,1196.4766,1681.2344" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1198.4766" y1="1681.2344" y2="1681.2344"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="1676.1685">20</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.2588" x="465.6748" y="1676.1685">Publish Notification event to Payee</text>
    <line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="329.0137" x2="1891.5225" y1="1720.2344" y2="1720.2344"/>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="287.6489" x="334.0137" y="1730.4448">[Calculate &amp; Validate Latest Position (failure)]</text>
    <path d="M339.0137,1741.0391 L660.5176,1741.0391 L660.5176,1748.1719 L650.5176,1758.1719 L339.0137,1758.1719 L339.0137,1741.0391 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="450.9922" style="stroke:#000000;stroke-width:1.5;" width="1526.4058" x="339.0137" y="1741.0391"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="276.5039" x="354.0137" y="1754.106">Calculate position and persist change</text>
    <polygon fill="#181818" points="1321.3804,1775.3047,1331.3804,1779.3047,1321.3804,1783.3047,1325.3804,1779.3047" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1327.3804" y1="1779.3047" y2="1779.3047"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="1774.2388">21</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.4038" x="465.6748" y="1774.2388">Request latest position from DB for Payer</text>
    <polygon fill="#181818" points="1775.3916,1804.4375,1785.3916,1808.4375,1775.3916,1812.4375,1779.3916,1808.4375" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1343.3804" x2="1781.3916" y1="1808.4375" y2="1808.4375"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1350.3804" y="1803.3716">22</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.7876" x="1372.4712" y="1803.3716">Retrieve latest position from DB for Payer</text>
    <polygon fill="#FFFFE0" points="1739,1821.4375,1845,1821.4375,1855,1832.4375,1845,1844.4375,1739,1844.4375,1729,1832.4375,1739,1821.4375" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4194" x="1741" y="1837.5044">transferPosition</text>
    <polygon fill="#181818" points="1354.3804,1866.7031,1344.3804,1870.7031,1354.3804,1874.7031,1350.3804,1870.7031" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1348.3804" x2="1791.3916" y1="1870.7031" y2="1870.7031"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1360.3804" y="1865.6372">23</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.7876" x="1382.4712" y="1865.6372">Retrieve latest position from DB for Payer</text>
    <polygon fill="#181818" points="447.584,1895.8359,437.584,1899.8359,447.584,1903.8359,443.584,1899.8359" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.584" x2="1337.3804" y1="1899.8359" y2="1899.8359"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="453.584" y="1894.77">24</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.2515" x="475.6748" y="1894.77">Return latest position</text>
    <polygon fill="#181818" points="1438.4976,1924.9688,1448.4976,1928.9688,1438.4976,1932.9688,1442.4976,1928.9688" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1444.4976" y1="1928.9688" y2="1928.9688"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="1923.9028">25</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.8032" x="465.6748" y="1923.9028">Request position limits for Payer Participant</text>
    <polygon fill="#181818" points="1775.3916,1954.1016,1785.3916,1958.1016,1775.3916,1962.1016,1779.3916,1958.1016" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1460.4976" x2="1781.3916" y1="1958.1016" y2="1958.1016"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1467.4976" y="1953.0356">26</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.8032" x="1489.5884" y="1953.0356">Request position limits for Payer Participant</text>
    <polygon fill="#FFFFE0" points="1738,1971.1016,1844,1971.1016,1854,1990.1016,1844,2009.1016,1738,2009.1016,1728,1990.1016,1738,1971.1016" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.5859" x="1740" y="1987.1685">participant</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.813" x="1740" y="2002.3013">participantLimit</text>
    <polygon fill="#181818" points="1471.4976,2031.5,1461.4976,2035.5,1471.4976,2039.5,1467.4976,2035.5" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1465.4976" x2="1791.3916" y1="2035.5" y2="2035.5"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1477.4976" y="2030.4341">27</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.0771" x="1499.5884" y="2030.4341">Return position limits</text>
    <polygon fill="#181818" points="447.584,2060.6328,437.584,2064.6328,447.584,2068.6328,443.584,2064.6328" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.584" x2="1454.4976" y1="2064.6328" y2="2064.6328"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="453.584" y="2059.5669">28</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.0771" x="475.6748" y="2059.5669">Return position limits</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="478.584" y1="2093.7656" y2="2093.7656"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="478.584" x2="478.584" y1="2093.7656" y2="2106.7656"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="437.584" x2="478.584" y1="2106.7656" y2="2106.7656"/>
    <polygon fill="#181818" points="446.584,2089.7656,436.584,2093.7656,446.584,2097.7656,442.584,2093.7656" style="stroke:#181818;stroke-width:1.0;"/>
    <polygon fill="#181818" points="447.584,2102.7656,437.584,2106.7656,447.584,2110.7656,443.584,2106.7656" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="2088.6997">29</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.1772" x="465.6748" y="2088.6997">Calculate latest position (lpos) for prepare</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="478.584" y1="2135.8984" y2="2135.8984"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="478.584" x2="478.584" y1="2135.8984" y2="2148.8984"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="437.584" x2="478.584" y1="2148.8984" y2="2148.8984"/>
    <polygon fill="#181818" points="446.584,2131.8984,436.584,2135.8984,446.584,2139.8984,442.584,2135.8984" style="stroke:#181818;stroke-width:1.0;"/>
    <polygon fill="#181818" points="447.584,2144.8984,437.584,2148.8984,447.584,2152.8984,443.584,2148.8984" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="2130.8325">30</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="590.9414" x="465.6748" y="2130.8325">Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos &lt; netcap</text>
    <path d="M441,2161.8984 L441,2186.8984 L577,2186.8984 L577,2171.8984 L567,2161.8984 L441,2161.8984 " fill="#FF0000" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M567,2161.8984 L567,2171.8984 L577,2171.8984 L567,2161.8984 " fill="#FF0000" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.8955" x="447" y="2178.9653">Validation failure!</text>
    <path d="M339.0137,2206.0313 L956.4834,2206.0313 L956.4834,2213.1641 L946.4834,2223.1641 L339.0137,2223.1641 L339.0137,2206.0313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="167.6641" style="stroke:#000000;stroke-width:1.5;" width="1542.5088" x="339.0137" y="2206.0313"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="572.4697" x="354.0137" y="2219.0981">Persist Transfer State (with transferState=&apos;ABORTED&apos; on position check pass)</text>
    <polygon fill="#181818" points="1321.3804,2240.2969,1331.3804,2244.2969,1321.3804,2248.2969,1325.3804,2244.2969" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1327.3804" y1="2244.2969" y2="2244.2969"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="2239.231">31</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.0273" x="465.6748" y="2239.231">Request to persist transfer</text>
    <polygon fill="#181818" points="1775.3916,2269.4297,1785.3916,2273.4297,1775.3916,2277.4297,1779.3916,2273.4297" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="1343.3804" x2="1781.3916" y1="2273.4297" y2="2273.4297"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1350.3804" y="2268.3638">32</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9731" x="1372.4712" y="2268.3638">Persist transfer state</text>
    <polygon fill="#FFFFE0" points="1722,2316.4297,1861,2316.4297,1871,2327.4297,1861,2339.4297,1722,2339.4297,1712,2327.4297,1722,2316.4297" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.5225" x="1724" y="2332.4966">transferStateChange</text>
    <polygon fill="#181818" points="447.584,2361.6953,437.584,2365.6953,447.584,2369.6953,443.584,2365.6953" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.584" x2="1337.3804" y1="2365.6953" y2="2365.6953"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="453.584" y="2360.6294">33</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9346" x="475.6748" y="2360.6294">Return success</text>
    <path d="M441,2385.6953 L441,2848.6953 L867,2848.6953 L867,2395.6953 L857,2385.6953 L441,2385.6953 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M857,2385.6953 L857,2395.6953 L867,2395.6953 L857,2385.6953 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.3564" x="447" y="2402.7622">Message:</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="447" y="2417.895">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.0356" x="463.5293" y="2433.0278">id: &lt;transferMessage.transferId&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.7773" x="463.5293" y="2448.1606">from: &lt;ledgerName&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.686" x="463.5293" y="2463.2935">to: &lt;transferMessage.payerFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.2197" x="463.5293" y="2478.4263">type: application/json</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.5552" x="463.5293" y="2493.5591">content: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.4482" x="480.0586" y="2508.6919">headers: &lt;transferHeaders&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.4785" x="480.0586" y="2523.8247">payload: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.208" x="496.5879" y="2538.9575">&quot;errorInformation&quot;: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.9541" x="513.1172" y="2554.0903">&quot;errorCode&quot;: 4001,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.0981" x="513.1172" y="2569.2231">&quot;errorDescription&quot;: &quot;Payer FSP insufficient liquidity&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="327.3613" x="513.1172" y="2584.356">&quot;extensionList&quot;: &lt;transferMessage.extensionList&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="480.0586" y="2599.4888">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="463.5293" y="2614.6216">},</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.79" x="463.5293" y="2629.7544">metadata: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8091" x="480.0586" y="2644.8872">event: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6357" x="496.5879" y="2660.02">id: &lt;uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.9961" x="496.5879" y="2675.1528">responseTo: &lt;previous.uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.791" x="496.5879" y="2690.2856">type: notification,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.8159" x="496.5879" y="2705.4185">action: prepare,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.3462" x="496.5879" y="2720.5513">createdAt: &lt;timestamp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.7148" x="496.5879" y="2735.6841">state: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7236" x="513.1172" y="2750.8169">status: &apos;error&apos;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.5132" x="513.1172" y="2765.9497">code: &lt;errorInformation.errorCode&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.2012" x="513.1172" y="2781.0825">description: &lt;errorInformation.errorDescription&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="496.5879" y="2796.2153">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="480.0586" y="2811.3481">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="463.5293" y="2826.481">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="447" y="2841.6138">}</text>
    <polygon fill="#181818" points="1192.4766,2871.8125,1202.4766,2875.8125,1192.4766,2879.8125,1196.4766,2875.8125" style="stroke:#181818;stroke-width:1.0;"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="436.584" x2="1198.4766" y1="2875.8125" y2="2875.8125"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="443.584" y="2870.7466">34</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.0542" x="465.6748" y="2870.7466">Publish Notification (failure) event for Payer</text>
  </g>
</svg>
