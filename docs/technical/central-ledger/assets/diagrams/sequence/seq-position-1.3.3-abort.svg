<svg xmlns="http://www.w3.org/2000/svg" height="4236" preserveAspectRatio="none" style="width:1684px;height:4236px" width="1684">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="345" x="667.5" y="28.708">
    1.3.3. Abort Position Handler Consume
  </text>
  <path fill="#FFFFE0" stroke="#a80036" d="M36 40.953h1408.5v4189.234H36z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="684.75" y="53.02">
    Central Service
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M94 132.383h10v4022.508H94zM803 1564.148h10v30h-10zM803 3012.25h10v30h-10zM803 4102.891h10v30h-10zM931.5 216.914h10v135.664h-10zM931.5 520.375h10v514.523h-10zM931.5 1669.547h10v120.531h-10zM931.5 1957.875h10v182.797h-10zM931.5 3117.648h10v120.531h-10zM931.5 3390.844h10v182.797h-10zM1387.5 246.047h10v77.398h-10zM1387.5 573.641h10v62.266h-10zM1387.5 707.172h10v30h-10zM1387.5 814.57h10v30h-10zM1387.5 1698.68h10v62.266h-10zM1387.5 2011.141h10v30h-10zM1387.5 3146.781h10v62.266h-10zM1387.5 3444.109h10v30h-10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M10 139.383h1660v4008.508H10z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M20 163.516h1640v1438.633H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M30 424.844h1620v618.055H30z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M878.5 535.375H1640v471.391H878.5zM20 1616.148h1498V3050.25H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M30 1862.344h1478v286.328H30z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M878.5 1972.875H1498v139.664H878.5zM99 2162.672h474v806.313H99z"/>
  <path fill="#FFF" d="M99 2566.992h474v401.992H99z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M20 3064.25h1498v1076.641H20z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M30 3295.313h1478v286.328H30z"/>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M878.5 3405.844H1498v139.664H878.5z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M99 122.383v4042.508M807.5 122.383v4042.508M936.5 122.383v4042.508M1392.5 122.383v4042.508"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="40" y="119.081">
    Position Handler
  </text>
  <circle cx="99" cy="90.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M95 78.086l6-5-2 5 2 5-6-5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="40" y="4176.886">
    Position Handler
  </text>
  <circle cx="99" cy="4196.188" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path fill="#A80036" stroke="#a80036" d="M95 4184.188l6-5-2 5 2 5-6-5z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M741.5 83.086h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M737.5 87.086h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="744.5" y="107.081">
    Notification-Topic
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M741.5 4163.891h133v30.297h-133z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M737.5 4167.891h133v30.297h-133z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="744.5" y="4187.886">
    Notification-Topic
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="888.5" y="119.081">
    Position DAO
  </text>
  <circle cx="936.5" cy="90.086" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M924.5 104.086h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="888.5" y="4176.886">
    Position DAO
  </text>
  <circle cx="936.5" cy="4196.188" fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="2" r="12"/>
  <path stroke="#a80036" stroke-width="2" d="M924.5 4210.188h24"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1344.5" y="119.081">
    Central Store
  </text>
  <path d="M1374.5 70.086c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10v-26" fill="#FEFECE" filter="url(#a)" stroke="#000" stroke-width="1.5"/>
  <path d="M1374.5 70.086c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#000" stroke-width="1.5"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1344.5" y="4176.886">
    Central Store
  </text>
  <path d="M1374.5 4190.188c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10v-26" fill="#FEFECE" filter="url(#a)" stroke="#000" stroke-width="1.5"/>
  <path d="M1374.5 4190.188c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#000" stroke-width="1.5"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M94 132.383h10v4022.508H94zM803 1564.148h10v30h-10zM803 3012.25h10v30h-10zM803 4102.891h10v30h-10zM931.5 216.914h10v135.664h-10zM931.5 520.375h10v514.523h-10zM931.5 1669.547h10v120.531h-10zM931.5 1957.875h10v182.797h-10zM931.5 3117.648h10v120.531h-10zM931.5 3390.844h10v182.797h-10zM1387.5 246.047h10v77.398h-10zM1387.5 573.641h10v62.266h-10zM1387.5 707.172h10v30h-10zM1387.5 814.57h10v30h-10zM1387.5 1698.68h10v62.266h-10zM1387.5 2011.141h10v30h-10zM1387.5 3146.781h10v62.266h-10zM1387.5 3444.109h10v30h-10z"/>
  <path d="M10 139.383h286v7l-10 10H10v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M10 139.383h1660v4008.508H10z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241" x="25" y="152.45">
    Abort Position Handler Consume
  </text>
  <path d="M20 163.516h70v7l-10 10H20v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M20 163.516h1640v1438.633H20z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="35" y="176.583">
    opt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="332" x="105" y="175.726">
    [type == &apos;position&apos; &amp;&amp; action == &apos;timeout-reserved&apos;]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M919.5 212.914l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 216.914h821.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="111" y="204.282">
    1
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="124" y="196.715">
    Request current state of transfer from DB
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="124" y="211.848">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="210" y="211.848">
    2003
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 242.047l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 246.047h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="948.5" y="240.981">
    2
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="961.5" y="240.981">
    Retrieve current state of transfer from DB
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1323 259.047h138l10 19-10 19h-138l-10-19 10-19z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1325" y="275.114">
    transferStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1325" y="290.247">
    transferParticipant
  </text>
  <path fill="#A80036" stroke="#a80036" d="M952.5 319.445l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M946.5 323.445h445"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="958.5" y="318.379">
    3
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="971.5" y="318.379">
    Return current state of transfer from DB
  </text>
  <path fill="#A80036" stroke="#a80036" d="M115 348.578l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M109 352.578h826.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="121" y="347.512">
    4
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="134" y="347.512">
    Return current state of transfer from DB
  </text>
  <path stroke="#a80036" d="M104 396.844h42M146 396.844v13M105 409.844h41"/>
  <path fill="#A80036" stroke="#a80036" d="M115 405.844l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="111" y="384.211">
    5
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="554" x="124" y="376.645">
    Validate current state (transferStateChange.transferStateId == &apos;RESERVED_TIMEOUT&apos;)
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="124" y="391.778">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="210" y="391.778">
    2001
  </text>
  <path d="M30 424.844h361v7l-10 10H30v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M30 424.844h1620v618.055H30z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="45" y="437.911">
    Persist Position change and Transfer state
  </text>
  <path stroke="#a80036" d="M104 463.109h42M146 463.109v13M105 476.109h41"/>
  <path fill="#A80036" stroke="#a80036" d="M115 472.11l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="111" y="458.043">
    6
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="124" y="458.043">
    transferStateId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="240" y="458.043">
    = &apos;EXPIRED_RESERVED&apos;
  </text>
  <path fill="#A80036" stroke="#a80036" d="M919.5 516.375l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 520.375h821.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="111" y="507.743">
    7
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="315" x="124" y="500.176">
    Request to persist latest position and state to DB
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="124" y="515.309">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="210" y="515.309">
    2003
  </text>
  <path d="M878.5 535.375h307v7l-10 10h-297v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M878.5 535.375H1640v471.391H878.5z"/>
  <text fill="#00F" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="262" x="893.5" y="548.442">
    DB TRANSACTION IMPLEMENTATION
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 569.64l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 573.641h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="948.5" y="568.575">
    8
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="414" x="961.5" y="568.575">
    Select participantPosition.value FOR UPDATE for payerCurrencyId
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1331 586.64h122l10 11-10 12h-122l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1333" y="602.707">
    participantPosition
  </text>
  <path fill="#A80036" stroke="#a80036" d="M952.5 631.906l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M946.5 635.906h445"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="958.5" y="630.84">
    9
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="971.5" y="630.84">
    Return participantPosition
  </text>
  <path stroke="#a80036" d="M941.5 665.039h42M983.5 665.039v13M942.5 678.039h41"/>
  <path fill="#A80036" stroke="#a80036" d="M952.5 674.04l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="948.5" y="659.973">
    10
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="970.5" y="659.973">
    latestPosition
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="1075.5" y="659.973">
    = participantPosition - payload.amount.amount
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 703.172l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 707.172h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="948.5" y="702.106">
    11
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="970.5" y="702.106">
    Persist latestPosition to DB for Payer
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1292 750.172h200l10 19-10 19h-200l-10-19 10-19z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="1294" y="766.239">
    UPDATE
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="1350" y="766.239">
    participantPosition
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1294" y="781.372">
    SET value = latestPosition
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 810.57l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 814.57h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="948.5" y="809.504">
    12
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="336" x="970.5" y="809.504">
    Persist participant position change and state change
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1165 857.57h455l10 72-10 72h-455l-10-72 10-72z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="1167" y="873.637">
    INSERT
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="1216" y="873.637">
    transferStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1167" y="888.77">
    VALUES (transferStateId)
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="1167" y="919.036">
    INSERT
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="1216" y="919.036">
    participantPositionChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="431" x="1167" y="934.168">
    SET participantPositionId = participantPosition.participantPositionId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="451" x="1167" y="949.301">
    transferStateChangeId = transferStateChange.transferStateChangeId,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="1167" y="964.434">
    value = latestPosition,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="1167" y="979.567">
    reservedValue = participantPosition.reservedValue
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="1167" y="994.7">
    createdDate = new Date()
  </text>
  <path fill="#A80036" stroke="#a80036" d="M115 1030.898l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M109 1034.898h826.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="121" y="1029.832">
    13
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="143" y="1029.832">
    Return success
  </text>
  <path d="M109 1054.898v463h408v-453l-10-10H109" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M507 1054.898v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="115" y="1071.965">
    Message: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="131" y="1087.098">
    id: &lt;transferMessage.transferId&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="131" y="1102.231">
    from: &lt;transferMessage.payerFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="131" y="1117.364">
    to: &lt;transferMessage.payeeFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="131" y="1132.497">
    type: application/json
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="131" y="1147.629">
    content: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="147" y="1162.762">
    headers: &lt;transferHeaders&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="147" y="1177.895">
    payload: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="167" y="1193.028">
    &quot;errorInformation&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="183" y="1208.161">
    &quot;errorCode&quot;: 3300,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="183" y="1223.293">
    &quot;errorDescription&quot;: &quot;Transfer expired&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="319" x="183" y="1238.426">
    &quot;extensionList&quot;: &lt;transferMessage.extensionList&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="167" y="1253.559">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="147" y="1268.692">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="131" y="1283.825">
    },
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="131" y="1298.957">
    metadata: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="147" y="1314.09">
    event: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="163" y="1329.223">
    id: &lt;uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="163" y="1344.356">
    responseTo: &lt;previous.uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="163" y="1359.489">
    type: notification,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="163" y="1374.622">
    action: abort,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="163" y="1389.754">
    createdAt: &lt;timestamp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="163" y="1404.887">
    state: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="179" y="1420.02">
    status: &apos;error&apos;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="179" y="1435.153">
    code: &lt;errorInformation.errorCode&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="311" x="179" y="1450.286">
    description: &lt;errorInformation.errorDescription&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="163" y="1465.418">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="147" y="1480.551">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="131" y="1495.684">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="115" y="1510.817">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M791 1560.148l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 1564.148h693"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="1551.516">
    14
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="133" y="1543.95">
    Publish Notification event
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="1559.082">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="1559.082">
    2003
  </text>
  <path d="M20 1616.148h70v7l-10 10H20v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M20 1616.148h1498V3050.25H20z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="35" y="1629.215">
    opt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="322" x="105" y="1628.359">
    [type == &apos;position&apos; &amp;&amp; (action IN [&apos;reject&apos;, &apos;abort&apos;])]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M919.5 1665.547l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 1669.547h821.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="1656.915">
    15
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="133" y="1649.348">
    Request current state of transfer from DB
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="1664.481">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="1664.481">
    2003
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 1694.68l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 1698.68h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="948.5" y="1693.614">
    16
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="970.5" y="1693.614">
    Retrieve current state of transfer from DB
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1323 1711.68h138l10 11-10 12h-138l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1325" y="1727.747">
    transferStateChange
  </text>
  <path fill="#A80036" stroke="#a80036" d="M952.5 1756.945l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M946.5 1760.945h445"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="958.5" y="1755.879">
    17
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="980.5" y="1755.879">
    Return current state of transfer from DB
  </text>
  <path fill="#A80036" stroke="#a80036" d="M115 1786.078l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M109 1790.078h826.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="121" y="1785.012">
    18
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="143" y="1785.012">
    Return current state of transfer from DB
  </text>
  <path stroke="#a80036" d="M104 1834.344h42M146 1834.344v13M105 1847.344h41"/>
  <path fill="#A80036" stroke="#a80036" d="M115 1843.344l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="1821.711">
    19
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="663" x="133" y="1814.145">
    Validate current state (transferStateChange.transferStateId IN [&apos;RECEIVED_REJECT&apos;, &apos;RECEIVED_ERROR&apos;])
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="1829.278">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="1829.278">
    2001
  </text>
  <path d="M30 1862.344h361v7l-10 10H30v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M30 1862.344h1478v286.328H30z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="45" y="1875.411">
    Persist Position change and Transfer state
  </text>
  <path stroke="#a80036" d="M104 1900.609h42M146 1900.609v13M105 1913.609h41"/>
  <path fill="#A80036" stroke="#a80036" d="M115 1909.61l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="1895.543">
    20
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="133" y="1895.543">
    transferStateId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="418" x="249" y="1895.543">
    = (action == &apos;reject&apos; ? &apos;ABORTED_REJECTED&apos; : &apos;ABORTED_ERROR&apos; )
  </text>
  <path fill="#A80036" stroke="#a80036" d="M919.5 1953.875l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 1957.875h821.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="1945.243">
    21
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="315" x="133" y="1937.676">
    Request to persist latest position and state to DB
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="1952.809">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="1952.809">
    2003
  </text>
  <path d="M878.5 1972.875h422v7l-10 10h-412v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M878.5 1972.875H1498v139.664H878.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="893.5" y="1985.942">
    Refer to
  </text>
  <text fill="#00F" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="262" x="958.5" y="1985.942">
    DB TRANSACTION IMPLEMENTATION
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="1225.5" y="1985.942">
    above
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 2007.14l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 2011.141h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="948.5" y="2006.075">
    22
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="970.5" y="2006.075">
    Persist to database
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1307 2054.14h171l10 26-10 27h-171l-10-27 10-26z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1309" y="2070.207">
    participantPosition
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1309" y="2085.34">
    transferStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1309" y="2100.473">
    participantPositionChange
  </text>
  <path fill="#A80036" stroke="#a80036" d="M115 2136.672l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M109 2140.672h826.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="121" y="2135.606">
    23
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="143" y="2135.606">
    Return success
  </text>
  <path d="M99 2162.672h64v7l-10 10H99v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M99 2162.672h474v806.313H99z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="114" y="2175.739">
    alt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="178" y="2174.882">
    [action == &apos;reject&apos;]
  </text>
  <path d="M109 2184.805v373h282v-363l-10-10H109" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M381 2184.805v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="115" y="2201.872">
    Message: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="131" y="2217.004">
    id: &lt;transferMessage.transferId&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="131" y="2232.137">
    from: &lt;transferMessage.payerFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="131" y="2247.27">
    to: &lt;transferMessage.payeeFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="131" y="2262.403">
    type: application/json
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="131" y="2277.536">
    content: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="147" y="2292.669">
    headers: &lt;transferHeaders&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="147" y="2307.801">
    payload: &lt;transferMessage&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="131" y="2322.934">
    },
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="131" y="2338.067">
    metadata: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="147" y="2353.2">
    event: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="163" y="2368.332">
    id: &lt;uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="163" y="2383.465">
    responseTo: &lt;previous.uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="163" y="2398.598">
    type: notification,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="163" y="2413.731">
    action: reject,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="163" y="2428.864">
    createdAt: &lt;timestamp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="163" y="2443.997">
    state: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="179" y="2459.129">
    status: &quot;success&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="179" y="2474.262">
    code: 0,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="179" y="2489.395">
    description: &quot;action successful&quot;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="163" y="2504.528">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="147" y="2519.661">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="131" y="2534.794">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="115" y="2549.926">
    }
  </text>
  <path stroke="#000" stroke-dasharray="2,2" d="M99 2567.992h474"/>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="104" y="2578.203">
    [action == &apos;abort&apos;]
  </text>
  <path d="M109 2586.797v373h450v-363l-10-10H109" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M549 2586.797v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="115" y="2603.864">
    Message: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="131" y="2618.997">
    id: &lt;transferMessage.transferId&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="131" y="2634.129">
    from: &lt;transferMessage.payerFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="131" y="2649.262">
    to: &lt;transferMessage.payeeFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="131" y="2664.395">
    type: application/json
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="131" y="2679.528">
    content: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="147" y="2694.661">
    headers: &lt;transferHeaders&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="147" y="2709.794">
    payload: &lt;transferMessage&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="131" y="2724.926">
    },
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="131" y="2740.059">
    metadata: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="147" y="2755.192">
    event: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="163" y="2770.325">
    id: &lt;uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="163" y="2785.457">
    responseTo: &lt;previous.uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="163" y="2800.59">
    type: notification,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="163" y="2815.723">
    action: abort,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="163" y="2830.856">
    createdAt: &lt;timestamp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="163" y="2845.989">
    state: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="179" y="2861.122">
    status: &apos;error&apos;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="335" x="179" y="2876.254">
    code: &lt;payload.errorInformation.errorCode || 5000&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="365" x="179" y="2891.387">
    description: &lt;payload.errorInformation.errorDescription&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="163" y="2906.52">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="147" y="2921.653">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="131" y="2936.786">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="115" y="2951.919">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M791 3008.25l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 3012.25h693"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="2999.618">
    24
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="133" y="2992.051">
    Publish Notification event
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="3007.184">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="3007.184">
    2003
  </text>
  <path d="M20 3064.25h70v7l-10 10H20v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M20 3064.25h1498v1076.641H20z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="35" y="3077.317">
    opt
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="514" x="105" y="3076.46">
    [type == &apos;position&apos; &amp;&amp; action == &apos;fail&apos; (Unable to currently trigger this scenario)]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M919.5 3113.648l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 3117.648h821.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="3105.016">
    25
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="133" y="3097.45">
    Request current state of transfer from DB
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="3112.582">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="3112.582">
    2003
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 3142.781l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 3146.781h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="948.5" y="3141.715">
    26
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="970.5" y="3141.715">
    Retrieve current state of transfer from DB
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1323 3159.781h138l10 11-10 12h-138l-10-12 10-11z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1325" y="3175.848">
    transferStateChange
  </text>
  <path fill="#A80036" stroke="#a80036" d="M952.5 3205.047l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M946.5 3209.047h445"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="958.5" y="3203.981">
    27
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="980.5" y="3203.981">
    Return current state of transfer from DB
  </text>
  <path fill="#A80036" stroke="#a80036" d="M115 3234.18l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M109 3238.18h826.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="121" y="3233.114">
    28
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="143" y="3233.114">
    Return current state of transfer from DB
  </text>
  <path stroke="#a80036" d="M104 3267.313h42M146 3267.313v13M105 3280.313h41"/>
  <path fill="#A80036" stroke="#a80036" d="M115 3276.313l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="3262.247">
    29
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="467" x="133" y="3262.247">
    Validate current state (transferStateChange.transferStateId == &apos;FAILED&apos;)
  </text>
  <path d="M30 3295.313h361v7l-10 10H30v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M30 3295.313h1478v286.328H30z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="45" y="3308.379">
    Persist Position change and Transfer state
  </text>
  <path stroke="#a80036" d="M104 3333.578h42M146 3333.578v13M105 3346.578h41"/>
  <path fill="#A80036" stroke="#a80036" d="M115 3342.578l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="3328.512">
    30
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="133" y="3328.512">
    transferStateId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="249" y="3328.512">
    = &apos;FAILED&apos;
  </text>
  <path fill="#A80036" stroke="#a80036" d="M919.5 3386.844l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 3390.844h821.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="3378.211">
    31
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="315" x="133" y="3370.645">
    Request to persist latest position and state to DB
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="3385.778">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="3385.778">
    2003
  </text>
  <path d="M878.5 3405.844h422v7l-10 10h-412v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M878.5 3405.844H1498v139.664H878.5z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="893.5" y="3418.911">
    Refer to
  </text>
  <text fill="#00F" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="262" x="958.5" y="3418.911">
    DB TRANSACTION IMPLEMENTATION
  </text>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="1225.5" y="3418.911">
    above
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1375.5 3440.11l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M941.5 3444.109h440"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="948.5" y="3439.044">
    32
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="970.5" y="3439.044">
    Persist to database
  </text>
  <path fill="#FFFFE0" filter="url(#a)" stroke="#a80036" d="M1307 3487.11h171l10 26-10 27h-171l-10-27 10-26z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1309" y="3503.176">
    participantPosition
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1309" y="3518.309">
    transferStateChange
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1309" y="3533.442">
    participantPositionChange
  </text>
  <path fill="#A80036" stroke="#a80036" d="M115 3569.64l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M109 3573.641h826.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="121" y="3568.575">
    33
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="143" y="3568.575">
    Return success
  </text>
  <path d="M109 3593.64v463h408v-453l-10-10H109" fill="#FF0" filter="url(#a)" stroke="#a80036"/>
  <path d="M507 3593.64v10h10l-10-10" fill="#FF0" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="115" y="3610.707">
    Message: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="131" y="3625.84">
    id: &lt;transferMessage.transferId&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="131" y="3640.973">
    from: &lt;transferMessage.payerFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="131" y="3656.106">
    to: &lt;transferMessage.payeeFsp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="131" y="3671.239">
    type: application/json
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="131" y="3686.372">
    content: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="147" y="3701.504">
    headers: &lt;transferHeaders&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="147" y="3716.637">
    payload: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="167" y="3731.77">
    &quot;errorInformation&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="183" y="3746.903">
    &quot;errorCode&quot;: 3100,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="183" y="3762.036">
    &quot;errorDescription&quot;: &quot;Transfer failed&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="319" x="183" y="3777.169">
    &quot;extensionList&quot;: &lt;transferMessage.extensionList&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="167" y="3792.301">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="151" y="3807.434">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="131" y="3822.567">
    },
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="131" y="3837.7">
    metadata: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="147" y="3852.832">
    event: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="163" y="3867.965">
    id: &lt;uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="163" y="3883.098">
    responseTo: &lt;previous.uuid&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="163" y="3898.231">
    type: notification,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="163" y="3913.364">
    action: abort,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="163" y="3928.497">
    createdAt: &lt;timestamp&gt;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="163" y="3943.629">
    state: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="179" y="3958.762">
    status: &apos;error&apos;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="179" y="3973.895">
    code: &lt;errorInformation.errorCode&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="311" x="179" y="3989.028">
    description: &lt;errorInformation.errorDescription&gt;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="163" y="4004.161">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="147" y="4019.294">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="131" y="4034.426">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="115" y="4049.559">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M791 4098.89l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M104 4102.891h693"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="111" y="4090.258">
    34
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="133" y="4082.692">
    Publish Notification event
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="133" y="4097.825">
    Error code:
  </text>
  <text fill="red" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="219" y="4097.825">
    2003
  </text>
</svg>
