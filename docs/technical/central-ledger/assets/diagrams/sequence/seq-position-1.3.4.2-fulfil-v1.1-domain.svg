<?xml version="1.0" encoding="us-ascii" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1227px" preserveAspectRatio="none" style="width:761px;height:1227px;background:#FFFFFF;" version="1.1" viewBox="0 0 761 1227" width="761px" zoomAndPan="magnify">
  <defs/>
  <g>
    <text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="272" x="246" y="27.9951">1.3.4.2. Position Fulfil Domain v1.1</text>
    <rect fill="#FFFFFF" height="1067.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="101" y="100.5938"/>
    <rect fill="none" height="1020.5078" style="stroke:#000000;stroke-width:1.5;" width="745" x="10" y="140.7266"/>
    <rect fill="none" height="781.1797" style="stroke:#000000;stroke-width:1.5;" width="725" x="20" y="222.125"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="106" x2="106" y1="90.5938" y2="1178.2344"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="30" y="87.292">Position Fulfil Domain</text>
    <ellipse cx="106" cy="58.2969" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="102,46.2969,108,41.2969,106,46.2969,108,51.2969,102,46.2969" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="30" y="1190.2295">Position Fulfil Domain</text>
    <ellipse cx="106" cy="1209.5313" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="102,1197.5313,108,1192.5313,106,1197.5313,108,1202.5313,102,1197.5313" style="stroke:#181818;stroke-width:1.0;"/>
    <rect fill="#FFFFFF" height="1067.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="101" y="100.5938"/>
    <rect fill="#ADD8E6" height="23" style="stroke:#181818;stroke-width:0.5;" width="363" x="116" y="105.5938"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355" x="120" y="121.6606">INPUT: bin, accumulatedPosition, transferStateChanges</text>
    <path d="M10,140.7266 L288,140.7266 L288,147.8594 L278,157.8594 L10,157.8594 L10,140.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="1020.5078" style="stroke:#000000;stroke-width:1.5;" width="745" x="10" y="140.7266"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="233" x="25" y="153.7935">Fulfil Position Batch Processing</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="111" x2="153" y1="194.125" y2="194.125"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="153" x2="153" y1="194.125" y2="207.125"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="207.125" y2="207.125"/>
    <polygon fill="#181818" points="122,203.125,112,207.125,122,211.125,118,207.125" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="118" y="181.4927">1</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="131" y="173.9263">runningPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="250" y="173.9263">= accumulatedPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397" x="131" y="189.0591">(runningPosition is the current accumulated position of payee)</text>
    <path d="M20,222.125 L97,222.125 L97,229.2578 L87,239.2578 L20,239.2578 L20,222.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="781.1797" style="stroke:#000000;stroke-width:1.5;" width="725" x="20" y="222.125"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="35" y="235.1919">loop</text>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="189" x="112" y="234.3354">[for each message in the bin]</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="111" x2="153" y1="290.6563" y2="290.6563"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="153" x2="153" y1="290.6563" y2="303.6563"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="303.6563" y2="303.6563"/>
    <polygon fill="#181818" points="122,299.6563,112,303.6563,122,307.6563,118,303.6563" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="118" y="270.4575">2</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371" x="131" y="255.3247">Validate current state (transferState is &apos;RECEIVED-FULFIL&apos;)</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82" x="131" y="270.4575">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="217" y="270.4575">2001</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="253" y="270.4575">against failing transfers</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="131" y="285.5903">Batch is not rejected as a whole</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="111" x2="153" y1="332.7891" y2="332.7891"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="153" x2="153" y1="332.7891" y2="345.7891"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="345.7891" y2="345.7891"/>
    <polygon fill="#181818" points="122,341.7891,112,345.7891,122,349.7891,118,345.7891" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="118" y="327.7231">3</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="131" y="327.7231">runningPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="250" y="327.7231">= runningPosition + payload.amount.amount</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="111" x2="153" y1="374.9219" y2="374.9219"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="153" x2="153" y1="374.9219" y2="387.9219"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="387.9219" y2="387.9219"/>
    <polygon fill="#181818" points="122,383.9219,112,387.9219,122,391.9219,118,387.9219" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="118" y="369.856">4</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341" x="131" y="369.856">transferStateChange should be populated and add to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="476" y="369.856">transferStateChanges</text>
    <polygon fill="#FFFFE0" points="126,400.9219,348,400.9219,358,426.9219,348,453.9219,126,453.9219,116,426.9219,126,400.9219" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="128" y="416.9888">transferStateChange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="282" y="416.9888">: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="128" y="432.1216">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="144" y="432.1216">transferStateId</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="256" y="432.1216">: &apos;COMMITTED&apos;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="128" y="447.2544">}</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="111" x2="153" y1="480.4531" y2="480.4531"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="153" x2="153" y1="480.4531" y2="493.4531"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="493.4531" y2="493.4531"/>
    <polygon fill="#181818" points="122,489.4531,112,493.4531,122,497.4531,118,493.4531" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="118" y="475.3872">5</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374" x="131" y="475.3872">participantPositionChange should be populated and add to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204" x="509" y="475.3872">participantPositionChanges</text>
    <polygon fill="#FFFFE0" points="126,506.4531,725,506.4531,735,547.4531,725,589.4531,126,589.4531,116,547.4531,126,506.4531" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196" x="128" y="522.52">participantPositionChange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="324" y="522.52">: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="579" x="144" y="537.6528">transferStateChangeId: null, // Need to update this in bin processor while executing queries</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="144" y="552.7856">value = runningPosition,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325" x="144" y="567.9185">reservedValue = participantPosition.reservedValue</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="128" y="583.0513">}</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="111" x2="153" y1="616.25" y2="616.25"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="153" x2="153" y1="616.25" y2="629.25"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="629.25" y2="629.25"/>
    <polygon fill="#181818" points="122,625.25,112,629.25,122,633.25,118,629.25" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="118" y="611.1841">6</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="131" y="611.1841">resultMessage should be populated and add to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116" x="435" y="611.1841">resultMessages</text>
    <rect fill="#FFFF00" height="356" style="stroke:#181818;stroke-width:0.5;" width="257" x="116" y="642.25"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108" x="120" y="658.3169">resultMessage</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="228" y="658.3169">:</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="120" y="673.4497">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="136" y="688.5825">id: &lt;transferMessage.transferId&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="136" y="703.7153">from: &lt;transferMessage.payerFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="136" y="718.8481">to: &lt;transferMessage.payeeFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="136" y="733.981">type: application/json</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="136" y="749.1138">content: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="152" y="764.2466">headers: &lt;transferHeaders&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="152" y="779.3794">payload: &lt;transferMessage&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="136" y="794.5122">},</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="136" y="809.645">metadata: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="152" y="824.7778">event: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="168" y="839.9106">id: &lt;uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="168" y="855.0435">responseTo: &lt;previous.uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="168" y="870.1763">type: transfer,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="168" y="885.3091">action: commit || reserve,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="168" y="900.4419">createdAt: &lt;timestamp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="168" y="915.5747">state: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="184" y="930.7075">status: &quot;success&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="184" y="945.8403">code: 0</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="168" y="960.9731">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="152" y="976.106">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="136" y="991.2388">}</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="111" x2="153" y1="1031.4375" y2="1031.4375"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="153" x2="153" y1="1031.4375" y2="1044.4375"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="1044.4375" y2="1044.4375"/>
    <polygon fill="#181818" points="122,1040.4375,112,1044.4375,122,1048.4375,118,1044.4375" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="118" y="1026.3716">7</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="131" y="1026.3716">Return the following</text>
    <rect fill="#ADD8E6" height="98" style="stroke:#181818;stroke-width:0.5;" width="473" x="116" y="1057.4375"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="120" y="1073.5044">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="120" y="1088.6372">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="136" y="1088.6372">accumulatedPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="290" y="1088.6372">: runningPosition,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="120" y="1103.77">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="136" y="1103.77">transferStateChanges</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="298" y="1103.77">,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="120" y="1118.9028">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204" x="136" y="1118.9028">participantPositionChanges</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="340" y="1118.9028">,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="120" y="1134.0356">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116" x="136" y="1134.0356">resultMessages</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="252" y="1134.0356">, (The list of messages to be sent to the kafka topic)</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="120" y="1149.1685">}</text>
  </g>
</svg>
