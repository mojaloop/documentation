<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1913px" preserveAspectRatio="none" style="width:1937px;height:1913px;background:#FFFFFF;" version="1.1" viewBox="0 0 1937 1913" width="1937px" zoomAndPan="magnify"><defs/><g><rect fill="#D3D3D3" height="1901.2344" style="stroke:#181818;stroke-width:0.5;" width="390.5" x="805.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="182" x="909.75" y="28.8379">Payment Manager</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="123" x="909.75" y="56.5098">Payer DFSP</text><rect fill="#FFFFFF" height="640.0781" style="stroke:#181818;stroke-width:1.0;" width="10" x="1073.5" y="304.375"/><rect fill="#FFFFFF" height="400.0469" style="stroke:#181818;stroke-width:1.0;" width="10" x="1073.5" y="1178.8125"/><rect height="181.3594" style="stroke:#000000;stroke-width:1.5;fill:none;" width="455" x="10" y="1635.5313"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="130" x2="130" y1="135.6875" y2="1833.8906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="866.5" x2="866.5" y1="135.6875" y2="1833.8906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1078" x2="1078" y1="135.6875" y2="1833.8906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1448.5" x2="1448.5" y1="135.6875" y2="1833.8906"/><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221" x="20" y="93.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="207" x="27" y="122.8535">Core banking solution</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221" x="20" y="1832.8906"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="207" x="27" y="1862.7285">Core banking solution</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="809.5" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="842.5" y="95.1816">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="816.5" y="122.8535">Connector</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="809.5" y="1832.8906"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="842.5" y="1862.7285">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="816.5" y="1890.4004">Connector</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="965" y="93.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="213" x="972" y="122.8535">SDK Scheme Adapter</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="965" y="1832.8906"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="213" x="972" y="1862.7285">SDK Scheme Adapter</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="1396.5" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1403.5" y="95.1816">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="1417" y="122.8535">Switch</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="1396.5" y="1832.8906"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1403.5" y="1862.7285">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="1417" y="1890.4004">Switch</text><rect fill="#FFFFFF" height="640.0781" style="stroke:#181818;stroke-width:1.0;" width="10" x="1073.5" y="304.375"/><rect fill="#FFFFFF" height="400.0469" style="stroke:#181818;stroke-width:1.0;" width="10" x="1073.5" y="1178.8125"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1930.5" x="0" y="172.5234"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1930.5" y1="172.5234" y2="172.5234"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1930.5" y1="175.5234" y2="175.5234"/><rect fill="#EEEEEE" height="35.6719" style="stroke:#000000;stroke-width:2.0;" width="684" x="623.25" y="155.6875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="664" x="629.25" y="182.5254">Payer DFSP integration - 2 phase commit - with user confirmation</text><polygon fill="#181818" points="854.5,258.7031,864.5,262.7031,854.5,266.7031,858.5,262.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="860.5" y1="262.7031" y2="262.7031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="137.5" y="242.0332">[1]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="167.5" y="228.1973">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="118" x="235.5" y="228.1973">/sendMoney</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="621" x="167.5" y="255.8691">(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES =</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="48" x="794.5" y="255.8691">false</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="842.5" y="255.8691">)</text><polygon fill="#181818" points="1061.5,300.375,1071.5,304.375,1061.5,308.375,1065.5,304.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="866.5" x2="1067.5" y1="304.375" y2="304.375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="873.5" y="297.541">[2]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="903.5" y="297.541">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="971.5" y="297.541">/transfers</text><polygon fill="#181818" points="1436.5,342.0469,1446.5,346.0469,1436.5,350.0469,1440.5,346.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1083.5" x2="1442.5" y1="346.0469" y2="346.0469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1090.5" y="339.2129">[3]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="1120.5" y="339.2129">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="258" x="1173.5" y="339.2129">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#181818" points="1094.5,383.7188,1084.5,387.7188,1094.5,391.7188,1090.5,387.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1088.5" x2="1447.5" y1="387.7188" y2="387.7188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1100.5" y="380.8848">[4]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="196" x="1130.5" y="380.8848">HTTP 202 response</text><line style="stroke:#181818;stroke-width:1.0;" x1="1448.5" x2="1490.5" y1="429.3906" y2="429.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1490.5" x2="1490.5" y1="429.3906" y2="442.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1449.5" x2="1490.5" y1="442.3906" y2="442.3906"/><polygon fill="#181818" points="1459.5,438.3906,1449.5,442.3906,1459.5,446.3906,1455.5,442.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1455.5" y="422.5566">[5]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="353" x="1485.5" y="422.5566">Determine Payee DFSP using oracle</text><line style="stroke:#181818;stroke-width:1.0;" x1="1448.5" x2="1490.5" y1="511.7344" y2="511.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1490.5" x2="1490.5" y1="511.7344" y2="524.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1449.5" x2="1490.5" y1="524.7344" y2="524.7344"/><polygon fill="#181818" points="1459.5,520.7344,1449.5,524.7344,1459.5,528.7344,1455.5,524.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1455.5" y="491.0645">[6]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="438" x="1485.5" y="477.2285">Lookup Payee Information from Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="50" x="1491.5" y="504.9004">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="1547.5" y="504.9004">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="71" x="1600.5" y="504.9004">/parties</text><polygon fill="#181818" points="1094.5,562.4063,1084.5,566.4063,1094.5,570.4063,1090.5,566.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1088.5" x2="1447.5" y1="566.4063" y2="566.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1100.5" y="559.5723">[7]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1130.5" y="559.5723">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="258" x="1182.5" y="559.5723">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#181818" points="1436.5,604.0781,1446.5,608.0781,1436.5,612.0781,1440.5,608.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1083.5" x2="1442.5" y1="608.0781" y2="608.0781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1090.5" y="601.2441">[8]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="1120.5" y="601.2441">HTTP 200 Response</text><rect fill="#FAFAFA" height="35" style="stroke:#181818;stroke-width:0.5;" width="132" x="936" y="621.0781"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="124" x="940" y="647.916">Accept Party</text><polygon fill="#181818" points="1436.5,691.4219,1446.5,695.4219,1436.5,699.4219,1440.5,695.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1083.5" x2="1442.5" y1="695.4219" y2="695.4219"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1090.5" y="688.5879">[9]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1120.5" y="688.5879">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="71" x="1188.5" y="688.5879">/quotes</text><polygon fill="#181818" points="1094.5,733.0938,1084.5,737.0938,1094.5,741.0938,1090.5,737.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1088.5" x2="1447.5" y1="737.0938" y2="737.0938"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1100.5" y="730.2598">[10]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="196" x="1142.5" y="730.2598">HTTP 202 response</text><line style="stroke:#181818;stroke-width:1.0;" x1="1448.5" x2="1490.5" y1="806.4375" y2="806.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="1490.5" x2="1490.5" y1="806.4375" y2="819.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="1449.5" x2="1490.5" y1="819.4375" y2="819.4375"/><polygon fill="#181818" points="1459.5,815.4375,1449.5,819.4375,1459.5,823.4375,1455.5,819.4375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1455.5" y="785.7676">[11]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="297" x="1497.5" y="771.9316">Pass on quote to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="50" x="1503.5" y="799.6035">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1559.5" y="799.6035">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="71" x="1627.5" y="799.6035">/quotes</text><polygon fill="#181818" points="1094.5,857.1094,1084.5,861.1094,1094.5,865.1094,1090.5,861.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1088.5" x2="1447.5" y1="861.1094" y2="861.1094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1100.5" y="854.2754">[12]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1142.5" y="854.2754">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="109" x="1194.5" y="854.2754">/quotes/{Id}</text><polygon fill="#181818" points="1436.5,898.7813,1446.5,902.7813,1436.5,906.7813,1440.5,902.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1083.5" x2="1442.5" y1="902.7813" y2="902.7813"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1090.5" y="895.9473">[13]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="1132.5" y="895.9473">HTTP 200 Response</text><polygon fill="#181818" points="877.5,940.4531,867.5,944.4531,877.5,948.4531,873.5,944.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="871.5" x2="1077.5" y1="944.4531" y2="944.4531"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="883.5" y="937.6191">[14]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="98" x="925.5" y="937.6191">Response</text><polygon fill="#181818" points="141.5,982.125,131.5,986.125,141.5,990.125,137.5,986.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="135.5" x2="865.5" y1="986.125" y2="986.125"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="147.5" y="979.291">[15]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="98" x="189.5" y="979.291">Response</text><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="172.5" y1="1027.7969" y2="1027.7969"/><line style="stroke:#181818;stroke-width:1.0;" x1="172.5" x2="172.5" y1="1027.7969" y2="1040.7969"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="172.5" y1="1040.7969" y2="1040.7969"/><polygon fill="#181818" points="141.5,1036.7969,131.5,1040.7969,141.5,1044.7969,137.5,1040.7969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="137.5" y="1020.9629">[16]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="494" x="179.5" y="1020.9629">Obtain concent from Payer on Fees and Payee Info</text><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="172.5" y1="1082.4688" y2="1082.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="172.5" x2="172.5" y1="1082.4688" y2="1095.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="172.5" y1="1095.4688" y2="1095.4688"/><polygon fill="#181818" points="141.5,1091.4688,131.5,1095.4688,141.5,1099.4688,137.5,1095.4688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="137.5" y="1075.6348">[17]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="139" x="179.5" y="1075.6348">Reserve funds</text><polygon fill="#181818" points="854.5,1133.1406,864.5,1137.1406,854.5,1141.1406,858.5,1137.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="860.5" y1="1137.1406" y2="1137.1406"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="137.5" y="1130.3066">[18]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="179.5" y="1130.3066">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="228" x="231.5" y="1130.3066">/sendmoney/{transferId}</text><polygon fill="#181818" points="1061.5,1174.8125,1071.5,1178.8125,1061.5,1182.8125,1065.5,1178.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="866.5" x2="1067.5" y1="1178.8125" y2="1178.8125"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="873.5" y="1171.9785">[19]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="915.5" y="1171.9785">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="967.5" y="1171.9785">/transfers</text><polygon fill="#181818" points="1436.5,1216.4844,1446.5,1220.4844,1436.5,1224.4844,1440.5,1220.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1083.5" x2="1442.5" y1="1220.4844" y2="1220.4844"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1090.5" y="1213.6504">[20]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1132.5" y="1213.6504">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1200.5" y="1213.6504">/transfers</text><polygon fill="#181818" points="1094.5,1258.1563,1084.5,1262.1563,1094.5,1266.1563,1090.5,1262.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1088.5" x2="1447.5" y1="1262.1563" y2="1262.1563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1100.5" y="1255.3223">[21]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="196" x="1142.5" y="1255.3223">HTTP 202 response</text><line style="stroke:#181818;stroke-width:1.0;" x1="1448.5" x2="1490.5" y1="1303.8281" y2="1303.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1490.5" x2="1490.5" y1="1303.8281" y2="1316.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1449.5" x2="1490.5" y1="1316.8281" y2="1316.8281"/><polygon fill="#181818" points="1459.5,1312.8281,1449.5,1316.8281,1459.5,1320.8281,1455.5,1316.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1455.5" y="1296.9941">[22]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="267" x="1497.5" y="1296.9941">Reserve Payer DFSP funds</text><line style="stroke:#181818;stroke-width:1.0;" x1="1448.5" x2="1490.5" y1="1386.1719" y2="1386.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="1490.5" x2="1490.5" y1="1386.1719" y2="1399.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="1449.5" x2="1490.5" y1="1399.1719" y2="1399.1719"/><polygon fill="#181818" points="1459.5,1395.1719,1449.5,1399.1719,1459.5,1403.1719,1455.5,1399.1719" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1455.5" y="1365.502">[23]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="316" x="1497.5" y="1351.666">Pass on transfer to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="50" x="1503.5" y="1379.3379">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1559.5" y="1379.3379">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1627.5" y="1379.3379">/transfers</text><line style="stroke:#181818;stroke-width:1.0;" x1="1448.5" x2="1490.5" y1="1440.8438" y2="1440.8438"/><line style="stroke:#181818;stroke-width:1.0;" x1="1490.5" x2="1490.5" y1="1440.8438" y2="1453.8438"/><line style="stroke:#181818;stroke-width:1.0;" x1="1449.5" x2="1490.5" y1="1453.8438" y2="1453.8438"/><polygon fill="#181818" points="1459.5,1449.8438,1449.5,1453.8438,1459.5,1457.8438,1455.5,1453.8438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1455.5" y="1434.0098">[24]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="262" x="1497.5" y="1434.0098">Commit Payer DFSP funds</text><polygon fill="#181818" points="1094.5,1491.5156,1084.5,1495.5156,1094.5,1499.5156,1090.5,1495.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1088.5" x2="1447.5" y1="1495.5156" y2="1495.5156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1100.5" y="1488.6816">[25]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1142.5" y="1488.6816">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="128" x="1194.5" y="1488.6816">/transfers/{Id}</text><polygon fill="#181818" points="1436.5,1533.1875,1446.5,1537.1875,1436.5,1541.1875,1440.5,1537.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1083.5" x2="1442.5" y1="1537.1875" y2="1537.1875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1090.5" y="1530.3535">[26]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="1132.5" y="1530.3535">HTTP 200 Response</text><polygon fill="#181818" points="877.5,1574.8594,867.5,1578.8594,877.5,1582.8594,873.5,1578.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="871.5" x2="1077.5" y1="1578.8594" y2="1578.8594"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="883.5" y="1572.0254">[27]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="925.5" y="1572.0254">response</text><polygon fill="#181818" points="141.5,1616.5313,131.5,1620.5313,141.5,1624.5313,137.5,1620.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="135.5" x2="865.5" y1="1620.5313" y2="1620.5313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="147.5" y="1613.6973">[28]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="189.5" y="1613.6973">response</text><path d="M10,1635.5313 L79,1635.5313 L79,1655.2031 L69,1665.2031 L10,1665.2031 L10,1635.5313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="181.3594" style="stroke:#000000;stroke-width:1.5;" width="455" x="10" y="1635.5313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="25" y="1659.3691">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="366" x="94" y="1660.3691">[if (transferStatus== 'COMMITTED')]</text><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="172.5" y1="1711.5469" y2="1711.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="172.5" x2="172.5" y1="1711.5469" y2="1724.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="172.5" y1="1724.5469" y2="1724.5469"/><polygon fill="#181818" points="141.5,1720.5469,131.5,1724.5469,141.5,1728.5469,137.5,1724.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="137.5" y="1704.7129">[29]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="152" x="179.5" y="1704.7129">Finalise transfer</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="465" y1="1733.5469" y2="1733.5469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="55" x="15" y="1756.3848">[else]</text><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="172.5" y1="1795.8906" y2="1795.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="172.5" x2="172.5" y1="1795.8906" y2="1808.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="172.5" y1="1808.8906" y2="1808.8906"/><polygon fill="#181818" points="141.5,1804.8906,131.5,1808.8906,141.5,1812.8906,137.5,1808.8906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="137.5" y="1789.0566">[30]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="161" x="179.5" y="1789.0566">Rollback transfer</text><!--MD5=[954b9b858bce1291e08f7c9a27720fa9]
@startuml PayerDFSPTwoPhasePattern
/'*****
- - - - - - - - - - - - - -
******'/

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
' declare title
' title Core-Connector transactional flow patterns
' declare actors
participant "Core banking solution" as CBS
box "Payment Manager\nPayer DFSP" #LightGrey
participant "Core\nConnector" as CC 
participant "SDK Scheme Adapter" as MC 
end box
participant "Mojaloop\nSwitch" as Switch
autonumber 1 1 "<b>[0]"

== Payer DFSP integration - 2 phase commit - with user confirmation ==

CBS->CC: **POST** /sendMoney \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = **false**)
CC->MC: **POST** /transfers
activate MC
MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
Switch- ->MC: HTTP 202 response
Switch->Switch: Determine Payee DFSP using oracle
Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
MC- ->Switch: HTTP 200 Response
rnote left MC
  Accept Party
endrnote
MC->Switch: **POST** /quotes
Switch- ->MC: HTTP 202 response
Switch->Switch: Pass on quote to Payee DFSP\n using **POST** /quotes
Switch->MC: **PUT** /quotes/{Id}
MC- ->Switch: HTTP 200 Response
MC- ->CC: Response
deactivate MC
CC- ->CBS: Response
CBS->CBS: Obtain concent from Payer on Fees and Payee Info
CBS->CBS: Reserve funds
CBS->CC: **PUT** /sendmoney/{transferId}
CC->MC: **PUT** /transfers

activate MC
MC->Switch: **POST** /transfers
Switch- ->MC: HTTP 202 response
Switch->Switch: Reserve Payer DFSP funds
Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /transfers
Switch->Switch: Commit Payer DFSP funds
Switch->MC: **PUT** /transfers/{Id}
MC- ->Switch: HTTP 200 Response
MC- ->CC: response
deactivate MC
CC- ->CBS: response
alt if (transferStatus== 'COMMITTED')
CBS->CBS: Finalise transfer
else else
CBS->CBS: Rollback transfer
end 
@enduml

@startuml PayerDFSPTwoPhasePattern

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
participant "Core banking solution" as CBS
box "Payment Manager\nPayer DFSP" #LightGrey
participant "Core\nConnector" as CC 
participant "SDK Scheme Adapter" as MC 
end box
participant "Mojaloop\nSwitch" as Switch
autonumber 1 1 "<b>[0]"

== Payer DFSP integration - 2 phase commit - with user confirmation ==

CBS->CC: **POST** /sendMoney \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = **false**)
CC->MC: **POST** /transfers
activate MC
MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
Switch- ->MC: HTTP 202 response
Switch->Switch: Determine Payee DFSP using oracle
Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
MC- ->Switch: HTTP 200 Response
rnote left MC
  Accept Party
endrnote
MC->Switch: **POST** /quotes
Switch- ->MC: HTTP 202 response
Switch->Switch: Pass on quote to Payee DFSP\n using **POST** /quotes
Switch->MC: **PUT** /quotes/{Id}
MC- ->Switch: HTTP 200 Response
MC- ->CC: Response
deactivate MC
CC- ->CBS: Response
CBS->CBS: Obtain concent from Payer on Fees and Payee Info
CBS->CBS: Reserve funds
CBS->CC: **PUT** /sendmoney/{transferId}
CC->MC: **PUT** /transfers

activate MC
MC->Switch: **POST** /transfers
Switch- ->MC: HTTP 202 response
Switch->Switch: Reserve Payer DFSP funds
Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /transfers
Switch->Switch: Commit Payer DFSP funds
Switch->MC: **PUT** /transfers/{Id}
MC- ->Switch: HTTP 200 Response
MC- ->CC: response
deactivate MC
CC- ->CBS: response
alt if (transferStatus== 'COMMITTED')
CBS->CBS: Finalise transfer
else else
CBS->CBS: Rollback transfer
end 
@enduml

PlantUML version 1.2022.6(Tue Jun 21 18:34:49 BST 2022)
(GPLV2 source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: GB
--></g></svg>