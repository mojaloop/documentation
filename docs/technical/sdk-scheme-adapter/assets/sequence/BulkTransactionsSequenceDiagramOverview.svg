<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="14701px" preserveAspectRatio="none" style="width:4322px;height:14701px;background:#FFFFFF;" version="1.1" viewBox="0 0 4322 14701" width="4322px" zoomAndPan="magnify"><defs/><g><rect fill="#D3D3D3" height="14689.0781" style="stroke:#181818;stroke-width:0.5;" width="801.5" x="1367.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="182" x="1677.25" y="28.8379">Payment Manager</text><rect fill="#D3D3D3" height="14689.0781" style="stroke:#181818;stroke-width:0.5;" width="676.5" x="3583" y="6"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="182" x="3830.25" y="28.8379">Payment Manager</text><rect fill="#FFFFFF" height="317.375" style="stroke:#181818;stroke-width:1.0;" width="10" x="2055.5" y="3490.6094"/><rect fill="#FFFFFF" height="598.75" style="stroke:#181818;stroke-width:1.0;" width="10" x="2055.5" y="7303.875"/><rect fill="#FFFFFF" height="1086.4844" style="stroke:#181818;stroke-width:1.0;" width="10" x="2055.5" y="11378.5469"/><rect height="281.375" style="stroke:#000000;stroke-width:1.5;fill:none;" width="515.5" x="1225" y="1349.2344"/><rect height="97.0156" style="stroke:#000000;stroke-width:1.5;fill:none;" width="369" x="1361.5" y="1526.5938"/><rect height="125.6875" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1440.5" x="734.5" y="3020.5313"/><rect height="1114.1563" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1869.5" x="1847" y="3160.2188"/><rect height="889.4531" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1849.5" x="1857" y="3209.5625"/><rect height="759.7656" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1750.5" x="1946" y="3332.25"/><rect height="124.6875" style="stroke:#000000;stroke-width:1.5;fill:none;" width="532" x="1946" y="4142.6875"/><rect height="2578.1094" style="stroke:#000000;stroke-width:1.5;fill:none;" width="2556.5" x="327" y="4343.0469"/><rect height="2521.7656" style="stroke:#000000;stroke-width:1.5;fill:none;" width="2536.5" x="337" y="4392.3906"/><rect height="1057.8125" style="stroke:#000000;stroke-width:1.5;fill:none;" width="2479.5" x="1806" y="6935.1563"/><rect height="459.7344" style="stroke:#000000;stroke-width:1.5;fill:none;" width="708.5" x="3567" y="7360.5469"/><rect height="208.0313" style="stroke:#000000;stroke-width:1.5;fill:none;" width="688.5" x="3577" y="7605.25"/><rect height="2882.5" style="stroke:#000000;stroke-width:1.5;fill:none;" width="2556.5" x="327" y="8006.9688"/><rect height="2826.1563" style="stroke:#000000;stroke-width:1.5;fill:none;" width="2536.5" x="337" y="8056.3125"/><rect height="1658.9063" style="stroke:#000000;stroke-width:1.5;fill:none;" width="2499.5" x="1806" y="10903.4688"/><rect height="152.3594" style="stroke:#000000;stroke-width:1.5;fill:none;" width="565.5" x="1946" y="11026.1563"/><rect height="1362.8594" style="stroke:#000000;stroke-width:1.5;fill:none;" width="2349.5" x="1946" y="11192.5156"/><rect height="459.7344" style="stroke:#000000;stroke-width:1.5;fill:none;" width="708.5" x="3567" y="11544.5625"/><rect height="208.0313" style="stroke:#000000;stroke-width:1.5;fill:none;" width="688.5" x="3577" y="11789.2656"/><rect height="309.7188" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1465" x="2820.5" y="12114.6406"/><rect height="211.7031" style="stroke:#000000;stroke-width:1.5;fill:none;" width="708.5" x="3567" y="12205.6563"/><rect height="84.0156" style="stroke:#000000;stroke-width:1.5;fill:none;" width="688.5" x="3577" y="12326.3438"/><rect height="488.4063" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1838" x="337" y="14088.6563"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="395" x2="395" y1="135.6875" y2="14594.0625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="796.5" x2="796.5" y1="135.6875" y2="14594.0625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1428.5" x2="1428.5" y1="135.6875" y2="14594.0625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="2060" x2="2060" y1="135.6875" y2="14594.0625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="2882.5" x2="2882.5" y1="135.6875" y2="14594.0625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="3457" x2="3457" y1="135.6875" y2="14594.0625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="3691" x2="3691" y1="135.6875" y2="14594.0625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="4198.5" x2="4198.5" y1="135.6875" y2="14594.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="91" x="347" y="130.8535">MFI Staff</text><ellipse cx="395.5" cy="56.5156" fill="#E3E3E3" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M395.5,64.5156 L395.5,91.5156 M382.5,72.5156 L408.5,72.5156 M395.5,91.5156 L382.5,106.5156 M395.5,91.5156 L408.5,106.5156 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="91" x="347" y="14615.9004">MFI Staff</text><ellipse cx="395.5" cy="14629.2344" fill="#E3E3E3" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M395.5,14637.2344 L395.5,14664.2344 M382.5,14645.2344 L408.5,14645.2344 M395.5,14664.2344 L382.5,14679.2344 M395.5,14664.2344 L408.5,14679.2344 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="744.5" y="93.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="751.5" y="122.8535">MFI CBS</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="744.5" y="14593.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="751.5" y="14622.9004">MFI CBS</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="1371.5" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="1404.5" y="95.1816">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="1378.5" y="122.8535">Connector</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="1371.5" y="14593.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="1404.5" y="14622.9004">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="1378.5" y="14650.5723">Connector</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209" x="1956" y="93.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="1963" y="122.8535">sdk-scheme-adapter</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209" x="1956" y="14593.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="1963" y="14622.9004">sdk-scheme-adapter</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="2830.5" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="2837.5" y="95.1816">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="2851" y="122.8535">Switch</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="2830.5" y="14593.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="2837.5" y="14622.9004">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="2851" y="14650.5723">Switch</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="3419" y="93.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="3426" y="122.8535">Oracle</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="3419" y="14593.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="3426" y="14622.9004">Oracle</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209" x="3587" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="62" x="3660.5" y="95.1816">Payee</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="3594" y="122.8535">sdk-scheme-adapter</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209" x="3587" y="14593.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="62" x="3660.5" y="14622.9004">Payee</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="3594" y="14650.5723">sdk-scheme-adapter</text><rect fill="#E3E3E3" height="97.0156" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="4141.5" y="37.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="62" x="4167.5" y="67.5098">Payee</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="4174.5" y="95.1816">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="4148.5" y="122.8535">Connector</text><rect fill="#E3E3E3" height="97.0156" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="4141.5" y="14593.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="62" x="4167.5" y="14622.9004">Payee</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="4174.5" y="14650.5723">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="4148.5" y="14678.2441">Connector</text><rect fill="#FFFFFF" height="317.375" style="stroke:#181818;stroke-width:1.0;" width="10" x="2055.5" y="3490.6094"/><rect fill="#FFFFFF" height="598.75" style="stroke:#181818;stroke-width:1.0;" width="10" x="2055.5" y="7303.875"/><rect fill="#FFFFFF" height="1086.4844" style="stroke:#181818;stroke-width:1.0;" width="10" x="2055.5" y="11378.5469"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="4315.5" x="0" y="172.5234"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="4315.5" y1="172.5234" y2="172.5234"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="4315.5" y1="175.5234" y2="175.5234"/><rect fill="#EEEEEE" height="35.6719" style="stroke:#000000;stroke-width:2.0;" width="613" x="1851.25" y="155.6875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="593" x="1857.25" y="182.5254">Bulk Transfers implemented using Mojaloop bulk transfers</text><polygon fill="#181818" points="784.5,231.0313,794.5,235.0313,784.5,239.0313,788.5,235.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="395.5" x2="790.5" y1="235.0313" y2="235.0313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="402.5" y="228.1973">[1]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="254" x="432.5" y="228.1973">Initiate bulk transaction call</text><polygon fill="#181818" points="1416.5,815.3047,1426.5,819.3047,1416.5,823.3047,1420.5,819.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="796.5" x2="1422.5" y1="819.3047" y2="819.3047"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="803.5" y="798.6348">[2]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="143" x="833.5" y="784.7988">Disburse funds</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="6" x="833.5" y="812.4707">Â </text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="839.5" y="812.4707">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="230" x="907.5" y="812.4707">outbound/bulkTransfers/</text><path d="M5,248.0313 L5,1337.0313 L792,1337.0313 L792,258.0313 L782,248.0313 L5,248.0313 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M782,248.0313 L782,258.0313 L792,258.0313 L782,248.0313 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="11" y="275.8691">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="521" x="29" y="303.541">"bulkHomeTransactionID": "UUID", # external identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="106" x="29" y="331.2129">"options": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="379" x="47" y="358.8848">"onlyValidateParty": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="47" y="386.5566">"autoAcceptParty": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="256" x="71" y="414.2285">"enabled": "true" # boolean</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="47" y="441.9004">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="203" x="47" y="469.5723">"autoAcceptQuote": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="276" x="59" y="497.2441">"enabled": "true", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="712" x="59" y="524.916">"perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="47" y="552.5879">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="371" x="47" y="580.2598">"skipPartyLookup": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="332" x="47" y="607.9316">"synchronous": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="546" x="47" y="635.6035">"bulkExpiration": DateTime, # expiration date time (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="35" y="663.2754">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="419" x="29" y="690.9473">"from": { "partyIdInfo": {} # (partyIdInfo type)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="77" y="718.6191">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="214" x="29" y="746.291">"individualTransfers": [</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="71" y="773.9629">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="694" x="83" y="801.6348">"homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="425" x="83" y="829.3066">"reference": "string", # Payer Loan reference</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="54" x="83" y="856.9785">"to": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="95" y="884.6504">"partyIdInfo": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="252" x="107" y="912.3223">"partyIdType": "MSISDN",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="233" x="107" y="939.9941">"partyIdentifier": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="279" x="107" y="967.666">"partySubIdOrType": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="150" x="107" y="995.3379">"fspId": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="107" y="1023.0098">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="95" y="1050.6816">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="533" x="83" y="1078.3535">"amountType": "RECEIVE" # SEND, RECEIVE (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="269" x="83" y="1106.0254">"currency" : "XXX" # (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="318" x="83" y="1133.6973">"amount": "100", # money (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="83" y="1161.3691">"note": "string"</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="512" x="83" y="1189.041">"quoteExtensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="525" x="83" y="1216.7129">"transferExtensions": [{ "key": "string", "value": "string"}]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="37" x="83" y="1244.3848">}, ...</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="12" x="71" y="1272.0566">],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="455" x="29" y="1299.7285">"extensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="11" y="1327.4004">}</text><path d="M1225,1349.2344 L1314,1349.2344 L1314,1368.9063 L1304,1378.9063 L1225,1378.9063 L1225,1349.2344 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="281.375" style="stroke:#000000;stroke-width:1.5;" width="515.5" x="1225" y="1349.2344"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1240" y="1373.0723">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1329" y="1374.0723">[n times  (in parallel)]</text><polygon fill="#FAFAFA" points="1245,1396.5781,1413,1396.5781,1423,1427.5781,1413,1459.5781,1245,1459.5781,1235,1427.5781,1245,1396.5781" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="164" x="1247" y="1423.416">For each transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="153" x="1247" y="1451.0879">in bulk message</text><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="1470.5" y1="1498.5938" y2="1498.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1470.5" x2="1470.5" y1="1498.5938" y2="1511.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1429.5" x2="1470.5" y1="1511.5938" y2="1511.5938"/><polygon fill="#181818" points="1439.5,1507.5938,1429.5,1511.5938,1439.5,1515.5938,1435.5,1511.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1435.5" y="1491.7598">[3]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="250" x="1465.5" y="1491.7598">validate MSISDN &amp; Prefix</text><path d="M1361.5,1526.5938 L1430.5,1526.5938 L1430.5,1546.2656 L1420.5,1556.2656 L1361.5,1556.2656 L1361.5,1526.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="97.0156" style="stroke:#000000;stroke-width:1.5;" width="369" x="1361.5" y="1526.5938"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1376.5" y="1550.4316">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="270" x="1445.5" y="1551.4316">[MSISDN Failed Validation]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="1470.5" y1="1602.6094" y2="1602.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1470.5" x2="1470.5" y1="1602.6094" y2="1615.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1429.5" x2="1470.5" y1="1615.6094" y2="1615.6094"/><polygon fill="#181818" points="1439.5,1611.6094,1429.5,1615.6094,1439.5,1619.6094,1435.5,1615.6094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1435.5" y="1595.7754">[4]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="253" x="1465.5" y="1595.7754">Add Last Error to Transfer</text><polygon fill="#181818" points="2048.5,2334.4063,2058.5,2338.4063,2048.5,2342.4063,2052.5,2338.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1428.5" x2="2054.5" y1="2338.4063" y2="2338.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1435.5" y="2331.5723">[5]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1465.5" y="2331.5723">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="224" x="1533.5" y="2331.5723">outbound/bulkTransfers</text><path d="M636,1642.6094 L636,3007.6094 L1423,3007.6094 L1423,1652.6094 L1413,1642.6094 L636,1642.6094 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M1413,1642.6094 L1413,1652.6094 L1423,1652.6094 L1413,1642.6094 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="184" x="642" y="1670.4473">BulkTransferType</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="642" y="1698.1191">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="521" x="660" y="1725.791">"bulkHomeTransactionID": "UUID", # external identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="106" x="660" y="1753.4629">"options": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="379" x="678" y="1781.1348">"onlyValidateParty": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="678" y="1808.8066">"autoAcceptParty": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="256" x="702" y="1836.4785">"enabled": "true" # boolean</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="678" y="1864.1504">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="203" x="678" y="1891.8223">"autoAcceptQuote": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="276" x="690" y="1919.4941">"enabled": "true", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="712" x="690" y="1947.166">"perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="678" y="1974.8379">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="371" x="678" y="2002.5098">"skipPartyLookup": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="332" x="678" y="2030.1816">"synchronous": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="546" x="678" y="2057.8535">"bulkExpiration": DateTime, # expiration date time (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="666" y="2085.5254">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="419" x="660" y="2113.1973">"from": { "partyIdInfo": {} # (partyIdInfo type)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="708" y="2140.8691">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="214" x="660" y="2168.541">"individualTransfers": [</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="702" y="2196.2129">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="694" x="714" y="2223.8848">"homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="425" x="714" y="2251.5566">"reference": "string", # Payer Loan reference</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="54" x="714" y="2279.2285">"to": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="726" y="2306.9004">"partyIdInfo": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="252" x="738" y="2334.5723">"partyIdType": "MSISDN",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="233" x="738" y="2362.2441">"partyIdentifier": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="279" x="738" y="2389.916">"partySubIdOrType": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="150" x="738" y="2417.5879">"fspId": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="738" y="2445.2598">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="726" y="2472.9316">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="533" x="714" y="2500.6035">"amountType": "RECEIVE" # SEND, RECEIVE (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="269" x="714" y="2528.2754">"currency" : "XXX" # (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="318" x="714" y="2555.9473">"amount": "100", # money (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="714" y="2583.6191">"note": "string"</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="512" x="714" y="2611.291">"quoteExtensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="525" x="714" y="2638.9629">"transferExtensions": [{ "key": "string", "value": "string"}]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="117" x="714" y="2666.6348">"lastError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="219" x="726" y="2694.3066">"httpStatusCode": 503,</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="173" x="726" y="2721.9785">"mojaloopError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="190" x="738" y="2749.6504">"errorInformation": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="197" x="750" y="2777.3223">"errorCode": "8812",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="257" x="750" y="2804.9941">"errorDescription": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="750" y="2832.666">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="738" y="2860.3379">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="726" y="2888.0098">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="37" x="714" y="2915.6816">}, ...</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="12" x="702" y="2943.3535">],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="455" x="660" y="2971.0254">"extensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="642" y="2998.6973">}</text><path d="M734.5,3020.5313 L803.5,3020.5313 L803.5,3040.2031 L793.5,3050.2031 L734.5,3050.2031 L734.5,3020.5313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="125.6875" style="stroke:#000000;stroke-width:1.5;" width="1440.5" x="734.5" y="3020.5313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="749.5" y="3044.3691">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="186" x="818.5" y="3045.3691">[if (!synchronous)]</text><polygon fill="#181818" points="1439.5,3092.5469,1429.5,3096.5469,1439.5,3100.5469,1435.5,3096.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1433.5" x2="2059.5" y1="3096.5469" y2="3096.5469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1445.5" y="3089.7129">[6]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="1475.5" y="3089.7129">Receive HTTP 202 response</text><polygon fill="#181818" points="807.5,3134.2188,797.5,3138.2188,807.5,3142.2188,803.5,3138.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="1427.5" y1="3138.2188" y2="3138.2188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="813.5" y="3131.3848">[7]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="843.5" y="3131.3848">Receive HTTP 202 response</text><path d="M1847,3160.2188 L1916,3160.2188 L1916,3179.8906 L1906,3189.8906 L1847,3189.8906 L1847,3160.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1114.1563" style="stroke:#000000;stroke-width:1.5;" width="1869.5" x="1847" y="3160.2188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1862" y="3184.0566">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="225" x="1931" y="3185.0566">[if (!skipPartyLookup)]</text><path d="M1857,3209.5625 L1946,3209.5625 L1946,3229.2344 L1936,3239.2344 L1857,3239.2344 L1857,3209.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="889.4531" style="stroke:#000000;stroke-width:1.5;" width="1849.5" x="1857" y="3209.5625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1872" y="3233.4004">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="545" x="1961" y="3234.4004">[N times &amp; within bulkExpiration timelimit  (in parallel)]</text><polygon fill="#FAFAFA" points="1877,3256.9063,2045,3256.9063,2055,3287.9063,2045,3319.9063,1877,3319.9063,1867,3287.9063,1877,3256.9063" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="164" x="1879" y="3283.7441">For each transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="153" x="1879" y="3311.416">in bulk message</text><path d="M1946,3332.25 L2015,3332.25 L2015,3351.9219 L2005,3361.9219 L1946,3361.9219 L1946,3332.25 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="759.7656" style="stroke:#000000;stroke-width:1.5;" width="1750.5" x="1946" y="3332.25"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1961" y="3356.0879">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="181" x="2030" y="3357.0879">[if (validTransfer)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="3408.2656" y2="3408.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="3408.2656" y2="3421.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="3421.2656" y2="3421.2656"/><polygon fill="#181818" points="2071.5,3417.2656,2061.5,3421.2656,2071.5,3425.2656,2067.5,3421.2656" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="2067.5" y="3401.4316">[8]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="202" x="2097.5" y="3401.4316">Create TransactionId</text><polygon fill="#181818" points="2870.5,3486.6094,2880.5,3490.6094,2870.5,3494.6094,2874.5,3490.6094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2065.5" x2="2876.5" y1="3490.6094" y2="3490.6094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="2072.5" y="3469.9395">[9]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="2102.5" y="3456.1035">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="86" x="2155.5" y="3456.1035">/parties/*</text><text fill="#000000" font-family="sans-serif" font-size="22" font-style="italic" lengthAdjust="spacing" textLength="143" x="2102.5" y="3483.7754">&lt;PartyIdType&gt;</text><text fill="#000000" font-family="sans-serif" font-size="22" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="6" x="2245.5" y="3483.7754">/</text><text fill="#000000" font-family="sans-serif" font-size="22" font-style="italic" lengthAdjust="spacing" textLength="95" x="2251.5" y="3483.7754">&lt;PartyId&gt;</text><polygon fill="#181818" points="3445.5,3555.9531,3455.5,3559.9531,3445.5,3563.9531,3449.5,3559.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="3451.5" y1="3559.9531" y2="3559.9531"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="3539.2832">[10]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="169" x="2931.5" y="3525.4473">Lookup DFSP for</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="178" x="2931.5" y="3553.1191">requested Type/ID</text><line style="stroke:#181818;stroke-width:1.0;" x1="3457.5" x2="3499.5" y1="3629.2969" y2="3629.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="3499.5" x2="3499.5" y1="3629.2969" y2="3642.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="3458.5" x2="3499.5" y1="3642.2969" y2="3642.2969"/><polygon fill="#181818" points="3468.5,3638.2969,3458.5,3642.2969,3468.5,3646.2969,3464.5,3642.2969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3464.5" y="3608.627">[11]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="161" x="3506.5" y="3594.791">Lookup Party for</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="178" x="3506.5" y="3622.4629">requested Type/ID</text><polygon fill="#181818" points="2893.5,3679.9688,2883.5,3683.9688,2893.5,3687.9688,2889.5,3683.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2887.5" x2="3456.5" y1="3683.9688" y2="3683.9688"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2899.5" y="3677.1348">[12]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="156" x="2941.5" y="3677.1348">Return DFSP ID</text><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="2924.5" y1="3753.3125" y2="3753.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="2924.5" x2="2924.5" y1="3753.3125" y2="3766.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="2883.5" x2="2924.5" y1="3766.3125" y2="3766.3125"/><polygon fill="#181818" points="2893.5,3762.3125,2883.5,3766.3125,2893.5,3770.3125,2889.5,3766.3125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="3732.6426">[13]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="2931.5" y="3718.8066">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="240" x="2984.5" y="3718.8066">/parties/{type}/{id}/{subid}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="519" x="2931.5" y="3746.4785">Make call to payee DFSP to confirm Party information</text><polygon fill="#181818" points="2071.5,3803.9844,2061.5,3807.9844,2071.5,3811.9844,2067.5,3807.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2065.5" x2="2881.5" y1="3807.9844" y2="3807.9844"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2077.5" y="3801.1504">[14]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="2119.5" y="3801.1504">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="244" x="2171.5" y="3801.1504">inbound/parties/{type}/{id}</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="3877.3281" y2="3877.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="3877.3281" y2="3890.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="3890.3281" y2="3890.3281"/><polygon fill="#181818" points="2071.5,3886.3281,2061.5,3890.3281,2071.5,3894.3281,2067.5,3890.3281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="3856.6582">[15]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="285" x="2109.5" y="3842.8223">Update transaction status and</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="260" x="2115.5" y="3870.4941">attach get parties response</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="3932" y2="3932"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="3932" y2="3945"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="3945" y2="3945"/><polygon fill="#181818" points="2071.5,3941,2061.5,3945,2071.5,3949,2067.5,3945" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="3925.166">[16]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="302" x="2109.5" y="3925.166">Add to next phase FSP bulk call</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="3986.6719" y2="3986.6719"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="3986.6719" y2="3999.6719"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="3999.6719" y2="3999.6719"/><polygon fill="#181818" points="2071.5,3995.6719,2061.5,3999.6719,2071.5,4003.6719,2067.5,3999.6719" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="3979.8379">[17]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="766" x="2109.5" y="3979.8379">Any Error, save the error state in lastError object to be returned to the caller later</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1946" x2="3696.5" y1="4008.6719" y2="4008.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="188" x="1951" y="4031.5098">[if (!validTransfer)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="4071.0156" y2="4071.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="4071.0156" y2="4084.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="4084.0156" y2="4084.0156"/><polygon fill="#181818" points="2071.5,4080.0156,2061.5,4084.0156,2071.5,4088.0156,2067.5,4084.0156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="4064.1816">[18]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="42" x="2109.5" y="4064.1816">Skip</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1847" x2="3716.5" y1="4107.0156" y2="4107.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="218" x="1852" y="4129.8535">[if (skipPartyLookup)]</text><path d="M1946,4142.6875 L2035,4142.6875 L2035,4162.3594 L2025,4172.3594 L1946,4172.3594 L1946,4142.6875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="124.6875" style="stroke:#000000;stroke-width:1.5;" width="532" x="1946" y="4142.6875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1961" y="4166.5254">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="423" x="2050" y="4167.5254">[N times &amp; within bulkExpiration timelimit]</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="4246.375" y2="4246.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="4246.375" y2="4259.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="4259.375" y2="4259.375"/><polygon fill="#181818" points="2071.5,4255.375,2061.5,4259.375,2071.5,4263.375,2067.5,4259.375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="4225.7051">[19]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="174" x="2109.5" y="4211.8691">Validate party info</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="302" x="2115.5" y="4239.541">Add to next phase FSP bulk call</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="4315.0469" y2="4315.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="4315.0469" y2="4328.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="4328.0469" y2="4328.0469"/><polygon fill="#181818" points="2071.5,4324.0469,2061.5,4328.0469,2071.5,4332.0469,2067.5,4328.0469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="4308.2129">[20]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="484" x="2109.5" y="4308.2129">if(transferStatusValid) Group into M Payee DFSPs</text><path d="M327,4343.0469 L396,4343.0469 L396,4362.7188 L386,4372.7188 L327,4372.7188 L327,4343.0469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2578.1094" style="stroke:#000000;stroke-width:1.5;" width="2556.5" x="327" y="4343.0469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="342" y="4366.8848">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="222" x="411" y="4367.8848">[if (!autoAcceptParty)]</text><path d="M337,4392.3906 L406,4392.3906 L406,4412.0625 L396,4422.0625 L337,4422.0625 L337,4392.3906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2521.7656" style="stroke:#000000;stroke-width:1.5;" width="2536.5" x="337" y="4392.3906"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="352" y="4416.2285">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="179" x="421" y="4417.2285">[if (synchronous)]</text><polygon fill="#181818" points="1439.5,4492.0781,1429.5,4496.0781,1439.5,4500.0781,1435.5,4496.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1433.5" x2="2059.5" y1="4496.0781" y2="4496.0781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="4475.4082">[21]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="387" x="1487.5" y="4461.5723">Response &lt;bulkPartyLookupResponse&gt;</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="549" x="1499.5" y="4489.2441">currentState="WAITING_FOR_PARTY_ACCEPTANCE"</text><polygon fill="#181818" points="807.5,4561.4219,797.5,4565.4219,807.5,4569.4219,803.5,4565.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="1427.5" y1="4565.4219" y2="4565.4219"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="4544.752">[22]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="387" x="855.5" y="4530.916">Response &lt;bulkPartyLookupResponse&gt;</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="549" x="867.5" y="4558.5879">currentState="WAITING_FOR_PARTY_ACCEPTANCE"</text><polygon fill="#181818" points="406.5,4603.0938,396.5,4607.0938,406.5,4611.0938,402.5,4607.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="400.5" x2="795.5" y1="4607.0938" y2="4607.0938"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="412.5" y="4600.2598">[23]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="235" x="454.5" y="4600.2598">Present Party Response</text><polygon fill="#181818" points="784.5,4644.7656,794.5,4648.7656,784.5,4652.7656,788.5,4648.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="395.5" x2="790.5" y1="4648.7656" y2="4648.7656"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="402.5" y="4641.9316">[24]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="124" x="444.5" y="4641.9316">Accept Party</text><polygon fill="#181818" points="1416.5,4686.4375,1426.5,4690.4375,1416.5,4694.4375,1420.5,4690.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="796.5" x2="1422.5" y1="4690.4375" y2="4690.4375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="803.5" y="4683.6035">[25]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="845.5" y="4683.6035">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="897.5" y="4683.6035">outbound/bulkTransfers/{bulkTransferId}</text><polygon fill="#181818" points="2048.5,4728.1094,2058.5,4732.1094,2048.5,4736.1094,2052.5,4732.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="2054.5" y1="4732.1094" y2="4732.1094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1435.5" y="4725.2754">[26]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1477.5" y="4725.2754">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="1529.5" y="4725.2754">outbound/bulkTransfers/{bulkTransferId}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="337" x2="2873.5" y1="4741.1094" y2="4741.1094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="186" x="342" y="4763.9473">[if (!synchronous)]</text><polygon fill="#181818" points="1439.5,5521.9219,1429.5,5525.9219,1439.5,5529.9219,1435.5,5525.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1433.5" x2="2059.5" y1="5525.9219" y2="5525.9219"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="5505.252">[27]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1487.5" y="5491.416">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="366" x="1539.5" y="5491.416">inbound/bulkTransfers/{bulkTransferId}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="549" x="1499.5" y="5519.0879">currentState="WAITING_FOR_PARTY_ACCEPTANCE"</text><path d="M2065,4774.7813 L2065,6222.7813 L2858,6222.7813 L2858,4784.7813 L2848,4774.7813 L2065,4774.7813 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M2848,4774.7813 L2848,4784.7813 L2858,4784.7813 L2848,4774.7813 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="276" x="2071" y="4802.6191">bulkPartyLookupResponse</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="54" x="2071" y="4830.291">Refer</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="266" x="2131" y="4830.291">Party Lookup Error Codes</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="235" x="2403" y="4830.291">table for lastError details</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2071" y="4857.9629">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="527" x="2083" y="4885.6348">"bulkHomeTransactionID": "UUID", # external identifier,</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="533" x="2083" y="4913.3066">"bulkTransferId": "UUID",  # generated by ML connector</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="570" x="2083" y="4940.9785">"currentState": "WAITING_FOR_PARTY_ACCEPTANCE",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="106" x="2083" y="4968.6504">"options": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="379" x="2107" y="4996.3223">"onlyValidateParty": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="2107" y="5023.9941">"autoAcceptParty": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="256" x="2131" y="5051.666">"enabled": "true" # boolean</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2107" y="5079.3379">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="203" x="2107" y="5107.0098">"autoAcceptQuote": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="276" x="2131" y="5134.6816">"enabled": "true", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="712" x="2131" y="5162.3535">"perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2107" y="5190.0254">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="371" x="2107" y="5217.6973">"skipPartyLookup": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="332" x="2107" y="5245.3691">"synchronous": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="546" x="2107" y="5273.041">"bulkExpiration": DateTime, # expiration date time (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2083" y="5300.7129">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="274" x="2083" y="5328.3848">"individualTransferResults": [</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2131" y="5356.0566">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="694" x="2143" y="5383.7285">"homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="495" x="2143" y="5411.4004">"transactionId": "UUID", # Created by ML connector</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="425" x="2143" y="5439.0723">"reference": "string", # Payer Loan reference</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="54" x="2143" y="5466.7441">"to": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="2155" y="5494.416">"partyIdInfo": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="252" x="2167" y="5522.0879">"partyIdType": "MSISDN",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="233" x="2167" y="5549.7598">"partyIdentifier": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="279" x="2167" y="5577.4316">"partySubIdOrType": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="150" x="2167" y="5605.1035">"fspId": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2167" y="5632.7754">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2155" y="5660.4473">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="533" x="2143" y="5688.1191">"amountType": "RECEIVE" # SEND, RECEIVE (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="269" x="2143" y="5715.791">"currency" : "XXX" # (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="318" x="2143" y="5743.4629">"amount": "100", # money (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="2143" y="5771.1348">"note": "string"</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="512" x="2143" y="5798.8066">"quoteExtensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="525" x="2143" y="5826.4785">"transferExtensions": [{ "key": "string", "value": "string"}]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="117" x="2143" y="5854.1504">"lastError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="219" x="2155" y="5881.8223">"httpStatusCode": 503,</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="173" x="2155" y="5909.4941">"mojaloopError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="190" x="2167" y="5937.166">"errorInformation": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="209" x="2179" y="5964.8379">"errorCode": "8812",1</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="257" x="2179" y="5992.5098">"errorDescription": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2179" y="6020.1816">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2167" y="6047.8535">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2155" y="6075.5254">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2143" y="6103.1973">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2131" y="6130.8691">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="12" x="2083" y="6158.541">],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="455" x="2083" y="6186.2129">"extensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2071" y="6213.8848">}</text><polygon fill="#181818" points="2048.5,6258.3906,2058.5,6262.3906,2048.5,6266.3906,2052.5,6262.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1428.5" x2="2054.5" y1="6262.3906" y2="6262.3906"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1435.5" y="6255.5566">[28]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="1477.5" y="6255.5566">Receive HTTP 202 response</text><polygon fill="#181818" points="807.5,6327.7344,797.5,6331.7344,807.5,6335.7344,803.5,6331.7344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="801.5" x2="1427.5" y1="6331.7344" y2="6331.7344"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="6311.0645">[29]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="855.5" y="6297.2285">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="291" x="907.5" y="6297.2285">/bulkTransfers/{bulkTransferId}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="549" x="867.5" y="6324.9004">currentState="WAITING_FOR_PARTY_ACCEPTANCE"</text><polygon fill="#181818" points="1416.5,6369.4063,1426.5,6373.4063,1416.5,6377.4063,1420.5,6373.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="796.5" x2="1422.5" y1="6373.4063" y2="6373.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="803.5" y="6366.5723">[30]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="845.5" y="6366.5723">Receive HTTP 202 response</text><polygon fill="#181818" points="406.5,6411.0781,396.5,6415.0781,406.5,6419.0781,402.5,6415.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="400.5" x2="795.5" y1="6415.0781" y2="6415.0781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="412.5" y="6408.2441">[31]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="235" x="454.5" y="6408.2441">Present Party Response</text><polygon fill="#181818" points="784.5,6452.75,794.5,6456.75,784.5,6460.75,788.5,6456.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="395.5" x2="790.5" y1="6456.75" y2="6456.75"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="402.5" y="6449.916">[32]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="124" x="444.5" y="6449.916">Accept Party</text><polygon fill="#181818" points="1416.5,6494.4219,1426.5,6498.4219,1416.5,6502.4219,1420.5,6498.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="796.5" x2="1422.5" y1="6498.4219" y2="6498.4219"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="803.5" y="6491.5879">[33]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="845.5" y="6491.5879">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="897.5" y="6491.5879">outbound/bulkTransfers/{bulkTransferId}</text><polygon fill="#181818" points="2048.5,6677.4531,2058.5,6681.4531,2048.5,6685.4531,2052.5,6681.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="2054.5" y1="6681.4531" y2="6681.4531"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1435.5" y="6674.6191">[34]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1477.5" y="6674.6191">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="1529.5" y="6674.6191">outbound/bulkTransfers/{bulkTransferId}</text><path d="M636,6511.4219 L636,6825.4219 L1423,6825.4219 L1423,6521.4219 L1413,6511.4219 L636,6511.4219 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M1413,6511.4219 L1413,6521.4219 L1423,6521.4219 L1413,6511.4219 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="384" x="642" y="6539.2598">bulkTransferContinuationAcceptParty</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="642" y="6566.9316">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="521" x="654" y="6594.6035">"bulkHomeTransactionID": "UUID", # external identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="214" x="654" y="6622.2754">"individualTransfers": [</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="702" y="6649.9473">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="694" x="714" y="6677.6191">"homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="495" x="714" y="6705.291">"transactionId": "UUID", # Created by ML connector</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="310" x="714" y="6732.9629">"acceptParty": "true" # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="702" y="6760.6348">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="12" x="654" y="6788.3066">],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="642" y="6815.9785">}</text><polygon fill="#181818" points="1439.5,6860.4844,1429.5,6864.4844,1439.5,6868.4844,1435.5,6864.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1433.5" x2="2059.5" y1="6864.4844" y2="6864.4844"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="6857.6504">[35]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="1487.5" y="6857.6504">Receive HTTP 202 response</text><polygon fill="#181818" points="807.5,6902.1563,797.5,6906.1563,807.5,6910.1563,803.5,6906.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="1427.5" y1="6906.1563" y2="6906.1563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="6899.3223">[36]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="855.5" y="6899.3223">Receive HTTP 202 response</text><path d="M1806,6935.1563 L1895,6935.1563 L1895,6954.8281 L1885,6964.8281 L1806,6964.8281 L1806,6935.1563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1057.8125" style="stroke:#000000;stroke-width:1.5;" width="2479.5" x="1806" y="6935.1563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1821" y="6958.9941">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="729" x="1910" y="6959.9941">[Quote Processing (M times &amp; within bulkExpiration timelimit in parallel)]</text><polygon fill="#FAFAFA" points="1826,6982.5,2045,6982.5,2055,7013.5,2045,7045.5,1826,7045.5,1816,7013.5,1826,6982.5" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="215" x="1828" y="7009.3379">For each payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="153" x="1828" y="7037.0098">in bulk message</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="7084.5156" y2="7084.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="7084.5156" y2="7097.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="7097.5156" y2="7097.5156"/><polygon fill="#181818" points="2071.5,7093.5156,2061.5,7097.5156,2071.5,7101.5156,2067.5,7097.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="7077.6816">[37]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="199" x="2109.5" y="7077.6816">Check bulkExpiration</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="7139.1875" y2="7139.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="7139.1875" y2="7152.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="7152.1875" y2="7152.1875"/><polygon fill="#181818" points="2071.5,7148.1875,2061.5,7152.1875,2071.5,7156.1875,2067.5,7152.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="7132.3535">[38]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="239" x="2109.5" y="7132.3535">Create bulkTransactionId</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="7249.2031" y2="7249.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="7249.2031" y2="7262.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="7262.2031" y2="7262.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2071.5" y1="7262.2031" y2="7258.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2071.5" y1="7262.2031" y2="7266.2031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="7214.6973">[39]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="194" x="2109.5" y="7187.0254">Calculate bulk expiry</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="391" x="2109.5" y="7214.6973">based on both expirySeconds config and</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="133" x="2109.5" y="7242.3691">bulkExpiration</text><line style="stroke:#181818;stroke-width:1.0;" x1="2880.5" x2="2870.5" y1="7303.875" y2="7299.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2880.5" x2="2870.5" y1="7303.875" y2="7307.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2065.5" x2="2881.5" y1="7303.875" y2="7303.875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2072.5" y="7297.041">[40]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="2114.5" y="7297.041">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="108" x="2182.5" y="7297.041">/bulkquotes</text><polygon fill="#181818" points="3679.5,7341.5469,3689.5,7345.5469,3679.5,7349.5469,3683.5,7345.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="3685.5" y1="7345.5469" y2="7345.5469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="7338.7129">[41]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="2931.5" y="7338.7129">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="183" x="2999.5" y="7338.7129">inbound/bulkquotes</text><path d="M3567,7360.5469 L3636,7360.5469 L3636,7380.2188 L3626,7390.2188 L3567,7390.2188 L3567,7360.5469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="459.7344" style="stroke:#000000;stroke-width:1.5;" width="708.5" x="3567" y="7360.5469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="3582" y="7384.3848">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="322" x="3651" y="7385.3848">[if (HasSupportForBulkQuotes)]</text><polygon fill="#181818" points="4186.5,7432.5625,4196.5,7436.5625,4186.5,7440.5625,4190.5,7436.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="4192.5" y1="7436.5625" y2="7436.5625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="7429.7285">[42]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="3740.5" y="7429.7285">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="183" x="3808.5" y="7429.7285">inbound/bulkquotes</text><polygon fill="#181818" points="3702.5,7474.2344,3692.5,7478.2344,3702.5,7482.2344,3698.5,7478.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3696.5" x2="4197.5" y1="7478.2344" y2="7478.2344"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3708.5" y="7471.4004">[43]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="299" x="3750.5" y="7471.4004">Reponse bulkquotes Response</text><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="3733.5" y1="7547.5781" y2="7547.5781"/><line style="stroke:#181818;stroke-width:1.0;" x1="3733.5" x2="3733.5" y1="7547.5781" y2="7560.5781"/><line style="stroke:#181818;stroke-width:1.0;" x1="3692.5" x2="3733.5" y1="7560.5781" y2="7560.5781"/><polygon fill="#181818" points="3702.5,7556.5781,3692.5,7560.5781,3702.5,7564.5781,3698.5,7560.5781" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="7526.9082">[44]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="267" x="3740.5" y="7513.0723">Update transaction statuses</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="265" x="3740.5" y="7540.7441">and attach quote responses</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3567" x2="4275.5" y1="7569.5781" y2="7569.5781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="329" x="3572" y="7592.416">[if (!HasSupportForBulkQuotes)]</text><path d="M3577,7605.25 L3666,7605.25 L3666,7624.9219 L3656,7634.9219 L3577,7634.9219 L3577,7605.25 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="208.0313" style="stroke:#000000;stroke-width:1.5;" width="688.5" x="3577" y="7605.25"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="3592" y="7629.0879">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="435" x="3681" y="7630.0879">[X times for each transfer in bulk message]</text><polygon fill="#181818" points="4186.5,7677.2656,4196.5,7681.2656,4186.5,7685.2656,4190.5,7681.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="4192.5" y1="7681.2656" y2="7681.2656"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="7674.4316">[45]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="3740.5" y="7674.4316">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="217" x="3808.5" y="7674.4316">inbound/quoterequests</text><polygon fill="#181818" points="3702.5,7718.9375,3692.5,7722.9375,3702.5,7726.9375,3698.5,7722.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3696.5" x2="4197.5" y1="7722.9375" y2="7722.9375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3708.5" y="7716.1035">[46]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="3750.5" y="7716.1035">response</text><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="3733.5" y1="7792.2813" y2="7792.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="3733.5" x2="3733.5" y1="7792.2813" y2="7805.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="3692.5" x2="3733.5" y1="7805.2813" y2="7805.2813"/><polygon fill="#181818" points="3702.5,7801.2813,3692.5,7805.2813,3702.5,7809.2813,3698.5,7805.2813" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="7771.6113">[47]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="244" x="3740.5" y="7757.7754">Update transaction status</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="254" x="3740.5" y="7785.4473">and attach quote response</text><polygon fill="#181818" points="2893.5,7856.9531,2883.5,7860.9531,2893.5,7864.9531,2889.5,7860.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2887.5" x2="3690.5" y1="7860.9531" y2="7860.9531"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2899.5" y="7854.1191">[48]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="2941.5" y="7854.1191">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="145" x="2993.5" y="7854.1191">/bulkquotes/{id)</text><polygon fill="#181818" points="2071.5,7898.625,2061.5,7902.625,2071.5,7906.625,2067.5,7902.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2065.5" x2="2881.5" y1="7902.625" y2="7902.625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2077.5" y="7895.791">[49]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="2119.5" y="7895.791">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="220" x="2171.5" y="7895.791">inbound/bulkquotes/{id)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="7971.9688" y2="7971.9688"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="7971.9688" y2="7984.9688"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="7984.9688" y2="7984.9688"/><polygon fill="#181818" points="2071.5,7980.9688,2061.5,7984.9688,2071.5,7988.9688,2067.5,7984.9688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="7951.2988">[50]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="244" x="2109.5" y="7937.4629">Update transaction status</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="254" x="2109.5" y="7965.1348">and attach quote response</text><path d="M327,8006.9688 L396,8006.9688 L396,8026.6406 L386,8036.6406 L327,8036.6406 L327,8006.9688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2882.5" style="stroke:#000000;stroke-width:1.5;" width="2556.5" x="327" y="8006.9688"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="342" y="8030.8066">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="231" x="411" y="8031.8066">[if (!autoAcceptQuote)]</text><path d="M337,8056.3125 L406,8056.3125 L406,8075.9844 L396,8085.9844 L337,8085.9844 L337,8056.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2826.1563" style="stroke:#000000;stroke-width:1.5;" width="2536.5" x="337" y="8056.3125"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="352" y="8080.1504">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="179" x="421" y="8081.1504">[if (synchronous)]</text><polygon fill="#181818" points="1439.5,8156,1429.5,8160,1439.5,8164,1435.5,8160" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1433.5" x2="2059.5" y1="8160" y2="8160"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="8139.3301">[51]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="404" x="1487.5" y="8125.4941">Response &lt;bulkQuoteRequestResponse&gt;</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="554" x="1499.5" y="8153.166">currentState="WAITING_FOR_QUOTE_ACCEPTANCE"</text><polygon fill="#181818" points="807.5,8225.3438,797.5,8229.3438,807.5,8233.3438,803.5,8229.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="1427.5" y1="8229.3438" y2="8229.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="8208.6738">[52]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="404" x="855.5" y="8194.8379">Response &lt;bulkQuoteRequestResponse&gt;</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="554" x="867.5" y="8222.5098">currentState="WAITING_FOR_QUOTE_ACCEPTANCE"</text><polygon fill="#181818" points="406.5,8267.0156,396.5,8271.0156,406.5,8275.0156,402.5,8271.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="400.5" x2="795.5" y1="8271.0156" y2="8271.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="412.5" y="8264.1816">[53]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="243" x="454.5" y="8264.1816">Present Quote Response</text><polygon fill="#181818" points="784.5,8308.6875,794.5,8312.6875,784.5,8316.6875,788.5,8312.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="395.5" x2="790.5" y1="8312.6875" y2="8312.6875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="402.5" y="8305.8535">[54]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="132" x="444.5" y="8305.8535">Accept Quote</text><polygon fill="#181818" points="1416.5,8350.3594,1426.5,8354.3594,1416.5,8358.3594,1420.5,8354.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="796.5" x2="1422.5" y1="8354.3594" y2="8354.3594"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="803.5" y="8347.5254">[55]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="845.5" y="8347.5254">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="897.5" y="8347.5254">outbound/bulkTransfers/{bulkTransferId}</text><polygon fill="#181818" points="2048.5,8392.0313,2058.5,8396.0313,2048.5,8400.0313,2052.5,8396.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="2054.5" y1="8396.0313" y2="8396.0313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1435.5" y="8389.1973">[56]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1477.5" y="8389.1973">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="1529.5" y="8389.1973">outbound/bulkTransfers/{bulkTransferId}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="337" x2="2873.5" y1="8405.0313" y2="8405.0313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="186" x="342" y="8427.8691">[if (!synchronous)]</text><polygon fill="#181818" points="1439.5,9338.0391,1429.5,9342.0391,1439.5,9346.0391,1435.5,9342.0391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1433.5" x2="2059.5" y1="9342.0391" y2="9342.0391"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="9321.3691">[57]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1487.5" y="9307.5332">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="366" x="1539.5" y="9307.5332">inbound/bulkTransfers/{bulkTransferId}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="554" x="1499.5" y="9335.2051">currentState="WAITING_FOR_QUOTE_ACCEPTANCE"</text><path d="M2065,8438.7031 L2065,10191.7031 L2858,10191.7031 L2858,8448.7031 L2848,8438.7031 L2065,8438.7031 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M2848,8438.7031 L2848,8448.7031 L2858,8448.7031 L2848,8438.7031 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="293" x="2071" y="8466.541">bulkQuoteRequestResponse</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2071" y="8494.2129">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="521" x="2083" y="8521.8848">"bulkHomeTransactionID": "UUID", # external identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="533" x="2083" y="8549.5566">"bulkTransferId": "UUID",  # generated by ML connector</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="575" x="2083" y="8577.2285">"currentState": "WAITING_FOR_QUOTE_ACCEPTANCE",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="106" x="2083" y="8604.9004">"options": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="379" x="2107" y="8632.5723">"onlyValidateParty": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="195" x="2107" y="8660.2441">"autoAcceptParty": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="256" x="2131" y="8687.916">"enabled": "true" # boolean</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2107" y="8715.5879">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="203" x="2107" y="8743.2598">"autoAcceptQuote": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="276" x="2131" y="8770.9316">"enabled": "true", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="712" x="2131" y="8798.6035">"perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2107" y="8826.2754">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="371" x="2107" y="8853.9473">"skipPartyLookup": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="332" x="2107" y="8881.6191">"synchronous": "false", # (boolean)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="546" x="2107" y="8909.291">"bulkExpiration": DateTime, # expiration date time (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2083" y="8936.9629">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="274" x="2083" y="8964.6348">"individualTransferResults": [</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2131" y="8992.3066">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="694" x="2143" y="9019.9785">"homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="495" x="2143" y="9047.6504">"transactionId": "UUID", # Created by ML connector</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="425" x="2143" y="9075.3223">"reference": "string", # Payer Loan reference</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="54" x="2143" y="9102.9941">"to": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="2155" y="9130.666">"partyIdInfo": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="252" x="2167" y="9158.3379">"partyIdType": "MSISDN",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="233" x="2167" y="9186.0098">"partyIdentifier": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="279" x="2167" y="9213.6816">"partySubIdOrType": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="150" x="2167" y="9241.3535">"fspId": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2167" y="9269.0254">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2155" y="9296.6973">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="533" x="2143" y="9324.3691">"amountType": "RECEIVE" # SEND, RECEIVE (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="269" x="2143" y="9352.041">"currency" : "XXX" # (Enum)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="318" x="2143" y="9379.7129">"amount": "100", # money (string)</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="2143" y="9407.3848">"note": "string"</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="523" x="2143" y="9435.0566">"quoteId": "4932beab-423e-37b6-8587-49c016d2f5ef",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="512" x="2143" y="9462.7285">"quoteExtensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="531" x="2143" y="9490.4004">"transferExtensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="187" x="2143" y="9518.0723">"quoteResponse": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="517" x="2155" y="9545.7441">"transferAmount": {"currency": "AED","amount": "0.7"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="606" x="2155" y="9573.416">"payeeReceiveAmount": {"currency": "AED","amount": "0.922"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="568" x="2155" y="9601.0879">"payeeFspFee": {"currency": "AED","amount": "67247160"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="664" x="2155" y="9628.7598">"payeeFspCommission": {"currency": "AED","amount": "829358883"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="460" x="2155" y="9656.4316">"expiration": "6286-11-29T16:19:08.300+06:14",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="506" x="2155" y="9684.1035">"geoCode": {"latitude": "5.9","longitude": "180.0000"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="468" x="2155" y="9711.7754">"ilpPacket": "XqOB5HUGEifQ-ebr0TAVAgD3...",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="279" x="2155" y="9739.4473">"condition": "gZI4iD9u_Yc...",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2155" y="9767.1191">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2143" y="9794.791">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="117" x="2143" y="9822.4629">"lastError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="219" x="2155" y="9850.1348">"httpStatusCode": 503,</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="173" x="2155" y="9877.8066">"mojaloopError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="190" x="2167" y="9905.4785">"errorInformation": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="197" x="2179" y="9933.1504">"errorCode": "8812",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="257" x="2179" y="9960.8223">"errorDescription": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2179" y="9988.4941">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2167" y="10016.166">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2155" y="10043.8379">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2143" y="10071.5098">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2131" y="10099.1816">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="12" x="2083" y="10126.8535">],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="455" x="2083" y="10154.5254">"extensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2071" y="10182.1973">}</text><polygon fill="#181818" points="2048.5,10226.7031,2058.5,10230.7031,2048.5,10234.7031,2052.5,10230.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1428.5" x2="2054.5" y1="10230.7031" y2="10230.7031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1435.5" y="10223.8691">[58]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="1477.5" y="10223.8691">Receive HTTP 202 response</text><polygon fill="#181818" points="807.5,10296.0469,797.5,10300.0469,807.5,10304.0469,803.5,10300.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="801.5" x2="1427.5" y1="10300.0469" y2="10300.0469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="10279.377">[59]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="855.5" y="10265.541">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="291" x="907.5" y="10265.541">/bulkTransfers/{bulkTransferId}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="554" x="867.5" y="10293.2129">currentState="WAITING_FOR_QUOTE_ACCEPTANCE"</text><polygon fill="#181818" points="1416.5,10337.7188,1426.5,10341.7188,1416.5,10345.7188,1420.5,10341.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="796.5" x2="1422.5" y1="10341.7188" y2="10341.7188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="803.5" y="10334.8848">[60]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="845.5" y="10334.8848">Receive HTTP 202 response</text><polygon fill="#181818" points="406.5,10379.3906,396.5,10383.3906,406.5,10387.3906,402.5,10383.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="400.5" x2="795.5" y1="10383.3906" y2="10383.3906"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="412.5" y="10376.5566">[61]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="243" x="454.5" y="10376.5566">Present Quote Response</text><polygon fill="#181818" points="784.5,10421.0625,794.5,10425.0625,784.5,10429.0625,788.5,10425.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="395.5" x2="790.5" y1="10425.0625" y2="10425.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="402.5" y="10418.2285">[62]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="132" x="444.5" y="10418.2285">Accept Quote</text><polygon fill="#181818" points="1416.5,10462.7344,1426.5,10466.7344,1416.5,10470.7344,1420.5,10466.7344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="796.5" x2="1422.5" y1="10466.7344" y2="10466.7344"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="803.5" y="10459.9004">[63]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="845.5" y="10459.9004">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="897.5" y="10459.9004">outbound/bulkTransfers/{bulkTransferId}</text><polygon fill="#181818" points="2048.5,10645.7656,2058.5,10649.7656,2048.5,10653.7656,2052.5,10649.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="2054.5" y1="10649.7656" y2="10649.7656"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1435.5" y="10642.9316">[64]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1477.5" y="10642.9316">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="380" x="1529.5" y="10642.9316">outbound/bulkTransfers/{bulkTransferId}</text><path d="M636,10479.7344 L636,10793.7344 L1423,10793.7344 L1423,10489.7344 L1413,10479.7344 L636,10479.7344 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M1413,10479.7344 L1413,10489.7344 L1423,10489.7344 L1413,10479.7344 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="176" x="642" y="10507.5723">bulkAcceptQuote</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="642" y="10535.2441">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="521" x="654" y="10562.916">"bulkHomeTransactionID": "UUID", # external identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="214" x="654" y="10590.5879">"individualTransfers": [</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="702" y="10618.2598">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="694" x="714" y="10645.9316">"homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="495" x="714" y="10673.6035">"transactionId": "UUID", # Created by ML connector</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="298" x="714" y="10701.2754">"acceptQuote": "true" #boolean</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="702" y="10728.9473">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="12" x="654" y="10756.6191">],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="642" y="10784.291">}</text><polygon fill="#181818" points="1439.5,10828.7969,1429.5,10832.7969,1439.5,10836.7969,1435.5,10832.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1433.5" x2="2059.5" y1="10832.7969" y2="10832.7969"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="10825.9629">[65]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="1487.5" y="10825.9629">Receive HTTP 202 response</text><polygon fill="#181818" points="807.5,10870.4688,797.5,10874.4688,807.5,10878.4688,803.5,10874.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="1427.5" y1="10874.4688" y2="10874.4688"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="10867.6348">[66]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="855.5" y="10867.6348">Receive HTTP 202 response</text><path d="M1806,10903.4688 L1895,10903.4688 L1895,10923.1406 L1885,10933.1406 L1806,10933.1406 L1806,10903.4688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1658.9063" style="stroke:#000000;stroke-width:1.5;" width="2499.5" x="1806" y="10903.4688"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1821" y="10927.3066">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="760" x="1910" y="10928.3066">[Transfer Processing (M times &amp; within bulkExpiration timelimit  in parallel)]</text><polygon fill="#FAFAFA" points="1826,10950.8125,2045,10950.8125,2055,10981.8125,2045,11013.8125,1826,11013.8125,1816,10981.8125,1826,10950.8125" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="215" x="1828" y="10977.6504">For each payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="153" x="1828" y="11005.3223">in bulk message</text><path d="M1946,11026.1563 L2015,11026.1563 L2015,11045.8281 L2005,11055.8281 L1946,11055.8281 L1946,11026.1563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="152.3594" style="stroke:#000000;stroke-width:1.5;" width="565.5" x="1946" y="11026.1563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1961" y="11049.9941">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="227" x="2030" y="11050.9941">[if (AutoAcceptQuote)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="11157.5156" y2="11157.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="11157.5156" y2="11170.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="11170.5156" y2="11170.5156"/><polygon fill="#181818" points="2071.5,11166.5156,2061.5,11170.5156,2071.5,11174.5156,2067.5,11170.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="11123.0098">[67]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="374" x="2109.5" y="11095.3379">Confirm Fees meets auto accept levels</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="378" x="2115.5" y="11123.0098">and bulkExpiration timelimit not reached</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="250" x="2109.5" y="11150.6816">-&gt; Update Transfer Status</text><path d="M1946,11192.5156 L2015,11192.5156 L2015,11212.1875 L2005,11222.1875 L1946,11222.1875 L1946,11192.5156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1362.8594" style="stroke:#000000;stroke-width:1.5;" width="2349.5" x="1946" y="11192.5156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1961" y="11216.3535">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="204" x="2030" y="11217.3535">[if (AcceptedQuote)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="11323.875" y2="11323.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="11323.875" y2="11336.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="11336.875" y2="11336.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2071.5" y1="11336.875" y2="11332.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2071.5" y1="11336.875" y2="11340.875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="11289.3691">[68]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="194" x="2109.5" y="11261.6973">Calculate bulk expiry</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="391" x="2109.5" y="11289.3691">based on both expirySeconds config and</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="133" x="2109.5" y="11317.041">bulkExpiration</text><line style="stroke:#181818;stroke-width:1.0;" x1="2880.5" x2="2870.5" y1="11378.5469" y2="11374.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="2880.5" x2="2870.5" y1="11378.5469" y2="11382.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="2065.5" x2="2881.5" y1="11378.5469" y2="11378.5469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2072.5" y="11371.7129">[69]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="2114.5" y="11371.7129">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="127" x="2182.5" y="11371.7129">/bulktransfers</text><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="2924.5" y1="11420.2188" y2="11420.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="2924.5" x2="2924.5" y1="11420.2188" y2="11433.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="2883.5" x2="2924.5" y1="11433.2188" y2="11433.2188"/><polygon fill="#181818" points="2893.5,11429.2188,2883.5,11433.2188,2893.5,11437.2188,2889.5,11433.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="11413.3848">[70]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="496" x="2931.5" y="11413.3848">Perform liquidity(NDC)check at indivial transfer level</text><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="2924.5" y1="11474.8906" y2="11474.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="2924.5" x2="2924.5" y1="11474.8906" y2="11487.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="2883.5" x2="2924.5" y1="11487.8906" y2="11487.8906"/><polygon fill="#181818" points="2893.5,11483.8906,2883.5,11487.8906,2893.5,11491.8906,2889.5,11487.8906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="11468.0566">[71]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="368" x="2931.5" y="11468.0566">Reserve Funds at indivial transfer level</text><line style="stroke:#181818;stroke-width:1.0;" x1="3689.5" x2="3679.5" y1="11529.5625" y2="11525.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="3689.5" x2="3679.5" y1="11529.5625" y2="11533.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="3690.5" y1="11529.5625" y2="11529.5625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="11522.7285">[72]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="2931.5" y="11522.7285">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="202" x="2999.5" y="11522.7285">inbound/bulktransfers</text><path d="M3567,11544.5625 L3636,11544.5625 L3636,11564.2344 L3626,11574.2344 L3567,11574.2344 L3567,11544.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="459.7344" style="stroke:#000000;stroke-width:1.5;" width="708.5" x="3567" y="11544.5625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="3582" y="11568.4004">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="347" x="3651" y="11569.4004">[if (HasSupportForBulkTransfers)]</text><polygon fill="#181818" points="4186.5,11616.5781,4196.5,11620.5781,4186.5,11624.5781,4190.5,11620.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="4192.5" y1="11620.5781" y2="11620.5781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="11613.7441">[73]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="3740.5" y="11613.7441">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="202" x="3808.5" y="11613.7441">inbound/bulktransfers</text><polygon fill="#181818" points="3702.5,11658.25,3692.5,11662.25,3702.5,11666.25,3698.5,11662.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3696.5" x2="4197.5" y1="11662.25" y2="11662.25"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3708.5" y="11655.416">[74]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="3750.5" y="11655.416">response</text><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="3733.5" y1="11731.5938" y2="11731.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="3733.5" x2="3733.5" y1="11731.5938" y2="11744.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="3692.5" x2="3733.5" y1="11744.5938" y2="11744.5938"/><polygon fill="#181818" points="3702.5,11740.5938,3692.5,11744.5938,3702.5,11748.5938,3698.5,11744.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="11710.9238">[75]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="267" x="3740.5" y="11697.0879">Update transaction statuses</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="284" x="3740.5" y="11724.7598">and attach transfer responses</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3567" x2="4275.5" y1="11753.5938" y2="11753.5938"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="354" x="3572" y="11776.4316">[if (!HasSupportForBulkTransfers)]</text><path d="M3577,11789.2656 L3666,11789.2656 L3666,11808.9375 L3656,11818.9375 L3577,11818.9375 L3577,11789.2656 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="208.0313" style="stroke:#000000;stroke-width:1.5;" width="688.5" x="3577" y="11789.2656"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="3592" y="11813.1035">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="435" x="3681" y="11814.1035">[X times for each transfer in bulk message]</text><polygon fill="#181818" points="4186.5,11861.2813,4196.5,11865.2813,4186.5,11869.2813,4190.5,11865.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="4192.5" y1="11865.2813" y2="11865.2813"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="11858.4473">[76]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="3740.5" y="11858.4473">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="165" x="3808.5" y="11858.4473">inbound/transfers</text><polygon fill="#181818" points="3702.5,11902.9531,3692.5,11906.9531,3702.5,11910.9531,3698.5,11906.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3696.5" x2="4197.5" y1="11906.9531" y2="11906.9531"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3708.5" y="11900.1191">[77]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="3750.5" y="11900.1191">response</text><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="3733.5" y1="11976.2969" y2="11976.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="3733.5" x2="3733.5" y1="11976.2969" y2="11989.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="3692.5" x2="3733.5" y1="11989.2969" y2="11989.2969"/><polygon fill="#181818" points="3702.5,11985.2969,3692.5,11989.2969,3702.5,11993.2969,3698.5,11989.2969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="11955.627">[78]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="244" x="3740.5" y="11941.791">Update transaction status</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="273" x="3740.5" y="11969.4629">and attach transfer response</text><line style="stroke:#181818;stroke-width:1.0;" x1="2883.5" x2="2893.5" y1="12044.9688" y2="12040.9688"/><line style="stroke:#181818;stroke-width:1.0;" x1="2883.5" x2="2893.5" y1="12044.9688" y2="12048.9688"/><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="3690.5" y1="12044.9688" y2="12044.9688"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2899.5" y="12038.1348">[79]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="2941.5" y="12038.1348">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="285" x="2993.5" y="12038.1348">/bulktransfers/{id} (BulkStatus)</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2882.5" x2="2924.5" y1="12086.6406" y2="12086.6406"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2924.5" x2="2924.5" y1="12086.6406" y2="12099.6406"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2883.5" x2="2924.5" y1="12099.6406" y2="12099.6406"/><polygon fill="#181818" points="2893.5,12095.6406,2883.5,12099.6406,2893.5,12103.6406,2889.5,12099.6406" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="12079.8066">[80]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="357" x="2931.5" y="12079.8066">Commit funds at indivial transfer level</text><path d="M2820.5,12114.6406 L2889.5,12114.6406 L2889.5,12134.3125 L2879.5,12144.3125 L2820.5,12144.3125 L2820.5,12114.6406 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="309.7188" style="stroke:#000000;stroke-width:1.5;" width="1465" x="2820.5" y="12114.6406"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="2835.5" y="12138.4785">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="326" x="2904.5" y="12139.4785">[if (bulkStatus == 'ACCEPTED')]</text><polygon fill="#181818" points="3679.5,12186.6563,3689.5,12190.6563,3679.5,12194.6563,3683.5,12190.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2882.5" x2="3685.5" y1="12190.6563" y2="12190.6563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2889.5" y="12183.8223">[81]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="77" x="2931.5" y="12183.8223">PATCH</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="360" x="3014.5" y="12183.8223">inbound/bulktransfers/{id} (BulkStatus)</text><path d="M3567,12205.6563 L3636,12205.6563 L3636,12225.3281 L3626,12235.3281 L3567,12235.3281 L3567,12205.6563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="211.7031" style="stroke:#000000;stroke-width:1.5;" width="708.5" x="3567" y="12205.6563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="3582" y="12229.4941">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="347" x="3651" y="12230.4941">[if (HasSupportForBulkTransfers)]</text><polygon fill="#181818" points="4186.5,12277.6719,4196.5,12281.6719,4186.5,12285.6719,4190.5,12281.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="4192.5" y1="12281.6719" y2="12281.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="12274.8379">[82]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="77" x="3740.5" y="12274.8379">PATCH</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="358" x="3823.5" y="12274.8379">inbound/bulktransfers/{bulkTransferId}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3567" x2="4275.5" y1="12290.6719" y2="12290.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="354" x="3572" y="12313.5098">[if (!HasSupportForBulkTransfers)]</text><path d="M3577,12326.3438 L3666,12326.3438 L3666,12346.0156 L3656,12356.0156 L3577,12356.0156 L3577,12326.3438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="84.0156" style="stroke:#000000;stroke-width:1.5;" width="688.5" x="3577" y="12326.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="44" x="3592" y="12350.1816">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="435" x="3681" y="12351.1816">[X times for each transfer in bulk message]</text><polygon fill="#181818" points="4186.5,12398.3594,4196.5,12402.3594,4186.5,12406.3594,4190.5,12402.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3691.5" x2="4192.5" y1="12402.3594" y2="12402.3594"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="3698.5" y="12395.5254">[83]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="77" x="3740.5" y="12395.5254">PATCH</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="276" x="3823.5" y="12395.5254">inbound/transfers/{transferId}</text><polygon fill="#181818" points="2071.5,12461.0313,2061.5,12465.0313,2071.5,12469.0313,2067.5,12465.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2065.5" x2="2881.5" y1="12465.0313" y2="12465.0313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2077.5" y="12458.1973">[84]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="2119.5" y="12458.1973">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="239" x="2171.5" y="12458.1973">inbound/bulktransfers/{id}</text><line style="stroke:#181818;stroke-width:1.0;" x1="2060.5" x2="2102.5" y1="12534.375" y2="12534.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="2102.5" x2="2102.5" y1="12534.375" y2="12547.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="2061.5" x2="2102.5" y1="12547.375" y2="12547.375"/><polygon fill="#181818" points="2071.5,12543.375,2061.5,12547.375,2071.5,12551.375,2067.5,12547.375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="2067.5" y="12513.7051">[85]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="244" x="2109.5" y="12499.8691">Update transaction status</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="327" x="2109.5" y="12527.541">and attach bulk transfers response</text><polygon fill="#FAFAFA" points="2075,12574.375,2924,12574.375,2934,13325.375,2924,14076.375,2075,14076.375,2065,13325.375,2075,12574.375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="233" x="2077" y="12601.2129">bulkTransferResponse</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2077" y="12628.8848">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="521" x="2083" y="12656.5566">"bulkHomeTransactionID": "UUID", # external identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="533" x="2083" y="12684.2285">"bulkTransferId": "UUID",  # generated by ML connector</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="646" x="2083" y="12711.9004">"currentState": "COMPLETED", # status of the bulk transfer request</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="274" x="2083" y="12739.5723">"individualTransferResults": [</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2101" y="12767.2441">{</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="534" x="2113" y="12794.916">"transferId": "310e5c51-e4fd-30bc-96ae-6dffee2c54cb",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="694" x="2113" y="12822.5879">"homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="809" x="2113" y="12850.2598">"transactionId": "string", # Mojaloop bulk transaction Id used to make the bulk transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="54" x="2113" y="12877.9316">"to": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="138" x="2125" y="12905.6035">"partyIdInfo": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="252" x="2137" y="12933.2754">"partyIdType": "MSISDN",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="233" x="2137" y="12960.9473">"partyIdentifier": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="279" x="2137" y="12988.6191">"partySubIdOrType": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="150" x="2137" y="13016.291">"fspId": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2137" y="13043.9629">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2125" y="13071.6348">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2113" y="13099.3066">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="232" x="2113" y="13126.9785">"amountType": "SEND",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="177" x="2113" y="13154.6504">"currency": "AED",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="157" x="2113" y="13182.3223">"amount": "100",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="144" x="2113" y="13209.9941">"note": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="523" x="2113" y="13237.666">"quoteId": "4932beab-423e-37b6-8587-49c016d2f5ef",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="512" x="2113" y="13265.3379">"quoteExtensions": [{ "key": "string", "value": "string"}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="525" x="2113" y="13293.0098">"transferExtensions": [{ "key": "string", "value": "string"}]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="187" x="2113" y="13320.6816">"quoteResponse": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="517" x="2125" y="13348.3535">"transferAmount": {"currency": "AED","amount": "0.7"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="606" x="2125" y="13376.0254">"payeeReceiveAmount": {"currency": "AED","amount": "0.922"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="502" x="2125" y="13403.6973">"payeeFspFee": {"currency": "AED","amount": "0.2"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="586" x="2125" y="13431.3691">"payeeFspCommission": {"currency": "AED","amount": "0.3"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="460" x="2125" y="13459.041">"expiration": "6286-11-29T16:19:08.300+06:14",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="506" x="2125" y="13486.7129">"geoCode": {"latitude": "5.9","longitude": "180.0000"},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="468" x="2125" y="13514.3848">"ilpPacket": "XqOB5HUGEifQ-ebr0TAVAgD3...",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="279" x="2125" y="13542.0566">"condition": "gZI4iD9u_Yc...",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2125" y="13569.7285">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="13" x="2113" y="13597.4004">},</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="73" x="2113" y="13625.0723">"fulfil": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="310" x="2125" y="13652.7441">"fulfilment": "UXgB0280lbHM...",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="521" x="2125" y="13680.416">"completedTimestamp": "5138-01-31T21:10:42.484Z",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="310" x="2125" y="13708.0879">"transferState": "COMMITTED",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2125" y="13735.7598">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2113" y="13763.4316">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="117" x="2113" y="13791.1035">"lastError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="219" x="2125" y="13818.7754">"httpStatusCode": 503,</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="173" x="2125" y="13846.4473">"mojaloopError": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="190" x="2137" y="13874.1191">"errorInformation": {</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="197" x="2149" y="13901.791">"errorCode": "8812",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="257" x="2149" y="13929.4629">"errorDescription": "string",</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="593" x="2149" y="13957.1348">"extensionList": {"extension": [{"key": "string","value": "string"}]}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2125" y="13984.8066">}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="33" x="2089" y="14012.4785">}}}],</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="449" x="2089" y="14040.1504">"extensions": [{ "key": "string", "value": "string"}]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="7" x="2077" y="14067.8223">}</text><path d="M337,14088.6563 L406,14088.6563 L406,14108.3281 L396,14118.3281 L337,14118.3281 L337,14088.6563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="488.4063" style="stroke:#000000;stroke-width:1.5;" width="1838" x="337" y="14088.6563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="352" y="14112.4941">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="179" x="421" y="14113.4941">[if (synchronous)]</text><polygon fill="#181818" points="1439.5,14160.6719,1429.5,14164.6719,1439.5,14168.6719,1435.5,14164.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1433.5" x2="2059.5" y1="14164.6719" y2="14164.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="14157.8379">[86]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="346" x="1487.5" y="14157.8379">Response &lt;bulkTransferResponse&gt;</text><polygon fill="#181818" points="807.5,14202.3438,797.5,14206.3438,807.5,14210.3438,803.5,14206.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="801.5" x2="1427.5" y1="14206.3438" y2="14206.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="14199.5098">[87]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="346" x="855.5" y="14199.5098">Response &lt;bulkTransferResponse&gt;</text><polygon fill="#181818" points="406.5,14244.0156,396.5,14248.0156,406.5,14252.0156,402.5,14248.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="400.5" x2="795.5" y1="14248.0156" y2="14248.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="412.5" y="14241.1816">[88]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="335" x="454.5" y="14241.1816">Transafer response(success &amp; fail)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="337" x2="2175" y1="14257.0156" y2="14257.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="186" x="342" y="14279.8535">[if (!synchronous)]</text><polygon fill="#181818" points="1439.5,14370.7031,1429.5,14374.7031,1439.5,14378.7031,1435.5,14374.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1433.5" x2="2059.5" y1="14374.7031" y2="14374.7031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1445.5" y="14340.1973">[89]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="185" x="1487.5" y="14312.5254">Callback Response</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1487.5" y="14340.1973">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="366" x="1539.5" y="14340.1973">inbound/bulkTransfers/{bulkTransferId}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="332" x="1487.5" y="14367.8691">Transfer Response(success &amp; fail)</text><polygon fill="#181818" points="2048.5,14412.375,2058.5,14416.375,2048.5,14420.375,2052.5,14416.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1428.5" x2="2054.5" y1="14416.375" y2="14416.375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1435.5" y="14409.541">[90]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="1477.5" y="14409.541">Receive HTTP 202 response</text><polygon fill="#181818" points="807.5,14481.7188,797.5,14485.7188,807.5,14489.7188,803.5,14485.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="801.5" x2="1427.5" y1="14485.7188" y2="14485.7188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="813.5" y="14465.0488">[91]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="855.5" y="14451.2129">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="291" x="907.5" y="14451.2129">/bulkTransfers/{bulkTransferId}</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="377" x="855.5" y="14478.8848">Transfer Status Update (success &amp; fail)</text><polygon fill="#181818" points="1416.5,14523.3906,1426.5,14527.3906,1416.5,14531.3906,1420.5,14527.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="796.5" x2="1422.5" y1="14527.3906" y2="14527.3906"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="803.5" y="14520.5566">[92]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="281" x="845.5" y="14520.5566">Receive HTTP 202 response</text><polygon fill="#181818" points="406.5,14565.0625,396.5,14569.0625,406.5,14573.0625,402.5,14569.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="400.5" x2="795.5" y1="14569.0625" y2="14569.0625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="412.5" y="14562.2285">[93]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="335" x="454.5" y="14562.2285">Transafer response(success &amp; fail)</text><!--MD5=[d6c963c12d657d52e5f6d63277f0b358]
@startuml
/'********
- - - - - - - - - - - - - -
*********'/

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
' declare title
' title Bulk Transactions pattern using the Mojaloop Connector
' declare actors
actor "MFI Staff" as MStaff
participant "MFI CBS" as MFI
box "Payment Manager" #LightGrey
participant "Core\nConnector" as MFICC 
participant "sdk-scheme-adapter" as MFIMC 
end box
participant "Mojaloop\nSwitch" as MJW 
participant "Oracle" as Oracle
box "Payment Manager" #LightGrey
participant "Payee\nsdk-scheme-adapter" as PayeeFSPMC 
participant "Payee\nCore\nConnector" as PayeeFSPCC 
end box

== Bulk Transfers implemented using Mojaloop bulk transfers ==

autonumber 1 1 "<b>[0]"
MStaff -> MFI: Initiate bulk transaction call 
MFI -> MFICC: Disburse funds \n **POST** outbound/bulkTransfers/
note left
{
   "bulkHomeTransactionID": "UUID", # external identifier
   "options": {
      "onlyValidateParty": "false", # (boolean) 
      "autoAcceptParty": {
          "enabled": "true" # boolean
      },
      "autoAcceptQuote": {
        "enabled": "true", # (boolean)
        "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
      }
      "skipPartyLookup": "false", # (boolean)
      "synchronous": "false", # (boolean)
      "bulkExpiration": DateTime, # expiration date time (string)
    },
   "from": { "partyIdInfo": {} # (partyIdInfo type)
           },                        
   "individualTransfers": [
          {
            "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
            "reference": "string", # Payer Loan reference
            "to": {
              "partyIdInfo": {
                "partyIdType": "MSISDN",
                "partyIdentifier": "string",
                "partySubIdOrType": "string",
                "fspId": "string",
                "extensionList": {"extension": [{"key": "string","value": "string"}]}
              },
            "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
            "currency" : "XXX" # (Enum)
            "amount": "100", # money (string)
            "note": "string"
            "quoteExtensions": [{ "key": "string", "value": "string"}],
            "transferExtensions": [{ "key": "string", "value": "string"}]
            }, ...
          ],
   "extensions": [{ "key": "string", "value": "string"}],
}
end note

Loop n times  (in parallel)
    hnote left of MFICC
        For each transfer
        in bulk message
    end hnote
    MFICC -> MFICC: validate MSISDN & Prefix
    alt MSISDN Failed Validation
    MFICC->MFICC:  Add Last Error to Transfer
    end
end Loop
MFICC- ->MFIMC: **POST** outbound/bulkTransfers
note left
**BulkTransferType**
{
   "bulkHomeTransactionID": "UUID", # external identifier
   "options": {
      "onlyValidateParty": "false", # (boolean) 
      "autoAcceptParty": {
          "enabled": "true" # boolean
      },
      "autoAcceptQuote": {
        "enabled": "true", # (boolean)
        "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
      }
      "skipPartyLookup": "false", # (boolean)
      "synchronous": "false", # (boolean)
      "bulkExpiration": DateTime, # expiration date time (string)
    },
   "from": { "partyIdInfo": {} # (partyIdInfo type)
           },                        
   "individualTransfers": [
          {
            "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
            "reference": "string", # Payer Loan reference
            "to": {
              "partyIdInfo": {
                "partyIdType": "MSISDN",
                "partyIdentifier": "string",
                "partySubIdOrType": "string",
                "fspId": "string",
                "extensionList": {"extension": [{"key": "string","value": "string"}]}
              },
            "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
            "currency" : "XXX" # (Enum)
            "amount": "100", # money (string)
            "note": "string"
            "quoteExtensions": [{ "key": "string", "value": "string"}],
            "transferExtensions": [{ "key": "string", "value": "string"}]
            "lastError": {
              "httpStatusCode": 503,
              "mojaloopError": {
                "errorInformation": {
                  "errorCode": "8812",
                  "errorDescription": "string",
                  "extensionList": {"extension": [{"key": "string","value": "string"}]}
                }
              }
            }, ...
          ],
   "extensions": [{ "key": "string", "value": "string"}],
}
end note
alt if (!synchronous)
MFIMC- ->MFICC: Receive HTTP 202 response
MFI <- - MFICC: Receive HTTP 202 response
end

alt if (!skipPartyLookup)
loop N times & within bulkExpiration timelimit  (in parallel)
hnote left of MFIMC
        For each transfer
        in bulk message
end hnote
  alt if (validTransfer)
    MFIMC -> MFIMC: Create TransactionId
    MFIMC -> MJW: **GET** /parties/*\n<i><PartyIdType>**/**</i><i><PartyId>
    activate MFIMC
    MJW -> Oracle: Lookup DFSP for \nrequested Type/ID
    Oracle-> Oracle: Lookup Party for \nrequested Type/ID
    Oracle->MJW: Return DFSP ID
    MJW->MJW: **GET** /parties/{type}/{id}/{subid}\nMake call to payee DFSP to confirm Party information
    MJW->MFIMC: **PUT** inbound/parties/{type}/{id}
    deactivate MFIMC
    
    MFIMC -> MFIMC: Update transaction status and\n attach get parties response
    MFIMC -> MFIMC: Add to next phase FSP bulk call
    MFIMC -> MFIMC: Any Error, save the error state in lastError object to be returned to the caller later
  else if (!validTransfer)
    MFIMC->MFIMC: Skip
  end
end Loop
else if (skipPartyLookup)
  loop N times & within bulkExpiration timelimit 
    MFIMC->MFIMC: Validate party info \n Add to next phase FSP bulk call
  end loop
end
MFIMC->MFIMC: if(transferStatusValid) Group into M Payee DFSPs

alt if (!autoAcceptParty)
  alt if (synchronous)
    MFIMC- ->MFICC: Response <bulkPartyLookupResponse> \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    MFI <- - MFICC: Response <bulkPartyLookupResponse>  \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    MFI->MStaff: Present Party Response
    MStaff->MFI: Accept Party
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
  else if (!synchronous)
    MFIMC->MFICC: **PUT** inbound/bulkTransfers/{bulkTransferId}  \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    note right
      **bulkPartyLookupResponse**
      Refer **Party Lookup Error Codes** table for lastError details
      {
        "bulkHomeTransactionID": "UUID", # external identifier,
        "bulkTransferId": "UUID",  # generated by ML connector
        "currentState": "WAITING_FOR_PARTY_ACCEPTANCE",
        "options": {
            "onlyValidateParty": "false", # (boolean) 
            "autoAcceptParty": {
                "enabled": "true" # boolean
            },
            "autoAcceptQuote": {
                "enabled": "true", # (boolean)
                "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
            }
            "skipPartyLookup": "false", # (boolean)
            "synchronous": "false", # (boolean)
            "bulkExpiration": DateTime, # expiration date time (string)
        },                      
        "individualTransferResults": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "reference": "string", # Payer Loan reference
                  "to": {
                    "partyIdInfo": {
                      "partyIdType": "MSISDN",
                      "partyIdentifier": "string",
                      "partySubIdOrType": "string",
                      "fspId": "string",
                      "extensionList": {"extension": [{"key": "string","value": "string"}]}
                    },
                  "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
                  "currency" : "XXX" # (Enum)
                  "amount": "100", # money (string)
                  "note": "string"
                  "quoteExtensions": [{ "key": "string", "value": "string"}],
                  "transferExtensions": [{ "key": "string", "value": "string"}]
                  "lastError": {
                    "httpStatusCode": 503,
                    "mojaloopError": {
                      "errorInformation": {
                        "errorCode": "8812",1
                        "errorDescription": "string",
                        "extensionList": {"extension": [{"key": "string","value": "string"}]}
                      }
                    }
                  }
                }
        ],
        "extensions": [{ "key": "string", "value": "string"}],
      }
    end note
    MFICC- ->MFIMC: Receive HTTP 202 response
    MFICC->MFI: **PUT** /bulkTransfers/{bulkTransferId}  \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    MFI- ->MFICC: Receive HTTP 202 response
    MFI->MStaff: Present Party Response
    MStaff->MFI: Accept Party
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    note left
      **bulkTransferContinuationAcceptParty**
      {
        "bulkHomeTransactionID": "UUID", # external identifier                    
        "individualTransfers": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "acceptParty": "true" # (boolean)
                }
        ],
      }
    end note    
    MFIMC- ->MFICC: Receive HTTP 202 response
    MFI <- - MFICC: Receive HTTP 202 response
  end
end

loop Quote Processing (M times & within bulkExpiration timelimit in parallel)
hnote left of MFIMC
        For each payee DFSP
        in bulk message
end hnote
    MFIMC->MFIMC: Check bulkExpiration
    MFIMC->MFIMC: Create bulkTransactionId
    MFIMC ->> MFIMC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
    MFIMC ->> MJW: **POST** /bulkquotes
    activate MFIMC
    MJW->PayeeFSPMC: **POST** inbound/bulkquotes 
    alt if (HasSupportForBulkQuotes)
      PayeeFSPMC->PayeeFSPCC: **POST** inbound/bulkquotes  
      PayeeFSPCC- ->PayeeFSPMC: Reponse bulkquotes Response
      PayeeFSPMC -> PayeeFSPMC: Update transaction statuses \nand attach quote responses
    else if (!HasSupportForBulkQuotes)
      loop X times for each transfer in bulk message
        PayeeFSPMC->PayeeFSPCC: **POST** inbound/quoterequests  
        PayeeFSPCC- ->PayeeFSPMC: response
        PayeeFSPMC -> PayeeFSPMC: Update transaction status \nand attach quote response
      end Loop
    end
    PayeeFSPMC->MJW: **PUT** /bulkquotes/{id)
    MJW->MFIMC: **PUT** inbound/bulkquotes/{id)
    deactivate  MFIMC
    MFIMC -> MFIMC: Update transaction status \nand attach quote response
end loop

alt if (!autoAcceptQuote)
  alt if (synchronous)
    MFIMC- ->MFICC: Response <bulkQuoteRequestResponse> \n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    MFI <- - MFICC: Response <bulkQuoteRequestResponse>\n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    MFI->MStaff: Present Quote Response
    MStaff->MFI: Accept Quote
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
  else if (!synchronous)
    MFIMC->MFICC: **PUT** inbound/bulkTransfers/{bulkTransferId}\n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    note right
      **bulkQuoteRequestResponse**
      {
        "bulkHomeTransactionID": "UUID", # external identifier
        "bulkTransferId": "UUID",  # generated by ML connector
        "currentState": "WAITING_FOR_QUOTE_ACCEPTANCE",
        "options": {
            "onlyValidateParty": "false", # (boolean) 
            "autoAcceptParty": {
                "enabled": "true" # boolean
            },
            "autoAcceptQuote": {
                "enabled": "true", # (boolean)
                "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
            }
            "skipPartyLookup": "false", # (boolean)
            "synchronous": "false", # (boolean)
            "bulkExpiration": DateTime, # expiration date time (string)
        },                       
        "individualTransferResults": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "reference": "string", # Payer Loan reference
                  "to": {
                    "partyIdInfo": {
                      "partyIdType": "MSISDN",
                      "partyIdentifier": "string",
                      "partySubIdOrType": "string",
                      "fspId": "string",
                      "extensionList": {"extension": [{"key": "string","value": "string"}]}
                    },
                  "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
                  "currency" : "XXX" # (Enum)
                  "amount": "100", # money (string)
                  "note": "string"
                  "quoteId": "4932beab-423e-37b6-8587-49c016d2f5ef",
                  "quoteExtensions": [{ "key": "string", "value": "string"}],
                  "transferExtensions": [{ "key": "string", "value": "string"}],
                  "quoteResponse": {
                    "transferAmount": {"currency": "AED","amount": "0.7"},
                    "payeeReceiveAmount": {"currency": "AED","amount": "0.922"},
                    "payeeFspFee": {"currency": "AED","amount": "67247160"},
                    "payeeFspCommission": {"currency": "AED","amount": "829358883"},
                    "expiration": "6286-11-29T16:19:08.300+06:14",
                    "geoCode": {"latitude": "5.9","longitude": "180.0000"},
                    "ilpPacket": "XqOB5HUGEifQ-ebr0TAVAgD3...",
                    "condition": "gZI4iD9u_Yc...",
                    "extensionList": {"extension": [{"key": "string","value": "string"}]}
                  },
                  "lastError": {
                    "httpStatusCode": 503,
                    "mojaloopError": {
                      "errorInformation": {
                        "errorCode": "8812",
                        "errorDescription": "string",
                        "extensionList": {"extension": [{"key": "string","value": "string"}]}
                      }
                    }
                  }
                }
        ],
        "extensions": [{ "key": "string", "value": "string"}],
      }
    end note
    MFICC- ->MFIMC: Receive HTTP 202 response
    MFICC->MFI: **PUT** /bulkTransfers/{bulkTransferId}\n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    MFI- ->MFICC: Receive HTTP 202 response
    MFI->MStaff: Present Quote Response
    MStaff->MFI: Accept Quote
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    note left
      **bulkAcceptQuote**
      {
        "bulkHomeTransactionID": "UUID", # external identifier
        "individualTransfers": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "acceptQuote": "true" #boolean
                }                  
        ],
      }
    end note    

    MFIMC- ->MFICC: Receive HTTP 202 response
    MFI <- - MFICC: Receive HTTP 202 response
  end
end


loop Transfer Processing (M times & within bulkExpiration timelimit  in parallel)
  hnote left of MFIMC
        For each payee DFSP
        in bulk message
  end hnote
    alt if (AutoAcceptQuote)
      MFIMC -> MFIMC: Confirm Fees meets auto accept levels\n and bulkExpiration timelimit not reached \n-> Update Transfer Status
    end
 
    alt if (AcceptedQuote)
    MFIMC ->> MFIMC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
    MFIMC ->> MJW: **POST** /bulktransfers
    activate MFIMC
    MJW-> MJW: Perform liquidity(NDC)check at indivial transfer level
    MJW->MJW: Reserve Funds at indivial transfer level
    MJW ->> PayeeFSPMC: **POST** inbound/bulktransfers
    alt if (HasSupportForBulkTransfers)
      PayeeFSPMC->PayeeFSPCC: **POST** inbound/bulktransfers  
      PayeeFSPCC- ->PayeeFSPMC: response
      PayeeFSPMC -> PayeeFSPMC:Update transaction statuses \nand attach transfer responses
    else if (!HasSupportForBulkTransfers)
      loop X times for each transfer in bulk message
        PayeeFSPMC->PayeeFSPCC: **POST** inbound/transfers  
        PayeeFSPCC- ->PayeeFSPMC: response
        PayeeFSPMC -> PayeeFSPMC:Update transaction status \nand attach transfer response
      end Loop
    end
    PayeeFSPMC ->> MJW: **PUT** /bulktransfers/{id} (BulkStatus)
    MJW- ->MJW: Commit funds at indivial transfer level
    alt if (bulkStatus == 'ACCEPTED')
    MJW -> PayeeFSPMC: **PATCH** inbound/bulktransfers/{id} (BulkStatus)
    alt if (HasSupportForBulkTransfers)
      PayeeFSPMC->PayeeFSPCC: **PATCH** inbound/bulktransfers/{bulkTransferId}  
    else if (!HasSupportForBulkTransfers)
      loop X times for each transfer in bulk message
        PayeeFSPMC->PayeeFSPCC: **PATCH** inbound/transfers/{transferId}  
      end Loop
    end
    end
    MJW->MFIMC:**PUT** inbound/bulktransfers/{id}
   
    deactivate MFIMC 
    MFIMC -> MFIMC: Update transaction status \nand attach bulk transfers response
    end
end loop
hnote right MFIMC
**bulkTransferResponse**
{
 "bulkHomeTransactionID": "UUID", # external identifier
 "bulkTransferId": "UUID",  # generated by ML connector
 "currentState": "COMPLETED", # status of the bulk transfer request
 "individualTransferResults": [
    {
      "transferId": "310e5c51-e4fd-30bc-96ae-6dffee2c54cb",
      "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
      "transactionId": "string", # Mojaloop bulk transaction Id used to make the bulk transfer
      "to": {
        "partyIdInfo": {
          "partyIdType": "MSISDN",
          "partyIdentifier": "string",
          "partySubIdOrType": "string",
          "fspId": "string",
          "extensionList": {"extension": [{"key": "string","value": "string"}]}
        }
      },
      "amountType": "SEND",
      "currency": "AED",
      "amount": "100",
      "note": "string",
      "quoteId": "4932beab-423e-37b6-8587-49c016d2f5ef",
      "quoteExtensions": [{ "key": "string", "value": "string"}],
      "transferExtensions": [{ "key": "string", "value": "string"}]
      "quoteResponse": {
        "transferAmount": {"currency": "AED","amount": "0.7"},
        "payeeReceiveAmount": {"currency": "AED","amount": "0.922"},
        "payeeFspFee": {"currency": "AED","amount": "0.2"},
        "payeeFspCommission": {"currency": "AED","amount": "0.3"},
        "expiration": "6286-11-29T16:19:08.300+06:14",
        "geoCode": {"latitude": "5.9","longitude": "180.0000"},
        "ilpPacket": "XqOB5HUGEifQ-ebr0TAVAgD3...",
        "condition": "gZI4iD9u_Yc...",
        "extensionList": {"extension": [{"key": "string","value": "string"}]}
      },
      "fulfil": {
        "fulfilment": "UXgB0280lbHM...",
        "completedTimestamp": "5138-01-31T21:10:42.484Z",
        "transferState": "COMMITTED",
        "extensionList": {"extension": [{"key": "string","value": "string"}]}
      }
      "lastError": {
        "httpStatusCode": 503,
        "mojaloopError": {
          "errorInformation": {
            "errorCode": "8812",
            "errorDescription": "string",
            "extensionList": {"extension": [{"key": "string","value": "string"}]}
        }
  }}}],
  "extensions": [{ "key": "string", "value": "string"}]
} 
end hnote    
alt if (synchronous)
    MFIMC->MFICC: Response <bulkTransferResponse>
    MFICC->MFI: Response <bulkTransferResponse>
    MFI->MStaff: Transafer response(success & fail)
else if (!synchronous)
    MFIMC->MFICC:Callback Response \n**PUT** inbound/bulkTransfers/{bulkTransferId}\nTransfer Response(success & fail)
    MFICC- ->MFIMC: Receive HTTP 202 response
    MFICC->MFI: **PUT** /bulkTransfers/{bulkTransferId}\nTransfer Status Update (success & fail)
    MFI- ->MFICC: Receive HTTP 202 response
    MFI->MStaff: Transafer response(success & fail)
end
@enduml

@startuml

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
actor "MFI Staff" as MStaff
participant "MFI CBS" as MFI
box "Payment Manager" #LightGrey
participant "Core\nConnector" as MFICC 
participant "sdk-scheme-adapter" as MFIMC 
end box
participant "Mojaloop\nSwitch" as MJW 
participant "Oracle" as Oracle
box "Payment Manager" #LightGrey
participant "Payee\nsdk-scheme-adapter" as PayeeFSPMC 
participant "Payee\nCore\nConnector" as PayeeFSPCC 
end box

== Bulk Transfers implemented using Mojaloop bulk transfers ==

autonumber 1 1 "<b>[0]"
MStaff -> MFI: Initiate bulk transaction call 
MFI -> MFICC: Disburse funds \n **POST** outbound/bulkTransfers/
note left
{
   "bulkHomeTransactionID": "UUID", # external identifier
   "options": {
      "onlyValidateParty": "false", # (boolean) 
      "autoAcceptParty": {
          "enabled": "true" # boolean
      },
      "autoAcceptQuote": {
        "enabled": "true", # (boolean)
        "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
      }
      "skipPartyLookup": "false", # (boolean)
      "synchronous": "false", # (boolean)
      "bulkExpiration": DateTime, # expiration date time (string)
    },
   "from": { "partyIdInfo": {} # (partyIdInfo type)
           },                        
   "individualTransfers": [
          {
            "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
            "reference": "string", # Payer Loan reference
            "to": {
              "partyIdInfo": {
                "partyIdType": "MSISDN",
                "partyIdentifier": "string",
                "partySubIdOrType": "string",
                "fspId": "string",
                "extensionList": {"extension": [{"key": "string","value": "string"}]}
              },
            "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
            "currency" : "XXX" # (Enum)
            "amount": "100", # money (string)
            "note": "string"
            "quoteExtensions": [{ "key": "string", "value": "string"}],
            "transferExtensions": [{ "key": "string", "value": "string"}]
            }, ...
          ],
   "extensions": [{ "key": "string", "value": "string"}],
}
end note

Loop n times  (in parallel)
    hnote left of MFICC
        For each transfer
        in bulk message
    end hnote
    MFICC -> MFICC: validate MSISDN & Prefix
    alt MSISDN Failed Validation
    MFICC->MFICC:  Add Last Error to Transfer
    end
end Loop
MFICC- ->MFIMC: **POST** outbound/bulkTransfers
note left
**BulkTransferType**
{
   "bulkHomeTransactionID": "UUID", # external identifier
   "options": {
      "onlyValidateParty": "false", # (boolean) 
      "autoAcceptParty": {
          "enabled": "true" # boolean
      },
      "autoAcceptQuote": {
        "enabled": "true", # (boolean)
        "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
      }
      "skipPartyLookup": "false", # (boolean)
      "synchronous": "false", # (boolean)
      "bulkExpiration": DateTime, # expiration date time (string)
    },
   "from": { "partyIdInfo": {} # (partyIdInfo type)
           },                        
   "individualTransfers": [
          {
            "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
            "reference": "string", # Payer Loan reference
            "to": {
              "partyIdInfo": {
                "partyIdType": "MSISDN",
                "partyIdentifier": "string",
                "partySubIdOrType": "string",
                "fspId": "string",
                "extensionList": {"extension": [{"key": "string","value": "string"}]}
              },
            "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
            "currency" : "XXX" # (Enum)
            "amount": "100", # money (string)
            "note": "string"
            "quoteExtensions": [{ "key": "string", "value": "string"}],
            "transferExtensions": [{ "key": "string", "value": "string"}]
            "lastError": {
              "httpStatusCode": 503,
              "mojaloopError": {
                "errorInformation": {
                  "errorCode": "8812",
                  "errorDescription": "string",
                  "extensionList": {"extension": [{"key": "string","value": "string"}]}
                }
              }
            }, ...
          ],
   "extensions": [{ "key": "string", "value": "string"}],
}
end note
alt if (!synchronous)
MFIMC- ->MFICC: Receive HTTP 202 response
MFI <- - MFICC: Receive HTTP 202 response
end

alt if (!skipPartyLookup)
loop N times & within bulkExpiration timelimit  (in parallel)
hnote left of MFIMC
        For each transfer
        in bulk message
end hnote
  alt if (validTransfer)
    MFIMC -> MFIMC: Create TransactionId
    MFIMC -> MJW: **GET** /parties/*\n<i><PartyIdType>**/**</i><i><PartyId>
    activate MFIMC
    MJW -> Oracle: Lookup DFSP for \nrequested Type/ID
    Oracle-> Oracle: Lookup Party for \nrequested Type/ID
    Oracle->MJW: Return DFSP ID
    MJW->MJW: **GET** /parties/{type}/{id}/{subid}\nMake call to payee DFSP to confirm Party information
    MJW->MFIMC: **PUT** inbound/parties/{type}/{id}
    deactivate MFIMC
    
    MFIMC -> MFIMC: Update transaction status and\n attach get parties response
    MFIMC -> MFIMC: Add to next phase FSP bulk call
    MFIMC -> MFIMC: Any Error, save the error state in lastError object to be returned to the caller later
  else if (!validTransfer)
    MFIMC->MFIMC: Skip
  end
end Loop
else if (skipPartyLookup)
  loop N times & within bulkExpiration timelimit 
    MFIMC->MFIMC: Validate party info \n Add to next phase FSP bulk call
  end loop
end
MFIMC->MFIMC: if(transferStatusValid) Group into M Payee DFSPs

alt if (!autoAcceptParty)
  alt if (synchronous)
    MFIMC- ->MFICC: Response <bulkPartyLookupResponse> \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    MFI <- - MFICC: Response <bulkPartyLookupResponse>  \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    MFI->MStaff: Present Party Response
    MStaff->MFI: Accept Party
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
  else if (!synchronous)
    MFIMC->MFICC: **PUT** inbound/bulkTransfers/{bulkTransferId}  \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    note right
      **bulkPartyLookupResponse**
      Refer **Party Lookup Error Codes** table for lastError details
      {
        "bulkHomeTransactionID": "UUID", # external identifier,
        "bulkTransferId": "UUID",  # generated by ML connector
        "currentState": "WAITING_FOR_PARTY_ACCEPTANCE",
        "options": {
            "onlyValidateParty": "false", # (boolean) 
            "autoAcceptParty": {
                "enabled": "true" # boolean
            },
            "autoAcceptQuote": {
                "enabled": "true", # (boolean)
                "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
            }
            "skipPartyLookup": "false", # (boolean)
            "synchronous": "false", # (boolean)
            "bulkExpiration": DateTime, # expiration date time (string)
        },                      
        "individualTransferResults": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "reference": "string", # Payer Loan reference
                  "to": {
                    "partyIdInfo": {
                      "partyIdType": "MSISDN",
                      "partyIdentifier": "string",
                      "partySubIdOrType": "string",
                      "fspId": "string",
                      "extensionList": {"extension": [{"key": "string","value": "string"}]}
                    },
                  "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
                  "currency" : "XXX" # (Enum)
                  "amount": "100", # money (string)
                  "note": "string"
                  "quoteExtensions": [{ "key": "string", "value": "string"}],
                  "transferExtensions": [{ "key": "string", "value": "string"}]
                  "lastError": {
                    "httpStatusCode": 503,
                    "mojaloopError": {
                      "errorInformation": {
                        "errorCode": "8812",1
                        "errorDescription": "string",
                        "extensionList": {"extension": [{"key": "string","value": "string"}]}
                      }
                    }
                  }
                }
        ],
        "extensions": [{ "key": "string", "value": "string"}],
      }
    end note
    MFICC- ->MFIMC: Receive HTTP 202 response
    MFICC->MFI: **PUT** /bulkTransfers/{bulkTransferId}  \n  currentState="WAITING_FOR_PARTY_ACCEPTANCE"
    MFI- ->MFICC: Receive HTTP 202 response
    MFI->MStaff: Present Party Response
    MStaff->MFI: Accept Party
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    note left
      **bulkTransferContinuationAcceptParty**
      {
        "bulkHomeTransactionID": "UUID", # external identifier                    
        "individualTransfers": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "acceptParty": "true" # (boolean)
                }
        ],
      }
    end note    
    MFIMC- ->MFICC: Receive HTTP 202 response
    MFI <- - MFICC: Receive HTTP 202 response
  end
end

loop Quote Processing (M times & within bulkExpiration timelimit in parallel)
hnote left of MFIMC
        For each payee DFSP
        in bulk message
end hnote
    MFIMC->MFIMC: Check bulkExpiration
    MFIMC->MFIMC: Create bulkTransactionId
    MFIMC ->> MFIMC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
    MFIMC ->> MJW: **POST** /bulkquotes
    activate MFIMC
    MJW->PayeeFSPMC: **POST** inbound/bulkquotes 
    alt if (HasSupportForBulkQuotes)
      PayeeFSPMC->PayeeFSPCC: **POST** inbound/bulkquotes  
      PayeeFSPCC- ->PayeeFSPMC: Reponse bulkquotes Response
      PayeeFSPMC -> PayeeFSPMC: Update transaction statuses \nand attach quote responses
    else if (!HasSupportForBulkQuotes)
      loop X times for each transfer in bulk message
        PayeeFSPMC->PayeeFSPCC: **POST** inbound/quoterequests  
        PayeeFSPCC- ->PayeeFSPMC: response
        PayeeFSPMC -> PayeeFSPMC: Update transaction status \nand attach quote response
      end Loop
    end
    PayeeFSPMC->MJW: **PUT** /bulkquotes/{id)
    MJW->MFIMC: **PUT** inbound/bulkquotes/{id)
    deactivate  MFIMC
    MFIMC -> MFIMC: Update transaction status \nand attach quote response
end loop

alt if (!autoAcceptQuote)
  alt if (synchronous)
    MFIMC- ->MFICC: Response <bulkQuoteRequestResponse> \n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    MFI <- - MFICC: Response <bulkQuoteRequestResponse>\n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    MFI->MStaff: Present Quote Response
    MStaff->MFI: Accept Quote
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
  else if (!synchronous)
    MFIMC->MFICC: **PUT** inbound/bulkTransfers/{bulkTransferId}\n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    note right
      **bulkQuoteRequestResponse**
      {
        "bulkHomeTransactionID": "UUID", # external identifier
        "bulkTransferId": "UUID",  # generated by ML connector
        "currentState": "WAITING_FOR_QUOTE_ACCEPTANCE",
        "options": {
            "onlyValidateParty": "false", # (boolean) 
            "autoAcceptParty": {
                "enabled": "true" # boolean
            },
            "autoAcceptQuote": {
                "enabled": "true", # (boolean)
                "perTransferFeeLimits": [{ "currency": "AED", "amount": "1.69" }], #optional
            }
            "skipPartyLookup": "false", # (boolean)
            "synchronous": "false", # (boolean)
            "bulkExpiration": DateTime, # expiration date time (string)
        },                       
        "individualTransferResults": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "reference": "string", # Payer Loan reference
                  "to": {
                    "partyIdInfo": {
                      "partyIdType": "MSISDN",
                      "partyIdentifier": "string",
                      "partySubIdOrType": "string",
                      "fspId": "string",
                      "extensionList": {"extension": [{"key": "string","value": "string"}]}
                    },
                  "amountType": "RECEIVE" # SEND, RECEIVE (Enum)
                  "currency" : "XXX" # (Enum)
                  "amount": "100", # money (string)
                  "note": "string"
                  "quoteId": "4932beab-423e-37b6-8587-49c016d2f5ef",
                  "quoteExtensions": [{ "key": "string", "value": "string"}],
                  "transferExtensions": [{ "key": "string", "value": "string"}],
                  "quoteResponse": {
                    "transferAmount": {"currency": "AED","amount": "0.7"},
                    "payeeReceiveAmount": {"currency": "AED","amount": "0.922"},
                    "payeeFspFee": {"currency": "AED","amount": "67247160"},
                    "payeeFspCommission": {"currency": "AED","amount": "829358883"},
                    "expiration": "6286-11-29T16:19:08.300+06:14",
                    "geoCode": {"latitude": "5.9","longitude": "180.0000"},
                    "ilpPacket": "XqOB5HUGEifQ-ebr0TAVAgD3...",
                    "condition": "gZI4iD9u_Yc...",
                    "extensionList": {"extension": [{"key": "string","value": "string"}]}
                  },
                  "lastError": {
                    "httpStatusCode": 503,
                    "mojaloopError": {
                      "errorInformation": {
                        "errorCode": "8812",
                        "errorDescription": "string",
                        "extensionList": {"extension": [{"key": "string","value": "string"}]}
                      }
                    }
                  }
                }
        ],
        "extensions": [{ "key": "string", "value": "string"}],
      }
    end note
    MFICC- ->MFIMC: Receive HTTP 202 response
    MFICC->MFI: **PUT** /bulkTransfers/{bulkTransferId}\n  currentState="WAITING_FOR_QUOTE_ACCEPTANCE"
    MFI- ->MFICC: Receive HTTP 202 response
    MFI->MStaff: Present Quote Response
    MStaff->MFI: Accept Quote
    MFI->MFICC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    MFICC->MFIMC: **PUT** outbound/bulkTransfers/{bulkTransferId}
    note left
      **bulkAcceptQuote**
      {
        "bulkHomeTransactionID": "UUID", # external identifier
        "individualTransfers": [
                {
                  "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
                  "transactionId": "UUID", # Created by ML connector
                  "acceptQuote": "true" #boolean
                }                  
        ],
      }
    end note    

    MFIMC- ->MFICC: Receive HTTP 202 response
    MFI <- - MFICC: Receive HTTP 202 response
  end
end


loop Transfer Processing (M times & within bulkExpiration timelimit  in parallel)
  hnote left of MFIMC
        For each payee DFSP
        in bulk message
  end hnote
    alt if (AutoAcceptQuote)
      MFIMC -> MFIMC: Confirm Fees meets auto accept levels\n and bulkExpiration timelimit not reached \n-> Update Transfer Status
    end
 
    alt if (AcceptedQuote)
    MFIMC ->> MFIMC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
    MFIMC ->> MJW: **POST** /bulktransfers
    activate MFIMC
    MJW-> MJW: Perform liquidity(NDC)check at indivial transfer level
    MJW->MJW: Reserve Funds at indivial transfer level
    MJW ->> PayeeFSPMC: **POST** inbound/bulktransfers
    alt if (HasSupportForBulkTransfers)
      PayeeFSPMC->PayeeFSPCC: **POST** inbound/bulktransfers  
      PayeeFSPCC- ->PayeeFSPMC: response
      PayeeFSPMC -> PayeeFSPMC:Update transaction statuses \nand attach transfer responses
    else if (!HasSupportForBulkTransfers)
      loop X times for each transfer in bulk message
        PayeeFSPMC->PayeeFSPCC: **POST** inbound/transfers  
        PayeeFSPCC- ->PayeeFSPMC: response
        PayeeFSPMC -> PayeeFSPMC:Update transaction status \nand attach transfer response
      end Loop
    end
    PayeeFSPMC ->> MJW: **PUT** /bulktransfers/{id} (BulkStatus)
    MJW- ->MJW: Commit funds at indivial transfer level
    alt if (bulkStatus == 'ACCEPTED')
    MJW -> PayeeFSPMC: **PATCH** inbound/bulktransfers/{id} (BulkStatus)
    alt if (HasSupportForBulkTransfers)
      PayeeFSPMC->PayeeFSPCC: **PATCH** inbound/bulktransfers/{bulkTransferId}  
    else if (!HasSupportForBulkTransfers)
      loop X times for each transfer in bulk message
        PayeeFSPMC->PayeeFSPCC: **PATCH** inbound/transfers/{transferId}  
      end Loop
    end
    end
    MJW->MFIMC:**PUT** inbound/bulktransfers/{id}
   
    deactivate MFIMC 
    MFIMC -> MFIMC: Update transaction status \nand attach bulk transfers response
    end
end loop
hnote right MFIMC
**bulkTransferResponse**
{
 "bulkHomeTransactionID": "UUID", # external identifier
 "bulkTransferId": "UUID",  # generated by ML connector
 "currentState": "COMPLETED", # status of the bulk transfer request
 "individualTransferResults": [
    {
      "transferId": "310e5c51-e4fd-30bc-96ae-6dffee2c54cb",
      "homeTransactionId": "UUID", # Payer DFSP CBS Transaction identifier
      "transactionId": "string", # Mojaloop bulk transaction Id used to make the bulk transfer
      "to": {
        "partyIdInfo": {
          "partyIdType": "MSISDN",
          "partyIdentifier": "string",
          "partySubIdOrType": "string",
          "fspId": "string",
          "extensionList": {"extension": [{"key": "string","value": "string"}]}
        }
      },
      "amountType": "SEND",
      "currency": "AED",
      "amount": "100",
      "note": "string",
      "quoteId": "4932beab-423e-37b6-8587-49c016d2f5ef",
      "quoteExtensions": [{ "key": "string", "value": "string"}],
      "transferExtensions": [{ "key": "string", "value": "string"}]
      "quoteResponse": {
        "transferAmount": {"currency": "AED","amount": "0.7"},
        "payeeReceiveAmount": {"currency": "AED","amount": "0.922"},
        "payeeFspFee": {"currency": "AED","amount": "0.2"},
        "payeeFspCommission": {"currency": "AED","amount": "0.3"},
        "expiration": "6286-11-29T16:19:08.300+06:14",
        "geoCode": {"latitude": "5.9","longitude": "180.0000"},
        "ilpPacket": "XqOB5HUGEifQ-ebr0TAVAgD3...",
        "condition": "gZI4iD9u_Yc...",
        "extensionList": {"extension": [{"key": "string","value": "string"}]}
      },
      "fulfil": {
        "fulfilment": "UXgB0280lbHM...",
        "completedTimestamp": "5138-01-31T21:10:42.484Z",
        "transferState": "COMMITTED",
        "extensionList": {"extension": [{"key": "string","value": "string"}]}
      }
      "lastError": {
        "httpStatusCode": 503,
        "mojaloopError": {
          "errorInformation": {
            "errorCode": "8812",
            "errorDescription": "string",
            "extensionList": {"extension": [{"key": "string","value": "string"}]}
        }
  }}}],
  "extensions": [{ "key": "string", "value": "string"}]
} 
end hnote    
alt if (synchronous)
    MFIMC->MFICC: Response <bulkTransferResponse>
    MFICC->MFI: Response <bulkTransferResponse>
    MFI->MStaff: Transafer response(success & fail)
else if (!synchronous)
    MFIMC->MFICC:Callback Response \n**PUT** inbound/bulkTransfers/{bulkTransferId}\nTransfer Response(success & fail)
    MFICC- ->MFIMC: Receive HTTP 202 response
    MFICC->MFI: **PUT** /bulkTransfers/{bulkTransferId}\nTransfer Status Update (success & fail)
    MFI- ->MFICC: Receive HTTP 202 response
    MFI->MStaff: Transafer response(success & fail)
end
@enduml

PlantUML version 1.2022.6(Tue Jun 21 18:34:49 BST 2022)
(GPLV2 source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: GB
--></g></svg>