<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1764px" preserveAspectRatio="none" style="width:1925px;height:1764px;background:#FFFFFF;" version="1.1" viewBox="0 0 1925 1764" width="1925px" zoomAndPan="magnify"><defs/><g><rect fill="#D3D3D3" height="1752.5469" style="stroke:#181818;stroke-width:0.5;" width="390.5" x="793.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="182" x="897.75" y="28.8379">Payment Manager</text><rect fill="#FFFFFF" height="1098.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1061.5" y="331.375"/><rect height="181.3594" style="stroke:#000000;stroke-width:1.5;fill:none;" width="455" x="10" y="1486.8438"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="130" x2="130" y1="108.0156" y2="1685.2031"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="854.5" x2="854.5" y1="108.0156" y2="1685.2031"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1066" x2="1066" y1="108.0156" y2="1685.2031"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1436.5" x2="1436.5" y1="108.0156" y2="1685.2031"/><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221" x="20" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="207" x="27" y="95.1816">Core banking solution</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221" x="20" y="1684.2031"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="207" x="27" y="1714.041">Core banking solution</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="797.5" y="37.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="830.5" y="67.5098">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="804.5" y="95.1816">Connector</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="797.5" y="1684.2031"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="48" x="830.5" y="1714.041">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="100" x="804.5" y="1741.7129">Connector</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="953" y="65.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="213" x="960" y="95.1816">SDK Scheme Adapter</text><rect fill="#E3E3E3" height="41.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="953" y="1684.2031"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="213" x="960" y="1714.041">SDK Scheme Adapter</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="1384.5" y="37.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1391.5" y="67.5098">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="1405" y="95.1816">Switch</text><rect fill="#E3E3E3" height="69.3438" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="1384.5" y="1684.2031"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1391.5" y="1714.041">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="63" x="1405" y="1741.7129">Switch</text><rect fill="#FFFFFF" height="1098.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1061.5" y="331.375"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1918.5" x="0" y="144.8516"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1918.5" y1="144.8516" y2="144.8516"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1918.5" y1="147.8516" y2="147.8516"/><rect fill="#EEEEEE" height="35.6719" style="stroke:#000000;stroke-width:2.0;" width="584" x="667.25" y="128.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="564" x="673.25" y="154.8535">Payer DFSP integration - 2 phase commit - single phase</text><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="172.5" y1="207.3594" y2="207.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="172.5" x2="172.5" y1="207.3594" y2="220.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="172.5" y1="220.3594" y2="220.3594"/><polygon fill="#181818" points="141.5,216.3594,131.5,220.3594,141.5,224.3594,137.5,220.3594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="137.5" y="200.5254">[1]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="139" x="167.5" y="200.5254">Reserve funds</text><polygon fill="#181818" points="842.5,285.7031,852.5,289.7031,842.5,293.7031,846.5,289.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="848.5" y1="289.7031" y2="289.7031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="137.5" y="269.0332">[2]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="167.5" y="255.1973">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="118" x="235.5" y="255.1973">/sendMoney</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="670" x="167.5" y="282.8691">(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true)</text><polygon fill="#181818" points="1049.5,327.375,1059.5,331.375,1049.5,335.375,1053.5,331.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="854.5" x2="1055.5" y1="331.375" y2="331.375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="861.5" y="324.541">[3]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="891.5" y="324.541">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="959.5" y="324.541">/transfers</text><polygon fill="#181818" points="1424.5,369.0469,1434.5,373.0469,1424.5,377.0469,1428.5,373.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1071.5" x2="1430.5" y1="373.0469" y2="373.0469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1078.5" y="366.2129">[4]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="1108.5" y="366.2129">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="258" x="1161.5" y="366.2129">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#181818" points="1082.5,410.7188,1072.5,414.7188,1082.5,418.7188,1078.5,414.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1076.5" x2="1435.5" y1="414.7188" y2="414.7188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1088.5" y="407.8848">[5]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="196" x="1118.5" y="407.8848">HTTP 202 response</text><line style="stroke:#181818;stroke-width:1.0;" x1="1436.5" x2="1478.5" y1="456.3906" y2="456.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1478.5" x2="1478.5" y1="456.3906" y2="469.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1437.5" x2="1478.5" y1="469.3906" y2="469.3906"/><polygon fill="#181818" points="1447.5,465.3906,1437.5,469.3906,1447.5,473.3906,1443.5,469.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1443.5" y="449.5566">[6]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="353" x="1473.5" y="449.5566">Determine Payee DFSP using oracle</text><line style="stroke:#181818;stroke-width:1.0;" x1="1436.5" x2="1478.5" y1="538.7344" y2="538.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1478.5" x2="1478.5" y1="538.7344" y2="551.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1437.5" x2="1478.5" y1="551.7344" y2="551.7344"/><polygon fill="#181818" points="1447.5,547.7344,1437.5,551.7344,1447.5,555.7344,1443.5,551.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1443.5" y="518.0645">[7]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="438" x="1473.5" y="504.2285">Lookup Payee Information from Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="50" x="1479.5" y="531.9004">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="47" x="1535.5" y="531.9004">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="71" x="1588.5" y="531.9004">/parties</text><polygon fill="#181818" points="1082.5,589.4063,1072.5,593.4063,1082.5,597.4063,1078.5,593.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1076.5" x2="1435.5" y1="593.4063" y2="593.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1088.5" y="586.5723">[8]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1118.5" y="586.5723">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="258" x="1170.5" y="586.5723">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#181818" points="1424.5,631.0781,1434.5,635.0781,1424.5,639.0781,1428.5,635.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1071.5" x2="1430.5" y1="635.0781" y2="635.0781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1078.5" y="628.2441">[9]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="1108.5" y="628.2441">HTTP 200 Response</text><rect fill="#FAFAFA" height="35" style="stroke:#181818;stroke-width:0.5;" width="132" x="924" y="648.0781"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="124" x="928" y="674.916">Accept Party</text><polygon fill="#181818" points="1424.5,718.4219,1434.5,722.4219,1424.5,726.4219,1428.5,722.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1071.5" x2="1430.5" y1="722.4219" y2="722.4219"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1078.5" y="715.5879">[10]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1120.5" y="715.5879">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="71" x="1188.5" y="715.5879">/quotes</text><polygon fill="#181818" points="1082.5,760.0938,1072.5,764.0938,1082.5,768.0938,1078.5,764.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1076.5" x2="1435.5" y1="764.0938" y2="764.0938"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1088.5" y="757.2598">[11]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="196" x="1130.5" y="757.2598">HTTP 202 response</text><line style="stroke:#181818;stroke-width:1.0;" x1="1436.5" x2="1478.5" y1="833.4375" y2="833.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="1478.5" x2="1478.5" y1="833.4375" y2="846.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="1437.5" x2="1478.5" y1="846.4375" y2="846.4375"/><polygon fill="#181818" points="1447.5,842.4375,1437.5,846.4375,1447.5,850.4375,1443.5,846.4375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1443.5" y="812.7676">[12]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="297" x="1485.5" y="798.9316">Pass on quote to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="50" x="1491.5" y="826.6035">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1547.5" y="826.6035">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="71" x="1615.5" y="826.6035">/quotes</text><polygon fill="#181818" points="1082.5,884.1094,1072.5,888.1094,1082.5,892.1094,1078.5,888.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1076.5" x2="1435.5" y1="888.1094" y2="888.1094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1088.5" y="881.2754">[13]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1130.5" y="881.2754">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="109" x="1182.5" y="881.2754">/quotes/{Id}</text><polygon fill="#181818" points="1424.5,925.7813,1434.5,929.7813,1424.5,933.7813,1428.5,929.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1071.5" x2="1430.5" y1="929.7813" y2="929.7813"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1078.5" y="922.9473">[14]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="1120.5" y="922.9473">HTTP 200 Response</text><rect fill="#FAFAFA" height="35" style="stroke:#181818;stroke-width:0.5;" width="140" x="916" y="942.7813"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="132" x="920" y="969.6191">Accept Quote</text><polygon fill="#181818" points="1424.5,1013.125,1434.5,1017.125,1424.5,1021.125,1428.5,1017.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1071.5" x2="1430.5" y1="1017.125" y2="1017.125"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1078.5" y="1010.291">[15]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1120.5" y="1010.291">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1188.5" y="1010.291">/transfers</text><polygon fill="#181818" points="1082.5,1054.7969,1072.5,1058.7969,1082.5,1062.7969,1078.5,1058.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1076.5" x2="1435.5" y1="1058.7969" y2="1058.7969"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1088.5" y="1051.9629">[16]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="196" x="1130.5" y="1051.9629">HTTP 202 response</text><line style="stroke:#181818;stroke-width:1.0;" x1="1436.5" x2="1478.5" y1="1100.4688" y2="1100.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="1478.5" x2="1478.5" y1="1100.4688" y2="1113.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="1437.5" x2="1478.5" y1="1113.4688" y2="1113.4688"/><polygon fill="#181818" points="1447.5,1109.4688,1437.5,1113.4688,1447.5,1117.4688,1443.5,1113.4688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1443.5" y="1093.6348">[17]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="267" x="1485.5" y="1093.6348">Reserve Payer DFSP funds</text><line style="stroke:#181818;stroke-width:1.0;" x1="1436.5" x2="1478.5" y1="1182.8125" y2="1182.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1478.5" x2="1478.5" y1="1182.8125" y2="1195.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1437.5" x2="1478.5" y1="1195.8125" y2="1195.8125"/><polygon fill="#181818" points="1447.5,1191.8125,1437.5,1195.8125,1447.5,1199.8125,1443.5,1195.8125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1443.5" y="1162.1426">[18]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="316" x="1485.5" y="1148.3066">Pass on transfer to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="50" x="1491.5" y="1175.9785">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1547.5" y="1175.9785">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="90" x="1615.5" y="1175.9785">/transfers</text><line style="stroke:#181818;stroke-width:1.0;" x1="1436.5" x2="1478.5" y1="1237.4844" y2="1237.4844"/><line style="stroke:#181818;stroke-width:1.0;" x1="1478.5" x2="1478.5" y1="1237.4844" y2="1250.4844"/><line style="stroke:#181818;stroke-width:1.0;" x1="1437.5" x2="1478.5" y1="1250.4844" y2="1250.4844"/><polygon fill="#181818" points="1447.5,1246.4844,1437.5,1250.4844,1447.5,1254.4844,1443.5,1250.4844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1443.5" y="1230.6504">[19]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="136" x="1485.5" y="1230.6504">Calculate fees</text><line style="stroke:#181818;stroke-width:1.0;" x1="1436.5" x2="1478.5" y1="1292.1563" y2="1292.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1478.5" x2="1478.5" y1="1292.1563" y2="1305.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1437.5" x2="1478.5" y1="1305.1563" y2="1305.1563"/><polygon fill="#181818" points="1447.5,1301.1563,1437.5,1305.1563,1447.5,1309.1563,1443.5,1305.1563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1443.5" y="1285.3223">[20]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="262" x="1485.5" y="1285.3223">Commit Payer DFSP funds</text><polygon fill="#181818" points="1082.5,1342.8281,1072.5,1346.8281,1082.5,1350.8281,1078.5,1346.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1076.5" x2="1435.5" y1="1346.8281" y2="1346.8281"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1088.5" y="1339.9941">[21]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1130.5" y="1339.9941">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="128" x="1182.5" y="1339.9941">/transfers/{Id}</text><polygon fill="#181818" points="1424.5,1384.5,1434.5,1388.5,1424.5,1392.5,1428.5,1388.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1071.5" x2="1430.5" y1="1388.5" y2="1388.5"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1078.5" y="1381.666">[22]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="205" x="1120.5" y="1381.666">HTTP 200 Response</text><polygon fill="#181818" points="865.5,1426.1719,855.5,1430.1719,865.5,1434.1719,861.5,1430.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="859.5" x2="1065.5" y1="1430.1719" y2="1430.1719"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="871.5" y="1423.3379">[23]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="913.5" y="1423.3379">response</text><polygon fill="#181818" points="141.5,1467.8438,131.5,1471.8438,141.5,1475.8438,137.5,1471.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="135.5" x2="853.5" y1="1471.8438" y2="1471.8438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="147.5" y="1465.0098">[24]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="89" x="189.5" y="1465.0098">response</text><path d="M10,1486.8438 L79,1486.8438 L79,1506.5156 L69,1516.5156 L10,1516.5156 L10,1486.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="181.3594" style="stroke:#000000;stroke-width:1.5;" width="455" x="10" y="1486.8438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="24" x="25" y="1510.6816">alt</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="366" x="94" y="1511.6816">[if (transferStatus== 'COMMITTED')]</text><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="172.5" y1="1562.8594" y2="1562.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="172.5" x2="172.5" y1="1562.8594" y2="1575.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="172.5" y1="1575.8594" y2="1575.8594"/><polygon fill="#181818" points="141.5,1571.8594,131.5,1575.8594,141.5,1579.8594,137.5,1575.8594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="137.5" y="1556.0254">[25]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="152" x="179.5" y="1556.0254">Finalise transfer</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="465" y1="1584.8594" y2="1584.8594"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="55" x="15" y="1607.6973">[else]</text><line style="stroke:#181818;stroke-width:1.0;" x1="130.5" x2="172.5" y1="1647.2031" y2="1647.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="172.5" x2="172.5" y1="1647.2031" y2="1660.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="172.5" y1="1660.2031" y2="1660.2031"/><polygon fill="#181818" points="141.5,1656.2031,131.5,1660.2031,141.5,1664.2031,137.5,1660.2031" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="38" x="137.5" y="1640.3691">[26]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacing" textLength="161" x="179.5" y="1640.3691">Rollback transfer</text><!--MD5=[217277dc47e902913285a8a7785774ac]
@startuml PayerDFSPSinglePhasePattern
/'*****
- - - - - - - - - - - - - -
******'/

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
' declare title
' title Payer DFSP Single Phase Integration Pattern
' declare actors
participant "Core banking solution" as CBS
box "Payment Manager" #LightGrey
participant "Core\nConnector" as CC 
participant "SDK Scheme Adapter" as MC 
end box
participant "Mojaloop\nSwitch" as Switch
autonumber 1 1 "<b>[0]"

== Payer DFSP integration - 2 phase commit - single phase ==

CBS->CBS: Reserve funds
CBS->CC: **POST** /sendMoney \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true)
CC->MC: **POST** /transfers
activate MC
MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
Switch- ->MC: HTTP 202 response
Switch->Switch: Determine Payee DFSP using oracle
Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
MC- ->Switch: HTTP 200 Response
rnote left MC
  Accept Party
endrnote
MC->Switch: **POST** /quotes
Switch- ->MC: HTTP 202 response
Switch->Switch: Pass on quote to Payee DFSP\n using **POST** /quotes
Switch->MC: **PUT** /quotes/{Id}
MC- ->Switch: HTTP 200 Response
rnote left MC
  Accept Quote
endrnote
MC->Switch: **POST** /transfers
Switch- ->MC: HTTP 202 response
Switch->Switch: Reserve Payer DFSP funds
Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /transfers
Switch->Switch: Calculate fees
Switch->Switch: Commit Payer DFSP funds
Switch->MC: **PUT** /transfers/{Id}
MC- ->Switch: HTTP 200 Response
MC- ->CC: response
deactivate MC
CC- ->CBS: response
alt if (transferStatus== 'COMMITTED')
CBS->CBS: Finalise transfer
else else
CBS->CBS: Rollback transfer
end 

@enduml

@startuml PayerDFSPSinglePhasePattern

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
participant "Core banking solution" as CBS
box "Payment Manager" #LightGrey
participant "Core\nConnector" as CC 
participant "SDK Scheme Adapter" as MC 
end box
participant "Mojaloop\nSwitch" as Switch
autonumber 1 1 "<b>[0]"

== Payer DFSP integration - 2 phase commit - single phase ==

CBS->CBS: Reserve funds
CBS->CC: **POST** /sendMoney \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true)
CC->MC: **POST** /transfers
activate MC
MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
Switch- ->MC: HTTP 202 response
Switch->Switch: Determine Payee DFSP using oracle
Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
MC- ->Switch: HTTP 200 Response
rnote left MC
  Accept Party
endrnote
MC->Switch: **POST** /quotes
Switch- ->MC: HTTP 202 response
Switch->Switch: Pass on quote to Payee DFSP\n using **POST** /quotes
Switch->MC: **PUT** /quotes/{Id}
MC- ->Switch: HTTP 200 Response
rnote left MC
  Accept Quote
endrnote
MC->Switch: **POST** /transfers
Switch- ->MC: HTTP 202 response
Switch->Switch: Reserve Payer DFSP funds
Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /transfers
Switch->Switch: Calculate fees
Switch->Switch: Commit Payer DFSP funds
Switch->MC: **PUT** /transfers/{Id}
MC- ->Switch: HTTP 200 Response
MC- ->CC: response
deactivate MC
CC- ->CBS: response
alt if (transferStatus== 'COMMITTED')
CBS->CBS: Finalise transfer
else else
CBS->CBS: Rollback transfer
end 

@enduml

PlantUML version 1.2022.6(Tue Jun 21 18:34:49 BST 2022)
(GPLV2 source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: GB
--></g></svg>